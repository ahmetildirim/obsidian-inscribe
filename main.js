/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => Inscribe
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/extension/index.ts
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
var TextSplitStrategies = {
  /**
   * Word-level segmentation (space-delimited).
   * Accepts text until (and including) the first space.
   */
  word: (text) => {
    const nextSpace = text.indexOf(" ");
    return nextSpace === -1 ? { accepted: text, remaining: "" } : {
      accepted: text.slice(0, nextSpace + 1),
      remaining: text.slice(nextSpace + 1)
    };
  },
  /**
   * Sentence-level segmentation (punctuation followed by whitespace).
   */
  sentence: (text) => {
    const match = text.match(/[.!?]\s+/);
    if (match && match.index !== void 0) {
      return {
        accepted: text.slice(0, match.index + 1),
        remaining: text.slice(match.index + 1)
      };
    }
    return { accepted: text, remaining: "" };
  },
  /**
   * Paragraph-level segmentation (double newline).
   */
  paragraph: (text) => {
    const paragraphEnd = text.indexOf("\n\n");
    return paragraphEnd === -1 ? { accepted: text, remaining: "" } : {
      accepted: text.slice(0, paragraphEnd + 2),
      remaining: text.slice(paragraphEnd + 2)
    };
  },
  /**
   * Atomic acceptance â€“ consume the entire suggestion.
   */
  full: (text) => ({ accepted: text, remaining: "" })
};
var SuggestionUpdateEffect = import_state.StateEffect.define();
var suggestionSessionState = import_state.StateField.define({
  create: () => getResetSession(),
  update(session, transaction) {
    const effect = transaction.effects.find(
      (e) => e.is(SuggestionUpdateEffect)
    );
    if (effect)
      return updateSessionFromEffect(effect.value);
    if (transaction.docChanged && session.remainingText && session.anchorPosition !== null) {
      return updateSessionOnDocumentChange(session, transaction);
    }
    if (session.remainingText !== null && session.anchorPosition !== null) {
      return updateSessionOnCursorDrift(session, transaction);
    }
    return session;
  }
});
function getResetSession() {
  return {
    fullText: null,
    remainingText: null,
    baselineDocument: null,
    anchorPosition: null
  };
}
function updateSessionFromEffect(effect) {
  return effect.content === null ? getResetSession() : initializeSession(effect);
}
function initializeSession(effect) {
  return {
    fullText: effect.content,
    remainingText: effect.content,
    baselineDocument: effect.document,
    anchorPosition: effect.anchor
  };
}
function updateSessionOnDocumentChange(session, transaction) {
  let insertedContent = "";
  let insertionAtAnchor = false;
  transaction.changes.iterChanges((fromA, toA, _fromB, _toB, inserted) => {
    if (fromA === session.anchorPosition && toA === fromA) {
      insertedContent = inserted.toString();
      insertionAtAnchor = true;
    }
  });
  if (!insertionAtAnchor || !session.remainingText) {
    return invalidateSession(session);
  }
  if (session.remainingText.startsWith(insertedContent)) {
    return advanceSession(session, insertedContent.length);
  }
  return invalidateSession(session);
}
function advanceSession(session, consumedLength) {
  return {
    ...session,
    remainingText: session.remainingText.slice(consumedLength).length > 0 ? session.remainingText.slice(consumedLength) : null,
    anchorPosition: session.anchorPosition + consumedLength
  };
}
function invalidateSession(session) {
  return {
    ...session,
    remainingText: null,
    anchorPosition: null
  };
}
function updateSessionOnCursorDrift(session, transaction) {
  return transaction.state.selection.main.head !== session.anchorPosition ? invalidateSession(session) : session;
}
var _SuggestionWidget = class extends import_view.WidgetType {
  constructor(content) {
    super();
    this.content = content;
  }
  toDOM() {
    const span = document.createElement("span");
    span.className = _SuggestionWidget.CSS_CLASS;
    span.style.opacity = _SuggestionWidget.OPACITY.toString();
    span.textContent = this.content;
    return span;
  }
};
var SuggestionWidget = _SuggestionWidget;
SuggestionWidget.OPACITY = 0.4;
SuggestionWidget.CSS_CLASS = "cm-inline-prediction";
var suggestionRenderer = import_view.ViewPlugin.fromClass(
  class {
    constructor() {
      this.decorations = import_view.Decoration.none;
    }
    update(update) {
      const session = update.state.field(suggestionSessionState);
      this.decorations = session.remainingText ? this.createDecoration(update.view, session.remainingText) : import_view.Decoration.none;
    }
    createDecoration(view, suggestionText) {
      const cursorPosition = view.state.selection.main.head;
      return import_view.Decoration.set([
        import_view.Decoration.widget({
          widget: new SuggestionWidget(suggestionText),
          side: 1
        }).range(cursorPosition)
      ]);
    }
  },
  { decorations: (v) => v.decorations }
);
var createDebouncedFetcher = (fetch3, getDelay) => {
  let activeRequest = true;
  let timeoutId;
  const throttledFetch = async function* (state) {
    clearTimeout(timeoutId);
    activeRequest = true;
    await new Promise((resolve2) => {
      timeoutId = setTimeout(resolve2, getDelay());
    });
    if (activeRequest)
      yield* fetch3(state);
  };
  const fetcherPlugin = import_view.ViewPlugin.fromClass(
    class {
      constructor() {
        this.currentRequestId = 0;
      }
      async update(update) {
        const state = update.state;
        if (!update.docChanged || state.field(suggestionSessionState).remainingText)
          return;
        const requestId = ++this.currentRequestId;
        for await (const suggestion of throttledFetch(state)) {
          if (requestId !== this.currentRequestId)
            return;
          update.view.dispatch({
            effects: SuggestionUpdateEffect.of({
              content: suggestion.text,
              document: state.doc,
              anchor: state.selection.main.head
            })
          });
        }
      }
    }
  );
  return {
    fetcherPlugin,
    terminate: () => {
      activeRequest = false;
      clearTimeout(timeoutId);
    }
  };
};
var createAcceptanceHandler = (terminateFetch, hotkey, getOptions) => import_state.Prec.highest(
  import_view.keymap.of([
    {
      key: hotkey,
      run: (view) => {
        var _a;
        const session = view.state.field(suggestionSessionState);
        if (!session.remainingText)
          return false;
        const dynamicOptions = getOptions();
        const segmentationKey = (_a = dynamicOptions.splitStrategy) != null ? _a : "word";
        const { accepted, remaining } = TextSplitStrategies[segmentationKey](session.remainingText);
        if (!accepted)
          return false;
        view.dispatch({
          ...insertCompletion(view.state, accepted),
          effects: SuggestionUpdateEffect.of({
            content: remaining || null,
            document: remaining ? session.baselineDocument : null,
            anchor: remaining ? session.anchorPosition + accepted.length : null
          })
        });
        if (!remaining)
          terminateFetch();
        return true;
      }
    }
  ])
);
var insertCompletion = (state, text) => {
  const cursorPos = state.selection.main.head;
  return {
    ...state.changeByRange(() => ({
      changes: { from: cursorPos, insert: text },
      range: import_state.EditorSelection.cursor(cursorPos + text.length)
    })),
    userEvent: "completion.accept"
  };
};
function inlineSuggestions(config) {
  const { fetchFunc, getOptions } = config;
  const staticHotkey = config.acceptanceHotkey || "Tab";
  const normalizeFetch = async function* (state) {
    const result = await fetchFunc(state);
    if (Symbol.asyncIterator in result) {
      yield* result;
    } else {
      yield result;
    }
  };
  const getDelay = () => {
    var _a;
    return (_a = getOptions().delayMs) != null ? _a : 300;
  };
  const { fetcherPlugin, terminate } = createDebouncedFetcher(normalizeFetch, getDelay);
  const acceptanceHandler = createAcceptanceHandler(terminate, staticHotkey, getOptions);
  return [
    suggestionSessionState,
    fetcherPlugin,
    suggestionRenderer,
    acceptanceHandler
  ];
}

// src/settings/settings.ts
var DEFAULT_PROFILE = "default";
var DEFAULT_PATH = "/";
var DEFAULT_SETTINGS = {
  providers: {
    openai: {
      integration: "openai" /* OPENAI */,
      name: "Open AI",
      description: "Use OpenAI APIs to generate text.",
      apiKey: "",
      model: "gpt-4o",
      models: ["gpt-4", "gpt-3.5-turbo", "gpt-3.5", "gpt-3", "gpt-2", "gpt-1"],
      configured: false
    },
    ollama: {
      integration: "ollama" /* OLLAMA */,
      name: "Ollama",
      description: "Use your own Ollama instance to generate text.",
      host: "http://localhost:11434",
      models: ["llama3.2:latest", "mistral-nemo"],
      configured: true
    }
  },
  profiles: {
    default: {
      name: "Default Profile",
      provider: "ollama" /* OLLAMA */,
      delayMs: 500,
      splitStrategy: "word",
      completionOptions: {
        model: "mistral-nemo",
        userPrompt: "Complete following text:\n {{pre_cursor}}}",
        systemPrompt: "You are an helpful AI completer. Follow instructions",
        temperature: 0.5
      }
    }
  },
  path_configs: {
    "/": {
      profile: DEFAULT_PROFILE,
      enabled: true
    }
  }
};
function newProfile(settings) {
  const profiles = settings.profiles;
  const id = Math.random().toString(36).substring(2, 6);
  let name = "New Profile";
  let i = 1;
  Object.entries(profiles).forEach(([, value]) => {
    if (value.name === name) {
      name = `New Profile ${i}`;
      i++;
    }
  });
  const defaultProfile = profiles[DEFAULT_PROFILE];
  const profile = {
    ...defaultProfile,
    name
  };
  profiles[id] = profile;
  return id;
}

// src/settings/settings-tab.ts
var import_obsidian2 = require("obsidian");

// node_modules/mustache/mustache.mjs
var objectToString = Object.prototype.toString;
var isArray = Array.isArray || function isArrayPolyfill(object) {
  return objectToString.call(object) === "[object Array]";
};
function isFunction(object) {
  return typeof object === "function";
}
function typeStr(obj) {
  return isArray(obj) ? "array" : typeof obj;
}
function escapeRegExp(string) {
  return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&");
}
function hasProperty(obj, propName) {
  return obj != null && typeof obj === "object" && propName in obj;
}
function primitiveHasOwnProperty(primitive, propName) {
  return primitive != null && typeof primitive !== "object" && primitive.hasOwnProperty && primitive.hasOwnProperty(propName);
}
var regExpTest = RegExp.prototype.test;
function testRegExp(re, string) {
  return regExpTest.call(re, string);
}
var nonSpaceRe = /\S/;
function isWhitespace(string) {
  return !testRegExp(nonSpaceRe, string);
}
var entityMap = {
  "&": "&amp;",
  "<": "&lt;",
  ">": "&gt;",
  '"': "&quot;",
  "'": "&#39;",
  "/": "&#x2F;",
  "`": "&#x60;",
  "=": "&#x3D;"
};
function escapeHtml(string) {
  return String(string).replace(/[&<>"'`=\/]/g, function fromEntityMap(s) {
    return entityMap[s];
  });
}
var whiteRe = /\s*/;
var spaceRe = /\s+/;
var equalsRe = /\s*=/;
var curlyRe = /\s*\}/;
var tagRe = /#|\^|\/|>|\{|&|=|!/;
function parseTemplate(template, tags) {
  if (!template)
    return [];
  var lineHasNonSpace = false;
  var sections = [];
  var tokens = [];
  var spaces = [];
  var hasTag = false;
  var nonSpace = false;
  var indentation = "";
  var tagIndex = 0;
  function stripSpace() {
    if (hasTag && !nonSpace) {
      while (spaces.length)
        delete tokens[spaces.pop()];
    } else {
      spaces = [];
    }
    hasTag = false;
    nonSpace = false;
  }
  var openingTagRe, closingTagRe, closingCurlyRe;
  function compileTags(tagsToCompile) {
    if (typeof tagsToCompile === "string")
      tagsToCompile = tagsToCompile.split(spaceRe, 2);
    if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)
      throw new Error("Invalid tags: " + tagsToCompile);
    openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + "\\s*");
    closingTagRe = new RegExp("\\s*" + escapeRegExp(tagsToCompile[1]));
    closingCurlyRe = new RegExp("\\s*" + escapeRegExp("}" + tagsToCompile[1]));
  }
  compileTags(tags || mustache.tags);
  var scanner = new Scanner(template);
  var start, type, value, chr, token, openSection;
  while (!scanner.eos()) {
    start = scanner.pos;
    value = scanner.scanUntil(openingTagRe);
    if (value) {
      for (var i = 0, valueLength = value.length; i < valueLength; ++i) {
        chr = value.charAt(i);
        if (isWhitespace(chr)) {
          spaces.push(tokens.length);
          indentation += chr;
        } else {
          nonSpace = true;
          lineHasNonSpace = true;
          indentation += " ";
        }
        tokens.push(["text", chr, start, start + 1]);
        start += 1;
        if (chr === "\n") {
          stripSpace();
          indentation = "";
          tagIndex = 0;
          lineHasNonSpace = false;
        }
      }
    }
    if (!scanner.scan(openingTagRe))
      break;
    hasTag = true;
    type = scanner.scan(tagRe) || "name";
    scanner.scan(whiteRe);
    if (type === "=") {
      value = scanner.scanUntil(equalsRe);
      scanner.scan(equalsRe);
      scanner.scanUntil(closingTagRe);
    } else if (type === "{") {
      value = scanner.scanUntil(closingCurlyRe);
      scanner.scan(curlyRe);
      scanner.scanUntil(closingTagRe);
      type = "&";
    } else {
      value = scanner.scanUntil(closingTagRe);
    }
    if (!scanner.scan(closingTagRe))
      throw new Error("Unclosed tag at " + scanner.pos);
    if (type == ">") {
      token = [type, value, start, scanner.pos, indentation, tagIndex, lineHasNonSpace];
    } else {
      token = [type, value, start, scanner.pos];
    }
    tagIndex++;
    tokens.push(token);
    if (type === "#" || type === "^") {
      sections.push(token);
    } else if (type === "/") {
      openSection = sections.pop();
      if (!openSection)
        throw new Error('Unopened section "' + value + '" at ' + start);
      if (openSection[1] !== value)
        throw new Error('Unclosed section "' + openSection[1] + '" at ' + start);
    } else if (type === "name" || type === "{" || type === "&") {
      nonSpace = true;
    } else if (type === "=") {
      compileTags(value);
    }
  }
  stripSpace();
  openSection = sections.pop();
  if (openSection)
    throw new Error('Unclosed section "' + openSection[1] + '" at ' + scanner.pos);
  return nestTokens(squashTokens(tokens));
}
function squashTokens(tokens) {
  var squashedTokens = [];
  var token, lastToken;
  for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
    token = tokens[i];
    if (token) {
      if (token[0] === "text" && lastToken && lastToken[0] === "text") {
        lastToken[1] += token[1];
        lastToken[3] = token[3];
      } else {
        squashedTokens.push(token);
        lastToken = token;
      }
    }
  }
  return squashedTokens;
}
function nestTokens(tokens) {
  var nestedTokens = [];
  var collector = nestedTokens;
  var sections = [];
  var token, section;
  for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
    token = tokens[i];
    switch (token[0]) {
      case "#":
      case "^":
        collector.push(token);
        sections.push(token);
        collector = token[4] = [];
        break;
      case "/":
        section = sections.pop();
        section[5] = token[2];
        collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;
        break;
      default:
        collector.push(token);
    }
  }
  return nestedTokens;
}
function Scanner(string) {
  this.string = string;
  this.tail = string;
  this.pos = 0;
}
Scanner.prototype.eos = function eos() {
  return this.tail === "";
};
Scanner.prototype.scan = function scan(re) {
  var match = this.tail.match(re);
  if (!match || match.index !== 0)
    return "";
  var string = match[0];
  this.tail = this.tail.substring(string.length);
  this.pos += string.length;
  return string;
};
Scanner.prototype.scanUntil = function scanUntil(re) {
  var index2 = this.tail.search(re), match;
  switch (index2) {
    case -1:
      match = this.tail;
      this.tail = "";
      break;
    case 0:
      match = "";
      break;
    default:
      match = this.tail.substring(0, index2);
      this.tail = this.tail.substring(index2);
  }
  this.pos += match.length;
  return match;
};
function Context(view, parentContext) {
  this.view = view;
  this.cache = { ".": this.view };
  this.parent = parentContext;
}
Context.prototype.push = function push(view) {
  return new Context(view, this);
};
Context.prototype.lookup = function lookup(name) {
  var cache = this.cache;
  var value;
  if (cache.hasOwnProperty(name)) {
    value = cache[name];
  } else {
    var context = this, intermediateValue, names, index2, lookupHit = false;
    while (context) {
      if (name.indexOf(".") > 0) {
        intermediateValue = context.view;
        names = name.split(".");
        index2 = 0;
        while (intermediateValue != null && index2 < names.length) {
          if (index2 === names.length - 1)
            lookupHit = hasProperty(intermediateValue, names[index2]) || primitiveHasOwnProperty(intermediateValue, names[index2]);
          intermediateValue = intermediateValue[names[index2++]];
        }
      } else {
        intermediateValue = context.view[name];
        lookupHit = hasProperty(context.view, name);
      }
      if (lookupHit) {
        value = intermediateValue;
        break;
      }
      context = context.parent;
    }
    cache[name] = value;
  }
  if (isFunction(value))
    value = value.call(this.view);
  return value;
};
function Writer() {
  this.templateCache = {
    _cache: {},
    set: function set(key, value) {
      this._cache[key] = value;
    },
    get: function get2(key) {
      return this._cache[key];
    },
    clear: function clear() {
      this._cache = {};
    }
  };
}
Writer.prototype.clearCache = function clearCache() {
  if (typeof this.templateCache !== "undefined") {
    this.templateCache.clear();
  }
};
Writer.prototype.parse = function parse(template, tags) {
  var cache = this.templateCache;
  var cacheKey = template + ":" + (tags || mustache.tags).join(":");
  var isCacheEnabled = typeof cache !== "undefined";
  var tokens = isCacheEnabled ? cache.get(cacheKey) : void 0;
  if (tokens == void 0) {
    tokens = parseTemplate(template, tags);
    isCacheEnabled && cache.set(cacheKey, tokens);
  }
  return tokens;
};
Writer.prototype.render = function render(template, view, partials, config) {
  var tags = this.getConfigTags(config);
  var tokens = this.parse(template, tags);
  var context = view instanceof Context ? view : new Context(view, void 0);
  return this.renderTokens(tokens, context, partials, template, config);
};
Writer.prototype.renderTokens = function renderTokens(tokens, context, partials, originalTemplate, config) {
  var buffer = "";
  var token, symbol, value;
  for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
    value = void 0;
    token = tokens[i];
    symbol = token[0];
    if (symbol === "#")
      value = this.renderSection(token, context, partials, originalTemplate, config);
    else if (symbol === "^")
      value = this.renderInverted(token, context, partials, originalTemplate, config);
    else if (symbol === ">")
      value = this.renderPartial(token, context, partials, config);
    else if (symbol === "&")
      value = this.unescapedValue(token, context);
    else if (symbol === "name")
      value = this.escapedValue(token, context, config);
    else if (symbol === "text")
      value = this.rawValue(token);
    if (value !== void 0)
      buffer += value;
  }
  return buffer;
};
Writer.prototype.renderSection = function renderSection(token, context, partials, originalTemplate, config) {
  var self2 = this;
  var buffer = "";
  var value = context.lookup(token[1]);
  function subRender(template) {
    return self2.render(template, context, partials, config);
  }
  if (!value)
    return;
  if (isArray(value)) {
    for (var j = 0, valueLength = value.length; j < valueLength; ++j) {
      buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate, config);
    }
  } else if (typeof value === "object" || typeof value === "string" || typeof value === "number") {
    buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate, config);
  } else if (isFunction(value)) {
    if (typeof originalTemplate !== "string")
      throw new Error("Cannot use higher-order sections without the original template");
    value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);
    if (value != null)
      buffer += value;
  } else {
    buffer += this.renderTokens(token[4], context, partials, originalTemplate, config);
  }
  return buffer;
};
Writer.prototype.renderInverted = function renderInverted(token, context, partials, originalTemplate, config) {
  var value = context.lookup(token[1]);
  if (!value || isArray(value) && value.length === 0)
    return this.renderTokens(token[4], context, partials, originalTemplate, config);
};
Writer.prototype.indentPartial = function indentPartial(partial, indentation, lineHasNonSpace) {
  var filteredIndentation = indentation.replace(/[^ \t]/g, "");
  var partialByNl = partial.split("\n");
  for (var i = 0; i < partialByNl.length; i++) {
    if (partialByNl[i].length && (i > 0 || !lineHasNonSpace)) {
      partialByNl[i] = filteredIndentation + partialByNl[i];
    }
  }
  return partialByNl.join("\n");
};
Writer.prototype.renderPartial = function renderPartial(token, context, partials, config) {
  if (!partials)
    return;
  var tags = this.getConfigTags(config);
  var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];
  if (value != null) {
    var lineHasNonSpace = token[6];
    var tagIndex = token[5];
    var indentation = token[4];
    var indentedValue = value;
    if (tagIndex == 0 && indentation) {
      indentedValue = this.indentPartial(value, indentation, lineHasNonSpace);
    }
    var tokens = this.parse(indentedValue, tags);
    return this.renderTokens(tokens, context, partials, indentedValue, config);
  }
};
Writer.prototype.unescapedValue = function unescapedValue(token, context) {
  var value = context.lookup(token[1]);
  if (value != null)
    return value;
};
Writer.prototype.escapedValue = function escapedValue(token, context, config) {
  var escape = this.getConfigEscape(config) || mustache.escape;
  var value = context.lookup(token[1]);
  if (value != null)
    return typeof value === "number" && escape === mustache.escape ? String(value) : escape(value);
};
Writer.prototype.rawValue = function rawValue(token) {
  return token[1];
};
Writer.prototype.getConfigTags = function getConfigTags(config) {
  if (isArray(config)) {
    return config;
  } else if (config && typeof config === "object") {
    return config.tags;
  } else {
    return void 0;
  }
};
Writer.prototype.getConfigEscape = function getConfigEscape(config) {
  if (config && typeof config === "object" && !isArray(config)) {
    return config.escape;
  } else {
    return void 0;
  }
};
var mustache = {
  name: "mustache.js",
  version: "4.2.0",
  tags: ["{{", "}}"],
  clearCache: void 0,
  escape: void 0,
  parse: void 0,
  render: void 0,
  Scanner: void 0,
  Context: void 0,
  Writer: void 0,
  /**
   * Allows a user to override the default caching strategy, by providing an
   * object with set, get and clear methods. This can also be used to disable
   * the cache by setting it to the literal `undefined`.
   */
  set templateCache(cache) {
    defaultWriter.templateCache = cache;
  },
  /**
   * Gets the default or overridden caching object from the default writer.
   */
  get templateCache() {
    return defaultWriter.templateCache;
  }
};
var defaultWriter = new Writer();
mustache.clearCache = function clearCache2() {
  return defaultWriter.clearCache();
};
mustache.parse = function parse2(template, tags) {
  return defaultWriter.parse(template, tags);
};
mustache.render = function render2(template, view, partials, config) {
  if (typeof template !== "string") {
    throw new TypeError('Invalid template! Template should be a "string" but "' + typeStr(template) + '" was given as the first argument for mustache#render(template, view, partials)');
  }
  return defaultWriter.render(template, view, partials, config);
};
mustache.escape = escapeHtml;
mustache.Scanner = Scanner;
mustache.Context = Context;
mustache.Writer = Writer;
var mustache_default = mustache;

// src/prompt/index.ts
var TEMPLATE_VARIABLES = `{{pre_cursor}}
{{post_cursor}} 
{{active_sentence}} 
{{last_line}}`;
function buildPrompt(template, args) {
  return mustache_default.render(template, args);
}
function preparePrompt(editor, template = TEMPLATE_VARIABLES) {
  const cursor = editor.getCursor();
  const preCursor = editor.getRange({ line: 0, ch: 0 }, cursor);
  const postCursor = editor.getRange(cursor, { line: editor.lastLine(), ch: editor.getLine(editor.lastLine()).length });
  const activeSentence = sentenceAtCursor(editor);
  const lastLine = editor.getLine(editor.lastLine());
  return buildPrompt(template, {
    pre_cursor: preCursor,
    post_cursor: postCursor,
    active_sentence: activeSentence,
    last_line: lastLine
  });
}
function sentenceAtCursor(editor) {
  const cursor = editor.getCursor();
  let currentLine = cursor.line;
  let sentenceLines = [editor.getLine(currentLine)];
  while (currentLine > 0) {
    currentLine--;
    const line = editor.getLine(currentLine);
    if (/[.!?]\s*$/.test(line)) {
      break;
    }
    sentenceLines.unshift(line);
  }
  return sentenceLines.join(" ").replace(/\s+/g, " ").trim();
}

// src/settings/provider-settings-modal.ts
var import_obsidian = require("obsidian");
var ProviderSettingsModal = class extends import_obsidian.Modal {
  constructor(app, plugin, providerType) {
    super(app);
    this.plugin = plugin;
    this.providerType = providerType;
    this.modalEl.addClass("inscribe-provider-settings-modal");
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    switch (this.providerType) {
      case "ollama" /* OLLAMA */:
        this.renderOllamaSettings();
        break;
      case "openai" /* OPENAI */:
        this.renderOpenAISettings();
        break;
    }
  }
  async renderOllamaSettings() {
    const { contentEl } = this;
    this.setTitle("Ollama Settings");
    let host = this.plugin.settings.providers.ollama.host;
    new import_obsidian.Setting(contentEl).setName("Ollama Host").setDesc("The host of the Ollama API").addText((text) => {
      text.setValue(host).onChange((value) => {
        host = value;
      });
    });
    new import_obsidian.Setting(contentEl).setTooltip("Save changes").addButton((btn) => btn.setButtonText("Save").setCta().onClick(async () => {
      this.close();
      this.plugin.settings.providers.ollama.host = host;
      await this.plugin.saveSettings();
    }));
  }
  async renderOpenAISettings() {
    const { contentEl } = this;
    this.setTitle("OpenAI Settings");
    let apiKey = this.plugin.settings.providers.openai.apiKey;
    new import_obsidian.Setting(contentEl).setName("OpenAI API Key").setDesc("The API key for OpenAI").addText((text) => {
      text.setValue(apiKey).onChange((value) => {
        apiKey = value;
      });
    });
    new import_obsidian.Setting(contentEl).setTooltip("Save changes").addButton((btn) => btn.setButtonText("Save").setCta().onClick(async () => {
      this.close();
      this.plugin.settings.providers.openai.apiKey = apiKey;
      await this.plugin.saveSettings();
    }));
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/settings/settings-tab.ts
var InscribeSettingsTab = class extends import_obsidian2.PluginSettingTab {
  constructor(plugin) {
    super(plugin.app, plugin);
    this.plugin = plugin;
  }
  async display() {
    this.containerEl.empty();
    const providersContainer = document.createElement("div");
    this.containerEl.appendChild(providersContainer);
    this.providersSection = new ProvidersSection(providersContainer, this.app, this.plugin);
    await this.providersSection.render();
    const profilesContainer = document.createElement("div");
    this.containerEl.appendChild(profilesContainer);
    this.profilesSection = new ProfilesSection(profilesContainer, this.plugin);
    await this.profilesSection.render();
    const pathMappingsContainer = document.createElement("div");
    this.containerEl.appendChild(pathMappingsContainer);
    this.pathConfigsSection = new PathConfigsSection(pathMappingsContainer, this.plugin);
    await this.pathConfigsSection.render();
  }
};
var ProvidersSection = class {
  constructor(container, app, plugin) {
    this.app = app;
    this.container = container;
    this.plugin = plugin;
  }
  async render() {
    this.container.empty();
    this.container.createEl("h3", { text: "Providers" });
    this.container.createEl("p", {
      text: "Configure the AI providers you want to use for completions"
    });
    new import_obsidian2.Setting(this.container).setName("Ollama").setDesc("Local AI provider running on your machine").addButton((button) => {
      button.setButtonText("Configure").setTooltip("Configure Ollama").onClick(() => this.openProviderModal("ollama" /* OLLAMA */));
    });
    new import_obsidian2.Setting(this.container).setName("OpenAI").setDesc("OpenAI API provider").addButton((button) => {
      button.setButtonText("Configure").setTooltip("Configure OpenAI").onClick(() => this.openProviderModal("openai" /* OPENAI */));
    });
  }
  openProviderModal(type) {
    new ProviderSettingsModal(this.app, this.plugin, type).open();
  }
};
var ProfilesSection = class {
  constructor(container, plugin) {
    this.displayedProfileId = DEFAULT_PROFILE;
    this.container = container;
    this.plugin = plugin;
    this.selectionContainer = document.createElement("div");
    this.profileContainer = document.createElement("div");
    this.container.appendChild(this.selectionContainer);
    this.container.appendChild(this.profileContainer);
  }
  async render() {
    this.container.empty();
    this.container.createEl("h3", { text: "Profiles" });
    this.container.createEl("p", {
      text: "Configure the settings for each profile. A profile can be assigned to paths. The default profile is used when no profile is assigned."
    });
    this.container.appendChild(this.selectionContainer);
    this.container.appendChild(this.profileContainer);
    await this.renderProfileSelection();
    const displayedProfile = this.plugin.settings.profiles[this.displayedProfileId];
    await this.renderProfileSettings(displayedProfile);
  }
  async renderProfileSelection() {
    this.selectionContainer.empty();
    this.selectionContainer.createEl("br");
    new import_obsidian2.Setting(this.selectionContainer).setHeading().setName("Manage profile").setDesc("Select a profile to configure its settings").addDropdown((dropdown) => this.createProfileDropdown(dropdown)).addExtraButton((button) => this.createNewProfileButton(button)).addExtraButton((button) => this.createDeleteProfileButton(button));
  }
  createProfileDropdown(dropdown) {
    Object.entries(this.plugin.settings.profiles).forEach(([id, profile]) => {
      dropdown.addOption(id, profile.name);
    });
    dropdown.setValue(this.displayedProfileId).onChange(async (value) => {
      this.displayedProfileId = value;
      await this.renderProfileSettings(this.plugin.settings.profiles[value]);
    });
  }
  createNewProfileButton(button) {
    button.setIcon("plus").setTooltip("Create new profile").onClick(async () => {
      this.displayedProfileId = newProfile(this.plugin.settings);
      await this.plugin.saveSettings();
      await this.render();
    });
  }
  createDeleteProfileButton(button) {
    const isDefault = this.displayedProfileId === DEFAULT_PROFILE;
    button.setDisabled(isDefault).setIcon("trash").setTooltip(isDefault ? "Cannot delete default profile" : "Delete profile").onClick(async () => {
      delete this.plugin.settings.profiles[this.displayedProfileId];
      this.displayedProfileId = DEFAULT_PROFILE;
      await this.plugin.saveSettings();
      await this.render();
    });
  }
  async renderProfileSettings(profile) {
    this.profileContainer.empty();
    new import_obsidian2.Setting(this.profileContainer).setName("Profile Name").setDesc("Name of the profile").addText((text) => {
      text.setValue(profile.name).onChange(async (value) => {
        profile.name = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian2.Setting(this.profileContainer).setName("AI Provider").setDesc("Choose your preferred AI provider").addDropdown((dropdown) => {
      dropdown.addOption("ollama" /* OLLAMA */, "Ollama").addOption("openai" /* OPENAI */, "OpenAI").setValue(profile.provider).onChange(async (value) => {
        profile.provider = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian2.Setting(this.profileContainer).setName("Model").setDesc("Select the model to use for completions").addExtraButton((button) => {
      button.setIcon("refresh-ccw").setTooltip("Update model list").onClick(async () => {
        this.plugin.providerFactory.updateModels(profile.provider);
        await this.plugin.saveSettings();
        await this.renderProfileSettings(profile);
      });
    }).addDropdown(async (dropdown) => {
      const models = this.plugin.settings.providers[profile.provider].models;
      dropdown.addOptions(Object.fromEntries(models.map((model) => [model, model]))).setValue(profile.completionOptions.model).onChange(async (value) => {
        profile.completionOptions.model = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian2.Setting(this.profileContainer).setName("Temperature").setDesc("Control the randomness of completions (0 = deterministic, 1 = creative)").addSlider((slider) => {
      slider.setLimits(0, 1, 0.1).setValue(profile.completionOptions.temperature).setDynamicTooltip().onChange(async (value) => {
        profile.completionOptions.temperature = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian2.Setting(this.profileContainer).setName("Suggestion Delay").setDesc("Delay in milliseconds before fetching suggestions").addText((text) => {
      text.inputEl.setAttr("type", "number");
      text.setPlaceholder("1000").setValue(String(profile.delayMs)).onChange(async (value) => {
        profile.delayMs = parseInt(value);
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian2.Setting(this.profileContainer).setName("Completion Strategy").setDesc("Choose how completions should be split and accepted").addDropdown((dropdown) => {
      dropdown.addOption("word", "Word by Word").addOption("sentence", "Sentence by Sentence").addOption("paragraph", "Paragraph by Paragraph").addOption("full", "Full Completion").setValue(profile.splitStrategy).onChange(async (value) => {
        profile.splitStrategy = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian2.Setting(this.profileContainer).setName("System Prompt").setDesc("Set system prompt").addTextArea((text) => {
      text.inputEl.rows = 3;
      text.inputEl.setCssStyles({
        width: "100%",
        resize: "vertical",
        position: "relative"
      });
      text.setValue(profile.completionOptions.systemPrompt).onChange(
        async (value) => {
          profile.completionOptions.systemPrompt = value;
          await this.plugin.saveSettings();
        }
      );
    });
    new import_obsidian2.Setting(this.profileContainer).setName("User Prompt").setDesc("User prompt template").addExtraButton((button) => {
      button.setIcon("list").setTooltip("Insert mustache template variables").onClick(async () => {
        const text = profile.completionOptions.userPrompt + "\n" + TEMPLATE_VARIABLES;
        profile.completionOptions.userPrompt = text;
        await this.plugin.saveSettings();
        await this.renderProfileSettings(profile);
      });
    }).addTextArea((text) => {
      text.inputEl.rows = 3;
      text.inputEl.setCssStyles({
        width: "100%",
        resize: "vertical",
        position: "relative"
      });
      text.setValue(profile.completionOptions.userPrompt).onChange(
        async (value) => {
          profile.completionOptions.userPrompt = value;
          await this.plugin.saveSettings();
        }
      );
    });
  }
};
var PathConfigsSection = class {
  constructor(container, plugin) {
    this.container = container;
    this.plugin = plugin;
    this.tableContainer = document.createElement("div");
  }
  async render() {
    this.container.empty();
    this.container.createEl("h3", { text: "Path Profiles" });
    this.container.createEl("p", {
      text: "You can assign profiles to paths. Paths are matched by prefix, with longer paths taking precedence. For example, '/Daily' will match all files in the Daily folder."
    });
    this.container.createEl("br");
    this.container.appendChild(this.tableContainer);
    await this.renderMappingsTable();
  }
  async renderMappingsTable() {
    this.tableContainer.empty();
    const table = this.tableContainer.createEl("table", { cls: "mapping-table" });
    const header = table.createEl("tr");
    header.createEl("th", { text: "Path" });
    header.createEl("th", { text: "Profile" });
    header.createEl("th", { text: "" });
    header.createEl("th", { text: "" });
    const newRow = table.createEl("tr", { cls: "new-mapping-row" });
    let pathInput = "";
    let selectedProfile = DEFAULT_PROFILE;
    const pathCell = newRow.createEl("td");
    new import_obsidian2.TextComponent(pathCell).setPlaceholder("Enter path (e.g., Daily/Work)").onChange((value) => {
      pathInput = value;
    });
    const profileCell = newRow.createEl("td");
    const profileDropdown = new import_obsidian2.DropdownComponent(profileCell).setValue(selectedProfile);
    Object.entries(this.plugin.settings.profiles).forEach(([id, profile]) => {
      profileDropdown.addOption(id, profile.name);
    });
    profileDropdown.onChange((value) => {
      selectedProfile = value;
    });
    newRow.createEl("td");
    const actionCell = newRow.createEl("td");
    new import_obsidian2.ExtraButtonComponent(actionCell).setIcon("plus").setTooltip("Add profile mapping").onClick(async () => {
      this.plugin.settings.path_configs[pathInput] = {
        profile: selectedProfile,
        enabled: true
      };
      await this.plugin.saveSettings();
      await this.render();
    });
    Object.entries(this.plugin.settings.path_configs).forEach(([path, mapping]) => {
      const row = table.createEl("tr");
      row.createEl("td", { text: path || "Root" });
      const isDefaultMapping = path === "";
      const profileCell2 = row.createEl("td");
      const profileDropdown2 = new import_obsidian2.DropdownComponent(profileCell2).setDisabled(isDefaultMapping);
      Object.entries(this.plugin.settings.profiles).forEach(([id, profile]) => {
        profileDropdown2.addOption(id, profile.name);
      });
      profileDropdown2.setValue(mapping.profile);
      profileDropdown2.onChange(async (value) => {
        this.plugin.settings.path_configs[path] = {
          profile: value,
          enabled: mapping.enabled
        };
        await this.plugin.saveSettings();
      });
      const deleteCell = row.createEl("td");
      new import_obsidian2.ExtraButtonComponent(deleteCell).setIcon("trash").setDisabled(isDefaultMapping).setTooltip("Delete mapping").onClick(async () => {
        delete this.plugin.settings.path_configs[path];
        await this.plugin.saveSettings();
        await this.render();
      });
      const enabledCell = row.createEl("td");
      new import_obsidian2.ToggleComponent(enabledCell).setTooltip("Enable/disable mapping").setValue(mapping.enabled).onChange(async (value) => {
        this.plugin.settings.path_configs[path].enabled = value;
        await this.plugin.saveSettings();
      });
    });
  }
};

// node_modules/ollama/dist/index.mjs
var import_fs = __toESM(require("fs"), 1);
var import_path = require("path");

// node_modules/whatwg-fetch/fetch.js
var g = typeof globalThis !== "undefined" && globalThis || typeof self !== "undefined" && self || // eslint-disable-next-line no-undef
typeof global !== "undefined" && global || {};
var support = {
  searchParams: "URLSearchParams" in g,
  iterable: "Symbol" in g && "iterator" in Symbol,
  blob: "FileReader" in g && "Blob" in g && function() {
    try {
      new Blob();
      return true;
    } catch (e) {
      return false;
    }
  }(),
  formData: "FormData" in g,
  arrayBuffer: "ArrayBuffer" in g
};
function isDataView(obj) {
  return obj && DataView.prototype.isPrototypeOf(obj);
}
if (support.arrayBuffer) {
  viewClasses = [
    "[object Int8Array]",
    "[object Uint8Array]",
    "[object Uint8ClampedArray]",
    "[object Int16Array]",
    "[object Uint16Array]",
    "[object Int32Array]",
    "[object Uint32Array]",
    "[object Float32Array]",
    "[object Float64Array]"
  ];
  isArrayBufferView = ArrayBuffer.isView || function(obj) {
    return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1;
  };
}
var viewClasses;
var isArrayBufferView;
function normalizeName(name) {
  if (typeof name !== "string") {
    name = String(name);
  }
  if (/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(name) || name === "") {
    throw new TypeError('Invalid character in header field name: "' + name + '"');
  }
  return name.toLowerCase();
}
function normalizeValue(value) {
  if (typeof value !== "string") {
    value = String(value);
  }
  return value;
}
function iteratorFor(items) {
  var iterator = {
    next: function() {
      var value = items.shift();
      return { done: value === void 0, value };
    }
  };
  if (support.iterable) {
    iterator[Symbol.iterator] = function() {
      return iterator;
    };
  }
  return iterator;
}
function Headers(headers) {
  this.map = {};
  if (headers instanceof Headers) {
    headers.forEach(function(value, name) {
      this.append(name, value);
    }, this);
  } else if (Array.isArray(headers)) {
    headers.forEach(function(header) {
      if (header.length != 2) {
        throw new TypeError("Headers constructor: expected name/value pair to be length 2, found" + header.length);
      }
      this.append(header[0], header[1]);
    }, this);
  } else if (headers) {
    Object.getOwnPropertyNames(headers).forEach(function(name) {
      this.append(name, headers[name]);
    }, this);
  }
}
Headers.prototype.append = function(name, value) {
  name = normalizeName(name);
  value = normalizeValue(value);
  var oldValue = this.map[name];
  this.map[name] = oldValue ? oldValue + ", " + value : value;
};
Headers.prototype["delete"] = function(name) {
  delete this.map[normalizeName(name)];
};
Headers.prototype.get = function(name) {
  name = normalizeName(name);
  return this.has(name) ? this.map[name] : null;
};
Headers.prototype.has = function(name) {
  return this.map.hasOwnProperty(normalizeName(name));
};
Headers.prototype.set = function(name, value) {
  this.map[normalizeName(name)] = normalizeValue(value);
};
Headers.prototype.forEach = function(callback, thisArg) {
  for (var name in this.map) {
    if (this.map.hasOwnProperty(name)) {
      callback.call(thisArg, this.map[name], name, this);
    }
  }
};
Headers.prototype.keys = function() {
  var items = [];
  this.forEach(function(value, name) {
    items.push(name);
  });
  return iteratorFor(items);
};
Headers.prototype.values = function() {
  var items = [];
  this.forEach(function(value) {
    items.push(value);
  });
  return iteratorFor(items);
};
Headers.prototype.entries = function() {
  var items = [];
  this.forEach(function(value, name) {
    items.push([name, value]);
  });
  return iteratorFor(items);
};
if (support.iterable) {
  Headers.prototype[Symbol.iterator] = Headers.prototype.entries;
}
function consumed(body) {
  if (body._noBody)
    return;
  if (body.bodyUsed) {
    return Promise.reject(new TypeError("Already read"));
  }
  body.bodyUsed = true;
}
function fileReaderReady(reader) {
  return new Promise(function(resolve2, reject) {
    reader.onload = function() {
      resolve2(reader.result);
    };
    reader.onerror = function() {
      reject(reader.error);
    };
  });
}
function readBlobAsArrayBuffer(blob) {
  var reader = new FileReader();
  var promise = fileReaderReady(reader);
  reader.readAsArrayBuffer(blob);
  return promise;
}
function readBlobAsText(blob) {
  var reader = new FileReader();
  var promise = fileReaderReady(reader);
  var match = /charset=([A-Za-z0-9_-]+)/.exec(blob.type);
  var encoding = match ? match[1] : "utf-8";
  reader.readAsText(blob, encoding);
  return promise;
}
function readArrayBufferAsText(buf) {
  var view = new Uint8Array(buf);
  var chars = new Array(view.length);
  for (var i = 0; i < view.length; i++) {
    chars[i] = String.fromCharCode(view[i]);
  }
  return chars.join("");
}
function bufferClone(buf) {
  if (buf.slice) {
    return buf.slice(0);
  } else {
    var view = new Uint8Array(buf.byteLength);
    view.set(new Uint8Array(buf));
    return view.buffer;
  }
}
function Body() {
  this.bodyUsed = false;
  this._initBody = function(body) {
    this.bodyUsed = this.bodyUsed;
    this._bodyInit = body;
    if (!body) {
      this._noBody = true;
      this._bodyText = "";
    } else if (typeof body === "string") {
      this._bodyText = body;
    } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
      this._bodyBlob = body;
    } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {
      this._bodyFormData = body;
    } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
      this._bodyText = body.toString();
    } else if (support.arrayBuffer && support.blob && isDataView(body)) {
      this._bodyArrayBuffer = bufferClone(body.buffer);
      this._bodyInit = new Blob([this._bodyArrayBuffer]);
    } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {
      this._bodyArrayBuffer = bufferClone(body);
    } else {
      this._bodyText = body = Object.prototype.toString.call(body);
    }
    if (!this.headers.get("content-type")) {
      if (typeof body === "string") {
        this.headers.set("content-type", "text/plain;charset=UTF-8");
      } else if (this._bodyBlob && this._bodyBlob.type) {
        this.headers.set("content-type", this._bodyBlob.type);
      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
        this.headers.set("content-type", "application/x-www-form-urlencoded;charset=UTF-8");
      }
    }
  };
  if (support.blob) {
    this.blob = function() {
      var rejected = consumed(this);
      if (rejected) {
        return rejected;
      }
      if (this._bodyBlob) {
        return Promise.resolve(this._bodyBlob);
      } else if (this._bodyArrayBuffer) {
        return Promise.resolve(new Blob([this._bodyArrayBuffer]));
      } else if (this._bodyFormData) {
        throw new Error("could not read FormData body as blob");
      } else {
        return Promise.resolve(new Blob([this._bodyText]));
      }
    };
  }
  this.arrayBuffer = function() {
    if (this._bodyArrayBuffer) {
      var isConsumed = consumed(this);
      if (isConsumed) {
        return isConsumed;
      } else if (ArrayBuffer.isView(this._bodyArrayBuffer)) {
        return Promise.resolve(
          this._bodyArrayBuffer.buffer.slice(
            this._bodyArrayBuffer.byteOffset,
            this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength
          )
        );
      } else {
        return Promise.resolve(this._bodyArrayBuffer);
      }
    } else if (support.blob) {
      return this.blob().then(readBlobAsArrayBuffer);
    } else {
      throw new Error("could not read as ArrayBuffer");
    }
  };
  this.text = function() {
    var rejected = consumed(this);
    if (rejected) {
      return rejected;
    }
    if (this._bodyBlob) {
      return readBlobAsText(this._bodyBlob);
    } else if (this._bodyArrayBuffer) {
      return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));
    } else if (this._bodyFormData) {
      throw new Error("could not read FormData body as text");
    } else {
      return Promise.resolve(this._bodyText);
    }
  };
  if (support.formData) {
    this.formData = function() {
      return this.text().then(decode);
    };
  }
  this.json = function() {
    return this.text().then(JSON.parse);
  };
  return this;
}
var methods = ["CONNECT", "DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT", "TRACE"];
function normalizeMethod(method) {
  var upcased = method.toUpperCase();
  return methods.indexOf(upcased) > -1 ? upcased : method;
}
function Request(input, options) {
  if (!(this instanceof Request)) {
    throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');
  }
  options = options || {};
  var body = options.body;
  if (input instanceof Request) {
    if (input.bodyUsed) {
      throw new TypeError("Already read");
    }
    this.url = input.url;
    this.credentials = input.credentials;
    if (!options.headers) {
      this.headers = new Headers(input.headers);
    }
    this.method = input.method;
    this.mode = input.mode;
    this.signal = input.signal;
    if (!body && input._bodyInit != null) {
      body = input._bodyInit;
      input.bodyUsed = true;
    }
  } else {
    this.url = String(input);
  }
  this.credentials = options.credentials || this.credentials || "same-origin";
  if (options.headers || !this.headers) {
    this.headers = new Headers(options.headers);
  }
  this.method = normalizeMethod(options.method || this.method || "GET");
  this.mode = options.mode || this.mode || null;
  this.signal = options.signal || this.signal || function() {
    if ("AbortController" in g) {
      var ctrl = new AbortController();
      return ctrl.signal;
    }
  }();
  this.referrer = null;
  if ((this.method === "GET" || this.method === "HEAD") && body) {
    throw new TypeError("Body not allowed for GET or HEAD requests");
  }
  this._initBody(body);
  if (this.method === "GET" || this.method === "HEAD") {
    if (options.cache === "no-store" || options.cache === "no-cache") {
      var reParamSearch = /([?&])_=[^&]*/;
      if (reParamSearch.test(this.url)) {
        this.url = this.url.replace(reParamSearch, "$1_=" + new Date().getTime());
      } else {
        var reQueryString = /\?/;
        this.url += (reQueryString.test(this.url) ? "&" : "?") + "_=" + new Date().getTime();
      }
    }
  }
}
Request.prototype.clone = function() {
  return new Request(this, { body: this._bodyInit });
};
function decode(body) {
  var form = new FormData();
  body.trim().split("&").forEach(function(bytes) {
    if (bytes) {
      var split = bytes.split("=");
      var name = split.shift().replace(/\+/g, " ");
      var value = split.join("=").replace(/\+/g, " ");
      form.append(decodeURIComponent(name), decodeURIComponent(value));
    }
  });
  return form;
}
function parseHeaders(rawHeaders) {
  var headers = new Headers();
  var preProcessedHeaders = rawHeaders.replace(/\r?\n[\t ]+/g, " ");
  preProcessedHeaders.split("\r").map(function(header) {
    return header.indexOf("\n") === 0 ? header.substr(1, header.length) : header;
  }).forEach(function(line) {
    var parts = line.split(":");
    var key = parts.shift().trim();
    if (key) {
      var value = parts.join(":").trim();
      try {
        headers.append(key, value);
      } catch (error) {
        console.warn("Response " + error.message);
      }
    }
  });
  return headers;
}
Body.call(Request.prototype);
function Response(bodyInit, options) {
  if (!(this instanceof Response)) {
    throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');
  }
  if (!options) {
    options = {};
  }
  this.type = "default";
  this.status = options.status === void 0 ? 200 : options.status;
  if (this.status < 200 || this.status > 599) {
    throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");
  }
  this.ok = this.status >= 200 && this.status < 300;
  this.statusText = options.statusText === void 0 ? "" : "" + options.statusText;
  this.headers = new Headers(options.headers);
  this.url = options.url || "";
  this._initBody(bodyInit);
}
Body.call(Response.prototype);
Response.prototype.clone = function() {
  return new Response(this._bodyInit, {
    status: this.status,
    statusText: this.statusText,
    headers: new Headers(this.headers),
    url: this.url
  });
};
Response.error = function() {
  var response = new Response(null, { status: 200, statusText: "" });
  response.ok = false;
  response.status = 0;
  response.type = "error";
  return response;
};
var redirectStatuses = [301, 302, 303, 307, 308];
Response.redirect = function(url, status) {
  if (redirectStatuses.indexOf(status) === -1) {
    throw new RangeError("Invalid status code");
  }
  return new Response(null, { status, headers: { location: url } });
};
var DOMException = g.DOMException;
try {
  new DOMException();
} catch (err) {
  DOMException = function(message, name) {
    this.message = message;
    this.name = name;
    var error = Error(message);
    this.stack = error.stack;
  };
  DOMException.prototype = Object.create(Error.prototype);
  DOMException.prototype.constructor = DOMException;
}
function fetch2(input, init) {
  return new Promise(function(resolve2, reject) {
    var request = new Request(input, init);
    if (request.signal && request.signal.aborted) {
      return reject(new DOMException("Aborted", "AbortError"));
    }
    var xhr = new XMLHttpRequest();
    function abortXhr() {
      xhr.abort();
    }
    xhr.onload = function() {
      var options = {
        statusText: xhr.statusText,
        headers: parseHeaders(xhr.getAllResponseHeaders() || "")
      };
      if (request.url.indexOf("file://") === 0 && (xhr.status < 200 || xhr.status > 599)) {
        options.status = 200;
      } else {
        options.status = xhr.status;
      }
      options.url = "responseURL" in xhr ? xhr.responseURL : options.headers.get("X-Request-URL");
      var body = "response" in xhr ? xhr.response : xhr.responseText;
      setTimeout(function() {
        resolve2(new Response(body, options));
      }, 0);
    };
    xhr.onerror = function() {
      setTimeout(function() {
        reject(new TypeError("Network request failed"));
      }, 0);
    };
    xhr.ontimeout = function() {
      setTimeout(function() {
        reject(new TypeError("Network request timed out"));
      }, 0);
    };
    xhr.onabort = function() {
      setTimeout(function() {
        reject(new DOMException("Aborted", "AbortError"));
      }, 0);
    };
    function fixUrl(url) {
      try {
        return url === "" && g.location.href ? g.location.href : url;
      } catch (e) {
        return url;
      }
    }
    xhr.open(request.method, fixUrl(request.url), true);
    if (request.credentials === "include") {
      xhr.withCredentials = true;
    } else if (request.credentials === "omit") {
      xhr.withCredentials = false;
    }
    if ("responseType" in xhr) {
      if (support.blob) {
        xhr.responseType = "blob";
      } else if (support.arrayBuffer) {
        xhr.responseType = "arraybuffer";
      }
    }
    if (init && typeof init.headers === "object" && !(init.headers instanceof Headers || g.Headers && init.headers instanceof g.Headers)) {
      var names = [];
      Object.getOwnPropertyNames(init.headers).forEach(function(name) {
        names.push(normalizeName(name));
        xhr.setRequestHeader(name, normalizeValue(init.headers[name]));
      });
      request.headers.forEach(function(value, name) {
        if (names.indexOf(name) === -1) {
          xhr.setRequestHeader(name, value);
        }
      });
    } else {
      request.headers.forEach(function(value, name) {
        xhr.setRequestHeader(name, value);
      });
    }
    if (request.signal) {
      request.signal.addEventListener("abort", abortXhr);
      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
          request.signal.removeEventListener("abort", abortXhr);
        }
      };
    }
    xhr.send(typeof request._bodyInit === "undefined" ? null : request._bodyInit);
  });
}
fetch2.polyfill = true;
if (!g.fetch) {
  g.fetch = fetch2;
  g.Headers = Headers;
  g.Request = Request;
  g.Response = Response;
}

// node_modules/ollama/dist/browser.mjs
var version = "0.5.12";
var __defProp$1 = Object.defineProperty;
var __defNormalProp$1 = (obj, key, value) => key in obj ? __defProp$1(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __publicField$1 = (obj, key, value) => {
  __defNormalProp$1(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};
var ResponseError = class extends Error {
  constructor(error, status_code) {
    super(error);
    this.error = error;
    this.status_code = status_code;
    this.name = "ResponseError";
    if (Error.captureStackTrace) {
      Error.captureStackTrace(this, ResponseError);
    }
  }
};
var AbortableAsyncIterator = class {
  constructor(abortController, itr, doneCallback) {
    __publicField$1(this, "abortController");
    __publicField$1(this, "itr");
    __publicField$1(this, "doneCallback");
    this.abortController = abortController;
    this.itr = itr;
    this.doneCallback = doneCallback;
  }
  abort() {
    this.abortController.abort();
  }
  async *[Symbol.asyncIterator]() {
    for await (const message of this.itr) {
      if ("error" in message) {
        throw new Error(message.error);
      }
      yield message;
      if (message.done || message.status === "success") {
        this.doneCallback();
        return;
      }
    }
    throw new Error("Did not receive done or success response in stream.");
  }
};
var checkOk = async (response) => {
  var _a;
  if (response.ok) {
    return;
  }
  let message = `Error ${response.status}: ${response.statusText}`;
  let errorData = null;
  if ((_a = response.headers.get("content-type")) == null ? void 0 : _a.includes("application/json")) {
    try {
      errorData = await response.json();
      message = errorData.error || message;
    } catch (error) {
      console.log("Failed to parse error response as JSON");
    }
  } else {
    try {
      console.log("Getting text from response");
      const textResponse = await response.text();
      message = textResponse || message;
    } catch (error) {
      console.log("Failed to get text from error response");
    }
  }
  throw new ResponseError(message, response.status);
};
function getPlatform() {
  if (typeof window !== "undefined" && window.navigator) {
    return `${window.navigator.platform.toLowerCase()} Browser/${navigator.userAgent};`;
  } else if (typeof process !== "undefined") {
    return `${process.arch} ${process.platform} Node.js/${process.version}`;
  }
  return "";
}
var fetchWithHeaders = async (fetch3, url, options = {}) => {
  const defaultHeaders = {
    "Content-Type": "application/json",
    Accept: "application/json",
    "User-Agent": `ollama-js/${version} (${getPlatform()})`
  };
  if (!options.headers) {
    options.headers = {};
  }
  const customHeaders = Object.fromEntries(
    Object.entries(options.headers).filter(([key]) => !Object.keys(defaultHeaders).some((defaultKey) => defaultKey.toLowerCase() === key.toLowerCase()))
  );
  options.headers = {
    ...defaultHeaders,
    ...customHeaders
  };
  return fetch3(url, options);
};
var get = async (fetch3, host, options) => {
  const response = await fetchWithHeaders(fetch3, host, {
    headers: options == null ? void 0 : options.headers
  });
  await checkOk(response);
  return response;
};
var post = async (fetch3, host, data, options) => {
  const isRecord = (input) => {
    return input !== null && typeof input === "object" && !Array.isArray(input);
  };
  const formattedData = isRecord(data) ? JSON.stringify(data) : data;
  const response = await fetchWithHeaders(fetch3, host, {
    method: "POST",
    body: formattedData,
    signal: options == null ? void 0 : options.signal,
    headers: options == null ? void 0 : options.headers
  });
  await checkOk(response);
  return response;
};
var del = async (fetch3, host, data, options) => {
  const response = await fetchWithHeaders(fetch3, host, {
    method: "DELETE",
    body: JSON.stringify(data),
    headers: options == null ? void 0 : options.headers
  });
  await checkOk(response);
  return response;
};
var parseJSON = async function* (itr) {
  var _a;
  const decoder = new TextDecoder("utf-8");
  let buffer = "";
  const reader = itr.getReader();
  while (true) {
    const { done, value: chunk } = await reader.read();
    if (done) {
      break;
    }
    buffer += decoder.decode(chunk);
    const parts = buffer.split("\n");
    buffer = (_a = parts.pop()) != null ? _a : "";
    for (const part of parts) {
      try {
        yield JSON.parse(part);
      } catch (error) {
        console.warn("invalid json: ", part);
      }
    }
  }
  for (const part of buffer.split("\n").filter((p) => p !== "")) {
    try {
      yield JSON.parse(part);
    } catch (error) {
      console.warn("invalid json: ", part);
    }
  }
};
var formatHost = (host) => {
  if (!host) {
    return "http://127.0.0.1:11434";
  }
  let isExplicitProtocol = host.includes("://");
  if (host.startsWith(":")) {
    host = `http://127.0.0.1${host}`;
    isExplicitProtocol = true;
  }
  if (!isExplicitProtocol) {
    host = `http://${host}`;
  }
  const url = new URL(host);
  let port = url.port;
  if (!port) {
    if (!isExplicitProtocol) {
      port = "11434";
    } else {
      port = url.protocol === "https:" ? "443" : "80";
    }
  }
  let formattedHost = `${url.protocol}//${url.hostname}:${port}${url.pathname}`;
  if (formattedHost.endsWith("/")) {
    formattedHost = formattedHost.slice(0, -1);
  }
  return formattedHost;
};
var __defProp2 = Object.defineProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp2(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __publicField = (obj, key, value) => {
  __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};
var Ollama$1 = class Ollama {
  constructor(config) {
    var _a, _b;
    __publicField(this, "config");
    __publicField(this, "fetch");
    __publicField(this, "ongoingStreamedRequests", []);
    this.config = {
      host: "",
      headers: config == null ? void 0 : config.headers
    };
    if (!(config == null ? void 0 : config.proxy)) {
      this.config.host = formatHost((_a = config == null ? void 0 : config.host) != null ? _a : "http://127.0.0.1:11434");
    }
    this.fetch = (_b = config == null ? void 0 : config.fetch) != null ? _b : fetch;
  }
  // Abort any ongoing streamed requests to Ollama
  abort() {
    for (const request of this.ongoingStreamedRequests) {
      request.abort();
    }
    this.ongoingStreamedRequests.length = 0;
  }
  /**
   * Processes a request to the Ollama server. If the request is streamable, it will return a
   * AbortableAsyncIterator that yields the response messages. Otherwise, it will return the response
   * object.
   * @param endpoint {string} - The endpoint to send the request to.
   * @param request {object} - The request object to send to the endpoint.
   * @protected {T | AbortableAsyncIterator<T>} - The response object or a AbortableAsyncIterator that yields
   * response messages.
   * @throws {Error} - If the response body is missing or if the response is an error.
   * @returns {Promise<T | AbortableAsyncIterator<T>>} - The response object or a AbortableAsyncIterator that yields the streamed response.
   */
  async processStreamableRequest(endpoint, request) {
    var _a;
    request.stream = (_a = request.stream) != null ? _a : false;
    const host = `${this.config.host}/api/${endpoint}`;
    if (request.stream) {
      const abortController = new AbortController();
      const response2 = await post(this.fetch, host, request, {
        signal: abortController.signal,
        headers: this.config.headers
      });
      if (!response2.body) {
        throw new Error("Missing body");
      }
      const itr = parseJSON(response2.body);
      const abortableAsyncIterator = new AbortableAsyncIterator(
        abortController,
        itr,
        () => {
          const i = this.ongoingStreamedRequests.indexOf(abortableAsyncIterator);
          if (i > -1) {
            this.ongoingStreamedRequests.splice(i, 1);
          }
        }
      );
      this.ongoingStreamedRequests.push(abortableAsyncIterator);
      return abortableAsyncIterator;
    }
    const response = await post(this.fetch, host, request, {
      headers: this.config.headers
    });
    return await response.json();
  }
  /**
   * Encodes an image to base64 if it is a Uint8Array.
   * @param image {Uint8Array | string} - The image to encode.
   * @returns {Promise<string>} - The base64 encoded image.
   */
  async encodeImage(image) {
    if (typeof image !== "string") {
      const uint8Array = new Uint8Array(image);
      let byteString = "";
      const len = uint8Array.byteLength;
      for (let i = 0; i < len; i++) {
        byteString += String.fromCharCode(uint8Array[i]);
      }
      return btoa(byteString);
    }
    return image;
  }
  /**
   * Generates a response from a text prompt.
   * @param request {GenerateRequest} - The request object.
   * @returns {Promise<GenerateResponse | AbortableAsyncIterator<GenerateResponse>>} - The response object or
   * an AbortableAsyncIterator that yields response messages.
   */
  async generate(request) {
    if (request.images) {
      request.images = await Promise.all(request.images.map(this.encodeImage.bind(this)));
    }
    return this.processStreamableRequest("generate", request);
  }
  /**
   * Chats with the model. The request object can contain messages with images that are either
   * Uint8Arrays or base64 encoded strings. The images will be base64 encoded before sending the
   * request.
   * @param request {ChatRequest} - The request object.
   * @returns {Promise<ChatResponse | AbortableAsyncIterator<ChatResponse>>} - The response object or an
   * AbortableAsyncIterator that yields response messages.
   */
  async chat(request) {
    if (request.messages) {
      for (const message of request.messages) {
        if (message.images) {
          message.images = await Promise.all(
            message.images.map(this.encodeImage.bind(this))
          );
        }
      }
    }
    return this.processStreamableRequest("chat", request);
  }
  /**
   * Creates a new model from a stream of data.
   * @param request {CreateRequest} - The request object.
   * @returns {Promise<ProgressResponse | AbortableAsyncIterator<ProgressResponse>>} - The response object or a stream of progress responses.
   */
  async create(request) {
    return this.processStreamableRequest("create", {
      ...request
    });
  }
  /**
   * Pulls a model from the Ollama registry. The request object can contain a stream flag to indicate if the
   * response should be streamed.
   * @param request {PullRequest} - The request object.
   * @returns {Promise<ProgressResponse | AbortableAsyncIterator<ProgressResponse>>} - The response object or
   * an AbortableAsyncIterator that yields response messages.
   */
  async pull(request) {
    return this.processStreamableRequest("pull", {
      name: request.model,
      stream: request.stream,
      insecure: request.insecure
    });
  }
  /**
   * Pushes a model to the Ollama registry. The request object can contain a stream flag to indicate if the
   * response should be streamed.
   * @param request {PushRequest} - The request object.
   * @returns {Promise<ProgressResponse | AbortableAsyncIterator<ProgressResponse>>} - The response object or
   * an AbortableAsyncIterator that yields response messages.
   */
  async push(request) {
    return this.processStreamableRequest("push", {
      name: request.model,
      stream: request.stream,
      insecure: request.insecure
    });
  }
  /**
   * Deletes a model from the server. The request object should contain the name of the model to
   * delete.
   * @param request {DeleteRequest} - The request object.
   * @returns {Promise<StatusResponse>} - The response object.
   */
  async delete(request) {
    await del(
      this.fetch,
      `${this.config.host}/api/delete`,
      { name: request.model },
      { headers: this.config.headers }
    );
    return { status: "success" };
  }
  /**
   * Copies a model from one name to another. The request object should contain the name of the
   * model to copy and the new name.
   * @param request {CopyRequest} - The request object.
   * @returns {Promise<StatusResponse>} - The response object.
   */
  async copy(request) {
    await post(this.fetch, `${this.config.host}/api/copy`, { ...request }, {
      headers: this.config.headers
    });
    return { status: "success" };
  }
  /**
   * Lists the models on the server.
   * @returns {Promise<ListResponse>} - The response object.
   * @throws {Error} - If the response body is missing.
   */
  async list() {
    const response = await get(this.fetch, `${this.config.host}/api/tags`, {
      headers: this.config.headers
    });
    return await response.json();
  }
  /**
   * Shows the metadata of a model. The request object should contain the name of the model.
   * @param request {ShowRequest} - The request object.
   * @returns {Promise<ShowResponse>} - The response object.
   */
  async show(request) {
    const response = await post(this.fetch, `${this.config.host}/api/show`, {
      ...request
    }, {
      headers: this.config.headers
    });
    return await response.json();
  }
  /**
   * Embeds text input into vectors.
   * @param request {EmbedRequest} - The request object.
   * @returns {Promise<EmbedResponse>} - The response object.
   */
  async embed(request) {
    const response = await post(this.fetch, `${this.config.host}/api/embed`, {
      ...request
    }, {
      headers: this.config.headers
    });
    return await response.json();
  }
  /**
   * Embeds a text prompt into a vector.
   * @param request {EmbeddingsRequest} - The request object.
   * @returns {Promise<EmbeddingsResponse>} - The response object.
   */
  async embeddings(request) {
    const response = await post(this.fetch, `${this.config.host}/api/embeddings`, {
      ...request
    }, {
      headers: this.config.headers
    });
    return await response.json();
  }
  /**
   * Lists the running models on the server
   * @returns {Promise<ListResponse>} - The response object.
   * @throws {Error} - If the response body is missing.
   */
  async ps() {
    const response = await get(this.fetch, `${this.config.host}/api/ps`, {
      headers: this.config.headers
    });
    return await response.json();
  }
};
var browser = new Ollama$1();

// node_modules/ollama/dist/index.mjs
var Ollama2 = class extends Ollama$1 {
  async encodeImage(image) {
    if (typeof image !== "string") {
      return Buffer.from(image).toString("base64");
    }
    try {
      if (import_fs.default.existsSync(image)) {
        const fileBuffer = await import_fs.promises.readFile((0, import_path.resolve)(image));
        return Buffer.from(fileBuffer).toString("base64");
      }
    } catch (e) {
    }
    return image;
  }
  /**
   * checks if a file exists
   * @param path {string} - The path to the file
   * @private @internal
   * @returns {Promise<boolean>} - Whether the file exists or not
   */
  async fileExists(path) {
    try {
      await import_fs.promises.access(path);
      return true;
    } catch (e) {
      return false;
    }
  }
  async create(request) {
    if (request.from && await this.fileExists((0, import_path.resolve)(request.from))) {
      throw Error("Creating with a local path is not currently supported from ollama-js");
    }
    if (request.stream) {
      return super.create(request);
    } else {
      return super.create(request);
    }
  }
};
var index = new Ollama2();

// src/providers/ollama/provider.ts
var OllamaProvider = class {
  constructor(settins) {
    this.aborted = false;
    this.settings = settins;
    this.client = new Ollama2({ host: this.settings.host });
  }
  async *generate(editor, options) {
    this.aborted = false;
    const prompt = preparePrompt(editor, options.userPrompt);
    const completionIterator = await this.client.generate({
      model: options.model,
      prompt,
      system: options.systemPrompt,
      stream: true,
      options: {
        temperature: options.temperature
      }
    });
    const initialPosition = editor.getCursor();
    let completion = "";
    for await (let response of completionIterator) {
      if (this.aborted) {
        return;
      }
      const currentPosition = editor.getCursor();
      if (currentPosition.line !== initialPosition.line || currentPosition.ch !== initialPosition.ch) {
        console.log("cursor moved, aborting completion");
        this.abort();
        return;
      }
      completion += response.response;
      yield completion;
    }
  }
  async abort() {
    if (this.aborted)
      return;
    this.client.abort();
    this.aborted = true;
    console.log("aborted completion");
  }
  async updateModels() {
    const response = await this.client.list();
    this.settings.models = response.models.map((model) => model.name);
    return this.settings.models;
  }
};

// src/providers/openai/provider.ts
var OpenAIProvider = class {
  constructor(settings) {
    this.settings = settings;
  }
  updateModels() {
    return ["gpt-4", "davinci"];
  }
};

// src/providers/factory.ts
var ProviderFactory = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.settings = this.plugin.settings;
    this.providers = buildProviders(this.settings);
  }
  rebuildProviders() {
    this.providers = buildProviders(this.settings);
  }
  getProvider(provider) {
    return this.providers[provider];
  }
  async updateModels(provider) {
    return this.providers[provider].updateModels();
  }
};
var buildProviders = (settings) => {
  return {
    ["ollama" /* OLLAMA */]: new OllamaProvider(settings.providers.ollama),
    ["openai" /* OPENAI */]: new OpenAIProvider(settings.providers.openai)
  };
};

// src/profile/service.ts
var ProfileService = class {
  constructor(plugin) {
    this.inlineSuggestionOptions = { delayMs: 300, splitStrategy: "sentence" };
    this.profileChangeCallbacks = [];
    this.plugin = plugin;
    this.app = this.plugin.app;
    this.settings = this.plugin.settings;
    this.update(this.getActiveFilePath());
    this.app.workspace.on("file-open", (file) => {
      if (!file)
        return;
      this.update(file.path);
    });
  }
  getActiveProfileMapping() {
    return [this.activePathMapping, this.activeProfile];
  }
  getActiveProfile() {
    return this.activeProfile;
  }
  getOptions() {
    return this.inlineSuggestionOptions;
  }
  onProfileChange(callback) {
    this.profileChangeCallbacks.push(callback);
  }
  update(filePath) {
    [this.activePathMapping, this.activeProfile] = this.resolveProfileFromPath(filePath);
    this.inlineSuggestionOptions = { delayMs: this.activeProfile.delayMs, splitStrategy: this.activeProfile.splitStrategy };
    this.profileChangeCallbacks.forEach((cb) => cb(this.activeProfile));
  }
  getActiveFilePath() {
    const activeEditor = this.app.workspace.activeEditor;
    if (!activeEditor)
      return "";
    if (!activeEditor.file)
      return "";
    return activeEditor.file.path;
  }
  resolveProfileFromPath(filePath) {
    if (!this.settings.path_configs || Object.keys(this.settings.path_configs).length === 0) {
      return [DEFAULT_PATH, this.settings.profiles[DEFAULT_PROFILE]];
    }
    const normalizedPath = filePath.replace(/^\/+|\/+$/g, "");
    let longestMatch = "";
    let matchedProfile = DEFAULT_PROFILE;
    let pathMapping = "/";
    Object.entries(this.settings.path_configs).forEach(([path, mapping]) => {
      const normalizedMappingPath = path.replace(/^\/+|\/+$/g, "");
      if (normalizedPath.startsWith(normalizedMappingPath)) {
        if (normalizedMappingPath.length > longestMatch.length) {
          longestMatch = normalizedMappingPath;
          matchedProfile = mapping.profile;
          pathMapping = path;
        }
      }
    });
    return [pathMapping, this.settings.profiles[matchedProfile]];
  }
  onunload() {
    this.app.workspace.off("file-open", this.update);
  }
};

// src/completion/service.ts
var CompletionService = class {
  constructor(app, profileTracker, providerFactory) {
    this.completionStatusListeners = [];
    this.app = app;
    this.profileTracker = profileTracker;
    this.providerFactory = providerFactory;
  }
  async *fetchCompletion() {
    const activeEditor = this.app.workspace.activeEditor;
    if (!activeEditor)
      return;
    if (!activeEditor.editor)
      return;
    const [, profile] = this.profileTracker.getActiveProfileMapping();
    const provider = this.providerFactory.getProvider(profile.provider);
    const options = profile.completionOptions;
    this.notifyCompletionStatus(true);
    yield* this.complete(activeEditor.editor, provider, options);
    this.notifyCompletionStatus(false);
  }
  onCompletionStatusChange(listener) {
    this.completionStatusListeners.push(listener);
  }
  notifyCompletionStatus(isGenerating) {
    for (const listener of this.completionStatusListeners) {
      listener(isGenerating);
    }
  }
  async *complete(editor, provider, options) {
    await provider.abort();
    const cursor = editor.getCursor();
    const currentLine = editor.getLine(cursor.line);
    if (!currentLine.length)
      return;
    const lastChar = currentLine[cursor.ch - 1];
    if (lastChar !== " ")
      return;
    for await (const text of provider.generate(editor, options)) {
      yield { text };
    }
  }
};

// src/statusbar/statusbar.ts
var import_obsidian3 = require("obsidian");
var StatusBarItem = class {
  constructor(plugin, profileTracker, completionEngine) {
    this.plugin = plugin;
    this.profileService = profileTracker;
    this.completionEngine = completionEngine;
    this.profileService.onProfileChange(this.handleProfileChange.bind(this));
    this.completionEngine.onCompletionStatusChange(this.handleCompletionStatusChange.bind(this));
    this.statusBarItem = this.createStatusBarItem();
    this.updateCompletionEnabledState();
  }
  createStatusBarItem() {
    const item = this.plugin.addStatusBarItem();
    (0, import_obsidian3.setIcon)(item, "feather");
    item.addClasses(["status-bar-item-icon", `mod-clickable`]);
    item.addEventListener("click", this.showContextMenu.bind(this));
    return item;
  }
  showContextMenu(event) {
    const menu = new import_obsidian3.Menu();
    const completionEnabled = true;
    menu.addItem((item) => {
      item.setTitle(`${completionEnabled ? "Disable" : "Enable"} completion globally`);
      item.onClick(() => {
        this.plugin.saveSettings();
        this.updateCompletionEnabledState();
      });
    });
    menu.addItem((item) => {
      const [path] = this.profileService.getActiveProfileMapping();
      item.setTitle(`Disable for current path: ${path}`);
      item.onClick(() => {
        const mapping = this.plugin.settings.path_configs[path];
        mapping.enabled = false;
        this.plugin.saveSettings();
      });
    });
    menu.addSeparator();
    menu.addItem((item) => {
      item.setTitle("Open settings");
      item.onClick(() => {
        const setting = this.plugin.app.setting;
        setting.open();
        setting.openTabById(this.plugin.manifest.id);
      });
    });
    menu.showAtMouseEvent(event);
  }
  updateCompletionEnabledState() {
    const randomBytes = new Uint8Array(1);
    window.crypto.getRandomValues(randomBytes);
    if (randomBytes[0] < 128) {
      this.statusBarItem.removeClass("completion-disabled");
      (0, import_obsidian3.setTooltip)(this.statusBarItem, `Profile: ${this.profileService.getActiveProfile().name}`, { placement: "top" });
    } else {
      this.statusBarItem.addClass("completion-disabled");
      (0, import_obsidian3.setTooltip)(this.statusBarItem, `Completion disabled`, { placement: "top" });
    }
  }
  handleCompletionStatusChange(isGenerating) {
    if (isGenerating) {
      this.statusBarItem.addClass("active");
      (0, import_obsidian3.setTooltip)(this.statusBarItem, "Generating...", { placement: "top" });
    } else {
      this.statusBarItem.removeClass("active");
      this.updateProfile(this.profileService.getActiveProfile().name);
    }
  }
  handleProfileChange(profile) {
    this.updateProfile(profile);
  }
  updateProfile(profile) {
    if (true) {
      (0, import_obsidian3.setTooltip)(this.statusBarItem, `Profile: ${profile}`, { placement: "top" });
    }
  }
};

// src/main.ts
var Inscribe = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    this.profileService = new ProfileService(this);
    this.providerFactory = new ProviderFactory(this);
    this.completionEngine = new CompletionService(this.app, this.profileService, this.providerFactory);
    this.statusBarItem = new StatusBarItem(this, this.profileService, this.completionEngine);
    this.addSettingTab(new InscribeSettingsTab(this));
    await this.setupExtension();
  }
  async onunload() {
    this.profileService.onunload();
  }
  async setupExtension() {
    const extension = inlineSuggestions({
      fetchFunc: () => this.completionEngine.fetchCompletion(),
      getOptions: () => this.profileService.getOptions()
    });
    this.registerEditorExtension(extension);
  }
  async loadSettings() {
    this.settings = Object.assign(
      {},
      DEFAULT_SETTINGS,
      await this.loadData()
    );
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.providerFactory.rebuildProviders();
  }
};
/*! Bundled license information:

mustache/mustache.mjs:
  (*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   *)
*/
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2V4dGVuc2lvbi9pbmRleC50cyIsICJzcmMvc2V0dGluZ3Mvc2V0dGluZ3MudHMiLCAic3JjL3NldHRpbmdzL3NldHRpbmdzLXRhYi50cyIsICJub2RlX21vZHVsZXMvbXVzdGFjaGUvbXVzdGFjaGUubWpzIiwgInNyYy9wcm9tcHQvaW5kZXgudHMiLCAic3JjL3NldHRpbmdzL3Byb3ZpZGVyLXNldHRpbmdzLW1vZGFsLnRzIiwgIm5vZGVfbW9kdWxlcy9vbGxhbWEvZGlzdC9pbmRleC5tanMiLCAibm9kZV9tb2R1bGVzL3doYXR3Zy1mZXRjaC9mZXRjaC5qcyIsICJub2RlX21vZHVsZXMvb2xsYW1hL2Rpc3QvYnJvd3Nlci5tanMiLCAic3JjL3Byb3ZpZGVycy9vbGxhbWEvcHJvdmlkZXIudHMiLCAic3JjL3Byb3ZpZGVycy9vcGVuYWkvcHJvdmlkZXIudHMiLCAic3JjL3Byb3ZpZGVycy9mYWN0b3J5LnRzIiwgInNyYy9wcm9maWxlL3NlcnZpY2UudHMiLCAic3JjL2NvbXBsZXRpb24vc2VydmljZS50cyIsICJzcmMvc3RhdHVzYmFyL3N0YXR1c2Jhci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgaW5saW5lU3VnZ2VzdGlvbnMgfSBmcm9tIFwiLi9leHRlbnNpb25cIjtcbmltcG9ydCB7IFNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zZXR0aW5ncy9zZXR0aW5ncyc7XG5pbXBvcnQgSW5zY3JpYmVTZXR0aW5nc1RhYiBmcm9tICcuL3NldHRpbmdzL3NldHRpbmdzLXRhYic7XG5pbXBvcnQgeyBQcm92aWRlckZhY3RvcnkgfSBmcm9tICcuL3Byb3ZpZGVycy9mYWN0b3J5JztcbmltcG9ydCB7IFByb2ZpbGVTZXJ2aWNlIH0gZnJvbSAnLi9wcm9maWxlL3NlcnZpY2UnO1xuaW1wb3J0IENvbXBsZXRpb25TZXJ2aWNlIGZyb20gJy4vY29tcGxldGlvbi9zZXJ2aWNlJztcbmltcG9ydCBTdGF0dXNCYXJJdGVtIGZyb20gJy4vc3RhdHVzYmFyL3N0YXR1c2Jhcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEluc2NyaWJlIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3M6IFNldHRpbmdzO1xuXHRwcm92aWRlckZhY3Rvcnk6IFByb3ZpZGVyRmFjdG9yeTtcblxuXHRwcml2YXRlIHByb2ZpbGVTZXJ2aWNlOiBQcm9maWxlU2VydmljZTtcblx0cHJpdmF0ZSBjb21wbGV0aW9uRW5naW5lOiBDb21wbGV0aW9uU2VydmljZTtcblx0cHJpdmF0ZSBzdGF0dXNCYXJJdGVtOiBTdGF0dXNCYXJJdGVtO1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG5cdFx0dGhpcy5wcm9maWxlU2VydmljZSA9IG5ldyBQcm9maWxlU2VydmljZSh0aGlzKTtcblx0XHR0aGlzLnByb3ZpZGVyRmFjdG9yeSA9IG5ldyBQcm92aWRlckZhY3RvcnkodGhpcyk7XG5cdFx0dGhpcy5jb21wbGV0aW9uRW5naW5lID0gbmV3IENvbXBsZXRpb25TZXJ2aWNlKHRoaXMuYXBwLCB0aGlzLnByb2ZpbGVTZXJ2aWNlLCB0aGlzLnByb3ZpZGVyRmFjdG9yeSk7XG5cdFx0dGhpcy5zdGF0dXNCYXJJdGVtID0gbmV3IFN0YXR1c0Jhckl0ZW0odGhpcywgdGhpcy5wcm9maWxlU2VydmljZSwgdGhpcy5jb21wbGV0aW9uRW5naW5lKTtcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgSW5zY3JpYmVTZXR0aW5nc1RhYih0aGlzKSk7XG5cdFx0YXdhaXQgdGhpcy5zZXR1cEV4dGVuc2lvbigpO1xuXHR9XG5cblx0YXN5bmMgb251bmxvYWQoKSB7XG5cdFx0dGhpcy5wcm9maWxlU2VydmljZS5vbnVubG9hZCgpO1xuXHR9XG5cblx0YXN5bmMgc2V0dXBFeHRlbnNpb24oKSB7XG5cdFx0Y29uc3QgZXh0ZW5zaW9uID0gaW5saW5lU3VnZ2VzdGlvbnMoe1xuXHRcdFx0ZmV0Y2hGdW5jOiAoKSA9PiB0aGlzLmNvbXBsZXRpb25FbmdpbmUuZmV0Y2hDb21wbGV0aW9uKCksXG5cdFx0XHRnZXRPcHRpb25zOiAoKSA9PiB0aGlzLnByb2ZpbGVTZXJ2aWNlLmdldE9wdGlvbnMoKVxuXHRcdH0pO1xuXHRcdHRoaXMucmVnaXN0ZXJFZGl0b3JFeHRlbnNpb24oZXh0ZW5zaW9uKTtcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbihcblx0XHRcdHt9LFxuXHRcdFx0REVGQVVMVF9TRVRUSU5HUyxcblx0XHRcdGF3YWl0IHRoaXMubG9hZERhdGEoKVxuXHRcdCk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0XHR0aGlzLnByb3ZpZGVyRmFjdG9yeS5yZWJ1aWxkUHJvdmlkZXJzKCk7XG5cdH1cbn0iLCAiLyoqXG4gKiBJbnRlbGxpZ2VudCBJbmxpbmUgQ29tcGxldGlvbnMgZm9yIENvZGVNaXJyb3JcbiAqXG4gKiBUaGlzIGV4dGVuc2lvbiBvZmZlcnMgQUktcG93ZXJlZCBpbmxpbmUgc3VnZ2VzdGlvbnMgd2l0aDpcbiAqIC0gQ29uZmlndXJhYmxlIHN1Z2dlc3Rpb24gZmV0Y2hpbmcgc3RyYXRlZ2llc1xuICogLSBNdWx0aXBsZSB0ZXh0IHNlZ21lbnRhdGlvbiBhcHByb2FjaGVzXG4gKiAtIERlYm91bmNlZCBuZXR3b3JrIHJlcXVlc3RzXG4gKiAtIE5vbi1pbnZhc2l2ZSBzdWdnZXN0aW9uIHJlbmRlcmluZ1xuICovXG5cbmltcG9ydCB7XG4gICAgVmlld1BsdWdpbixcbiAgICBFZGl0b3JWaWV3LFxuICAgIFZpZXdVcGRhdGUsXG4gICAgRGVjb3JhdGlvbixcbiAgICBXaWRnZXRUeXBlLFxuICAgIGtleW1hcCxcbn0gZnJvbSAnQGNvZGVtaXJyb3Ivdmlldyc7XG5pbXBvcnQge1xuICAgIFN0YXRlRWZmZWN0LFxuICAgIFRleHQsXG4gICAgU3RhdGVGaWVsZCxcbiAgICBFZGl0b3JTdGF0ZSxcbiAgICBFZGl0b3JTZWxlY3Rpb24sXG4gICAgVHJhbnNhY3Rpb24sXG4gICAgUHJlYyxcbn0gZnJvbSAnQGNvZGVtaXJyb3Ivc3RhdGUnO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgVHlwZSBEZWZpbml0aW9uc1xuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vKiogU3VwcG9ydGVkIHNlZ21lbnRhdGlvbiBzdHJhdGVnaWVzICovXG5leHBvcnQgdHlwZSBTcGxpdFN0cmF0ZWd5ID0ga2V5b2YgdHlwZW9mIFRleHRTcGxpdFN0cmF0ZWdpZXM7XG5cbi8qKiBJbmxpbmUgc3VnZ2VzdGlvbiBzdHJ1Y3R1cmUgXHUyMDEzIG5vdyBvbmx5IGNhcnJpZXMgdGV4dC4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3VnZ2VzdGlvbiB7XG4gICAgdGV4dDogc3RyaW5nO1xufVxuXG4vKiogSW5saW5lIGNvbXBsZXRpb24gY29uZmlndXJhdGlvbi5cbiAqIFxuICogTm90ZTogSW5zdGVhZCBvZiBlYWNoIHN1Z2dlc3Rpb24gY2FycnlpbmcgaXRzIHNwbGl0IHN0cmF0ZWd5LFxuICogeW91IHN1cHBseSBhIGR5bmFtaWMgZ2V0dGVyIGZ1bmN0aW9uIChgZ2V0T3B0aW9uc2ApIHNvIHRoYXQgdGhlIGV4dGVuc2lvblxuICogYWx3YXlzIHVzZXMgdGhlIGN1cnJlbnQgc2V0dGluZ3MuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSW5saW5lQ29tcGxldGlvbkNvbmZpZyB7XG4gICAgZmV0Y2hGdW5jOiAoXG4gICAgICAgIHN0YXRlOiBFZGl0b3JTdGF0ZVxuICAgICkgPT4gQXN5bmNHZW5lcmF0b3I8U3VnZ2VzdGlvbj4gfCBQcm9taXNlPFN1Z2dlc3Rpb24+O1xuICAgIC8qKiAoT3B0aW9uYWwpIEEgc3RhdGljIGhvdGtleSBmb3IgYWNjZXB0aW5nIHN1Z2dlc3Rpb25zLiAqL1xuICAgIGFjY2VwdGFuY2VIb3RrZXk/OiBzdHJpbmc7XG4gICAgLyoqIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGN1cnJlbnQgb3B0aW9ucy4gKi9cbiAgICBnZXRPcHRpb25zOiAoKSA9PiBJbmxpbmVDb21wbGV0aW9uT3B0aW9ucztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbmxpbmVDb21wbGV0aW9uT3B0aW9ucyB7XG4gICAgZGVsYXlNcz86IG51bWJlcjtcbiAgICBzcGxpdFN0cmF0ZWd5PzogU3BsaXRTdHJhdGVneTtcbn1cblxuLyoqIEludGVybmFsIHN0YXRlIGZvciB0aGUgY3VycmVudCBzdWdnZXN0aW9uIHNlc3Npb24uXG4gKiBOb3RlOiBUaGUgcHJldmlvdXMgXCJzZWdtZW50YXRpb25cIiBwcm9wZXJ0eSBoYXMgYmVlbiByZW1vdmVkLlxuICovXG5pbnRlcmZhY2UgU3VnZ2VzdGlvblNlc3Npb24ge1xuICAgIGZ1bGxUZXh0OiBzdHJpbmcgfCBudWxsO1xuICAgIHJlbWFpbmluZ1RleHQ6IHN0cmluZyB8IG51bGw7XG4gICAgYmFzZWxpbmVEb2N1bWVudDogVGV4dCB8IG51bGw7XG4gICAgYW5jaG9yUG9zaXRpb246IG51bWJlciB8IG51bGw7XG59XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICBUZXh0IFNlZ21lbnRhdGlvbiBTdHJhdGVnaWVzXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8qKlxuICogQSBzZXQgb2YgdGV4dCBzcGxpdHRpbmcgZnVuY3Rpb25zIHVzZWQgdG8gZGV0ZXJtaW5lIGhvdyBtdWNoIG9mIHRoZVxuICogc3VnZ2VzdGlvbiB0byBhY2NlcHQgd2hlbiB0cmlnZ2VyZWQuXG4gKi9cbmNvbnN0IFRleHRTcGxpdFN0cmF0ZWdpZXMgPSB7XG4gICAgLyoqXG4gICAgICogV29yZC1sZXZlbCBzZWdtZW50YXRpb24gKHNwYWNlLWRlbGltaXRlZCkuXG4gICAgICogQWNjZXB0cyB0ZXh0IHVudGlsIChhbmQgaW5jbHVkaW5nKSB0aGUgZmlyc3Qgc3BhY2UuXG4gICAgICovXG4gICAgd29yZDogKHRleHQ6IHN0cmluZykgPT4ge1xuICAgICAgICBjb25zdCBuZXh0U3BhY2UgPSB0ZXh0LmluZGV4T2YoJyAnKTtcbiAgICAgICAgcmV0dXJuIG5leHRTcGFjZSA9PT0gLTFcbiAgICAgICAgICAgID8geyBhY2NlcHRlZDogdGV4dCwgcmVtYWluaW5nOiAnJyB9XG4gICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICBhY2NlcHRlZDogdGV4dC5zbGljZSgwLCBuZXh0U3BhY2UgKyAxKSxcbiAgICAgICAgICAgICAgICByZW1haW5pbmc6IHRleHQuc2xpY2UobmV4dFNwYWNlICsgMSksXG4gICAgICAgICAgICB9O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTZW50ZW5jZS1sZXZlbCBzZWdtZW50YXRpb24gKHB1bmN0dWF0aW9uIGZvbGxvd2VkIGJ5IHdoaXRlc3BhY2UpLlxuICAgICAqL1xuICAgIHNlbnRlbmNlOiAodGV4dDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gdGV4dC5tYXRjaCgvWy4hP11cXHMrLyk7XG4gICAgICAgIGlmIChtYXRjaCAmJiBtYXRjaC5pbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGFjY2VwdGVkOiB0ZXh0LnNsaWNlKDAsIG1hdGNoLmluZGV4ICsgMSksXG4gICAgICAgICAgICAgICAgcmVtYWluaW5nOiB0ZXh0LnNsaWNlKG1hdGNoLmluZGV4ICsgMSksXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IGFjY2VwdGVkOiB0ZXh0LCByZW1haW5pbmc6ICcnIH07XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFBhcmFncmFwaC1sZXZlbCBzZWdtZW50YXRpb24gKGRvdWJsZSBuZXdsaW5lKS5cbiAgICAgKi9cbiAgICBwYXJhZ3JhcGg6ICh0ZXh0OiBzdHJpbmcpID0+IHtcbiAgICAgICAgY29uc3QgcGFyYWdyYXBoRW5kID0gdGV4dC5pbmRleE9mKCdcXG5cXG4nKTtcbiAgICAgICAgcmV0dXJuIHBhcmFncmFwaEVuZCA9PT0gLTFcbiAgICAgICAgICAgID8geyBhY2NlcHRlZDogdGV4dCwgcmVtYWluaW5nOiAnJyB9XG4gICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICBhY2NlcHRlZDogdGV4dC5zbGljZSgwLCBwYXJhZ3JhcGhFbmQgKyAyKSxcbiAgICAgICAgICAgICAgICByZW1haW5pbmc6IHRleHQuc2xpY2UocGFyYWdyYXBoRW5kICsgMiksXG4gICAgICAgICAgICB9O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBdG9taWMgYWNjZXB0YW5jZSBcdTIwMTMgY29uc3VtZSB0aGUgZW50aXJlIHN1Z2dlc3Rpb24uXG4gICAgICovXG4gICAgZnVsbDogKHRleHQ6IHN0cmluZykgPT4gKHsgYWNjZXB0ZWQ6IHRleHQsIHJlbWFpbmluZzogJycgfSksXG59IGFzIGNvbnN0O1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgU3VnZ2VzdGlvbiBTZXNzaW9uIFN0YXRlIE1hbmFnZW1lbnRcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqXG4gKiBFZmZlY3QgdG8gdXBkYXRlIHRoZSBzdWdnZXN0aW9uIHNlc3Npb24gc3RhdGUuXG4gKiBBIGBudWxsYCBjb250ZW50IHNpZ25hbHMgYSByZXNldC5cbiAqL1xuY29uc3QgU3VnZ2VzdGlvblVwZGF0ZUVmZmVjdCA9IFN0YXRlRWZmZWN0LmRlZmluZTx7XG4gICAgY29udGVudDogc3RyaW5nIHwgbnVsbDtcbiAgICBkb2N1bWVudDogVGV4dCB8IG51bGw7XG4gICAgYW5jaG9yOiBudW1iZXIgfCBudWxsO1xufT4oKTtcblxuLyoqXG4gKiBUaGUgc3RhdGUgZmllbGQgdGhhdCBob2xkcyB0aGUgY3VycmVudCBzdWdnZXN0aW9uIHNlc3Npb24uXG4gKi9cbmNvbnN0IHN1Z2dlc3Rpb25TZXNzaW9uU3RhdGUgPSBTdGF0ZUZpZWxkLmRlZmluZTxTdWdnZXN0aW9uU2Vzc2lvbj4oe1xuICAgIGNyZWF0ZTogKCkgPT4gZ2V0UmVzZXRTZXNzaW9uKCksXG5cbiAgICB1cGRhdGUoc2Vzc2lvbiwgdHJhbnNhY3Rpb24pIHtcbiAgICAgICAgLy8gUHJvY2VzcyBleHBsaWNpdCBzZXNzaW9uIHVwZGF0ZSBlZmZlY3RzLlxuICAgICAgICBjb25zdCBlZmZlY3QgPSB0cmFuc2FjdGlvbi5lZmZlY3RzLmZpbmQoKGUpID0+XG4gICAgICAgICAgICBlLmlzKFN1Z2dlc3Rpb25VcGRhdGVFZmZlY3QpXG4gICAgICAgICk7XG4gICAgICAgIGlmIChlZmZlY3QpIHJldHVybiB1cGRhdGVTZXNzaW9uRnJvbUVmZmVjdChlZmZlY3QudmFsdWUpO1xuXG4gICAgICAgIC8vIElmIHRoZSBkb2N1bWVudCBoYXMgY2hhbmdlZCwgYWRqdXN0IHRoZSBzZXNzaW9uLlxuICAgICAgICBpZiAoXG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5kb2NDaGFuZ2VkICYmXG4gICAgICAgICAgICBzZXNzaW9uLnJlbWFpbmluZ1RleHQgJiZcbiAgICAgICAgICAgIHNlc3Npb24uYW5jaG9yUG9zaXRpb24gIT09IG51bGxcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlU2Vzc2lvbk9uRG9jdW1lbnRDaGFuZ2Uoc2Vzc2lvbiwgdHJhbnNhY3Rpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYW4gYWN0aXZlIHN1Z2dlc3Rpb24gYnV0IHRoZSBjdXJzb3IgaGFzIG1vdmVkLCBjYW5jZWwgaXQuXG4gICAgICAgIGlmIChzZXNzaW9uLnJlbWFpbmluZ1RleHQgIT09IG51bGwgJiYgc2Vzc2lvbi5hbmNob3JQb3NpdGlvbiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZVNlc3Npb25PbkN1cnNvckRyaWZ0KHNlc3Npb24sIHRyYW5zYWN0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXNzaW9uO1xuICAgIH0sXG59KTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgZnJlc2gsIGVtcHR5IHN1Z2dlc3Rpb24gc2Vzc2lvbi5cbiAqL1xuZnVuY3Rpb24gZ2V0UmVzZXRTZXNzaW9uKCk6IFN1Z2dlc3Rpb25TZXNzaW9uIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBmdWxsVGV4dDogbnVsbCxcbiAgICAgICAgcmVtYWluaW5nVGV4dDogbnVsbCxcbiAgICAgICAgYmFzZWxpbmVEb2N1bWVudDogbnVsbCxcbiAgICAgICAgYW5jaG9yUG9zaXRpb246IG51bGwsXG4gICAgfTtcbn1cblxuLyoqXG4gKiBVcGRhdGUgc2Vzc2lvbiBzdGF0ZSBiYXNlZCBvbiBhbiBpbmNvbWluZyBlZmZlY3QuXG4gKi9cbmZ1bmN0aW9uIHVwZGF0ZVNlc3Npb25Gcm9tRWZmZWN0KGVmZmVjdDoge1xuICAgIGNvbnRlbnQ6IHN0cmluZyB8IG51bGw7XG4gICAgZG9jdW1lbnQ6IFRleHQgfCBudWxsO1xuICAgIGFuY2hvcjogbnVtYmVyIHwgbnVsbDtcbn0pOiBTdWdnZXN0aW9uU2Vzc2lvbiB7XG4gICAgcmV0dXJuIGVmZmVjdC5jb250ZW50ID09PSBudWxsXG4gICAgICAgID8gZ2V0UmVzZXRTZXNzaW9uKClcbiAgICAgICAgOiBpbml0aWFsaXplU2Vzc2lvbihlZmZlY3QgYXMge1xuICAgICAgICAgICAgY29udGVudDogc3RyaW5nO1xuICAgICAgICAgICAgZG9jdW1lbnQ6IFRleHQ7XG4gICAgICAgICAgICBhbmNob3I6IG51bWJlcjtcbiAgICAgICAgfSk7XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYSBuZXcgc3VnZ2VzdGlvbiBzZXNzaW9uIHdpdGggcHJvdmlkZWQgZWZmZWN0IGRhdGEuXG4gKi9cbmZ1bmN0aW9uIGluaXRpYWxpemVTZXNzaW9uKGVmZmVjdDoge1xuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICBkb2N1bWVudDogVGV4dDtcbiAgICBhbmNob3I6IG51bWJlcjtcbn0pOiBTdWdnZXN0aW9uU2Vzc2lvbiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZnVsbFRleHQ6IGVmZmVjdC5jb250ZW50LFxuICAgICAgICByZW1haW5pbmdUZXh0OiBlZmZlY3QuY29udGVudCxcbiAgICAgICAgYmFzZWxpbmVEb2N1bWVudDogZWZmZWN0LmRvY3VtZW50LFxuICAgICAgICBhbmNob3JQb3NpdGlvbjogZWZmZWN0LmFuY2hvcixcbiAgICB9O1xufVxuXG4vKipcbiAqIEFkanVzdCB0aGUgc3VnZ2VzdGlvbiBzZXNzaW9uIGluIHJlc3BvbnNlIHRvIGRvY3VtZW50IGNoYW5nZXMuXG4gKi9cbmZ1bmN0aW9uIHVwZGF0ZVNlc3Npb25PbkRvY3VtZW50Q2hhbmdlKFxuICAgIHNlc3Npb246IFN1Z2dlc3Rpb25TZXNzaW9uLFxuICAgIHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvblxuKTogU3VnZ2VzdGlvblNlc3Npb24ge1xuICAgIGxldCBpbnNlcnRlZENvbnRlbnQgPSAnJztcbiAgICBsZXQgaW5zZXJ0aW9uQXRBbmNob3IgPSBmYWxzZTtcblxuICAgIC8vIEl0ZXJhdGUgb3ZlciBkb2N1bWVudCBjaGFuZ2VzIHRvIGRldGVjdCBhbiBpbnNlcnRpb24gYXQgdGhlIHN1Z2dlc3Rpb24ncyBhbmNob3IuXG4gICAgdHJhbnNhY3Rpb24uY2hhbmdlcy5pdGVyQ2hhbmdlcygoZnJvbUEsIHRvQSwgX2Zyb21CLCBfdG9CLCBpbnNlcnRlZCkgPT4ge1xuICAgICAgICBpZiAoZnJvbUEgPT09IHNlc3Npb24uYW5jaG9yUG9zaXRpb24gJiYgdG9BID09PSBmcm9tQSkge1xuICAgICAgICAgICAgaW5zZXJ0ZWRDb250ZW50ID0gaW5zZXJ0ZWQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGluc2VydGlvbkF0QW5jaG9yID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKCFpbnNlcnRpb25BdEFuY2hvciB8fCAhc2Vzc2lvbi5yZW1haW5pbmdUZXh0KSB7XG4gICAgICAgIHJldHVybiBpbnZhbGlkYXRlU2Vzc2lvbihzZXNzaW9uKTtcbiAgICB9XG5cbiAgICAvLyBWZXJpZnkgdGhlIGluc2VydGVkIHRleHQgbWF0Y2hlcyB0aGUgcGVuZGluZyBzdWdnZXN0aW9uLlxuICAgIGlmIChzZXNzaW9uLnJlbWFpbmluZ1RleHQuc3RhcnRzV2l0aChpbnNlcnRlZENvbnRlbnQpKSB7XG4gICAgICAgIHJldHVybiBhZHZhbmNlU2Vzc2lvbihzZXNzaW9uLCBpbnNlcnRlZENvbnRlbnQubGVuZ3RoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW52YWxpZGF0ZVNlc3Npb24oc2Vzc2lvbik7XG59XG5cbi8qKlxuICogQWR2YW5jZSB0aGUgc2Vzc2lvbiBieSBjb25zdW1pbmcgYWNjZXB0ZWQgdGV4dC5cbiAqL1xuZnVuY3Rpb24gYWR2YW5jZVNlc3Npb24oXG4gICAgc2Vzc2lvbjogU3VnZ2VzdGlvblNlc3Npb24sXG4gICAgY29uc3VtZWRMZW5ndGg6IG51bWJlclxuKTogU3VnZ2VzdGlvblNlc3Npb24ge1xuICAgIHJldHVybiB7XG4gICAgICAgIC4uLnNlc3Npb24sXG4gICAgICAgIHJlbWFpbmluZ1RleHQ6XG4gICAgICAgICAgICBzZXNzaW9uLnJlbWFpbmluZ1RleHQhLnNsaWNlKGNvbnN1bWVkTGVuZ3RoKS5sZW5ndGggPiAwXG4gICAgICAgICAgICAgICAgPyBzZXNzaW9uLnJlbWFpbmluZ1RleHQhLnNsaWNlKGNvbnN1bWVkTGVuZ3RoKVxuICAgICAgICAgICAgICAgIDogbnVsbCxcbiAgICAgICAgYW5jaG9yUG9zaXRpb246IHNlc3Npb24uYW5jaG9yUG9zaXRpb24hICsgY29uc3VtZWRMZW5ndGgsXG4gICAgfTtcbn1cblxuLyoqXG4gKiBJbnZhbGlkYXRlIHRoZSBzZXNzaW9uLCBlZmZlY3RpdmVseSBjYW5jZWxsaW5nIGFueSBwZW5kaW5nIHN1Z2dlc3Rpb24uXG4gKi9cbmZ1bmN0aW9uIGludmFsaWRhdGVTZXNzaW9uKHNlc3Npb246IFN1Z2dlc3Rpb25TZXNzaW9uKTogU3VnZ2VzdGlvblNlc3Npb24ge1xuICAgIHJldHVybiB7XG4gICAgICAgIC4uLnNlc3Npb24sXG4gICAgICAgIHJlbWFpbmluZ1RleHQ6IG51bGwsXG4gICAgICAgIGFuY2hvclBvc2l0aW9uOiBudWxsLFxuICAgIH07XG59XG5cbi8qKlxuICogQ2FuY2VsIHRoZSBzdWdnZXN0aW9uIGlmIHRoZSBjdXJzb3IgaGFzIGRyaWZ0ZWQgYXdheS5cbiAqL1xuZnVuY3Rpb24gdXBkYXRlU2Vzc2lvbk9uQ3Vyc29yRHJpZnQoXG4gICAgc2Vzc2lvbjogU3VnZ2VzdGlvblNlc3Npb24sXG4gICAgdHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uXG4pOiBTdWdnZXN0aW9uU2Vzc2lvbiB7XG4gICAgcmV0dXJuIHRyYW5zYWN0aW9uLnN0YXRlLnNlbGVjdGlvbi5tYWluLmhlYWQgIT09IHNlc3Npb24uYW5jaG9yUG9zaXRpb25cbiAgICAgICAgPyBpbnZhbGlkYXRlU2Vzc2lvbihzZXNzaW9uKVxuICAgICAgICA6IHNlc3Npb247XG59XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICBTdWdnZXN0aW9uIFJlbmRlcmluZyAoVmlzdWFsaXphdGlvbiBMYXllcilcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqXG4gKiBXaWRnZXQgZm9yIHJlbmRlcmluZyBpbmxpbmUgc3VnZ2VzdGlvbiB0ZXh0LlxuICovXG5jbGFzcyBTdWdnZXN0aW9uV2lkZ2V0IGV4dGVuZHMgV2lkZ2V0VHlwZSB7XG4gICAgc3RhdGljIHJlYWRvbmx5IE9QQUNJVFkgPSAwLjQ7XG4gICAgc3RhdGljIHJlYWRvbmx5IENTU19DTEFTUyA9ICdjbS1pbmxpbmUtcHJlZGljdGlvbic7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGNvbnRlbnQ6IHN0cmluZykge1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cblxuICAgIHRvRE9NKCk6IEhUTUxFbGVtZW50IHtcbiAgICAgICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgc3Bhbi5jbGFzc05hbWUgPSBTdWdnZXN0aW9uV2lkZ2V0LkNTU19DTEFTUztcbiAgICAgICAgc3Bhbi5zdHlsZS5vcGFjaXR5ID0gU3VnZ2VzdGlvbldpZGdldC5PUEFDSVRZLnRvU3RyaW5nKCk7XG4gICAgICAgIHNwYW4udGV4dENvbnRlbnQgPSB0aGlzLmNvbnRlbnQ7XG4gICAgICAgIHJldHVybiBzcGFuO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQbHVnaW4gdGhhdCByZW5kZXJzIGlubGluZSBzdWdnZXN0aW9uIGRlY29yYXRpb25zLlxuICovXG5jb25zdCBzdWdnZXN0aW9uUmVuZGVyZXIgPSBWaWV3UGx1Z2luLmZyb21DbGFzcyhcbiAgICBjbGFzcyB7XG4gICAgICAgIGRlY29yYXRpb25zID0gRGVjb3JhdGlvbi5ub25lO1xuXG4gICAgICAgIHVwZGF0ZSh1cGRhdGU6IFZpZXdVcGRhdGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSB1cGRhdGUuc3RhdGUuZmllbGQoc3VnZ2VzdGlvblNlc3Npb25TdGF0ZSk7XG4gICAgICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gc2Vzc2lvbi5yZW1haW5pbmdUZXh0XG4gICAgICAgICAgICAgICAgPyB0aGlzLmNyZWF0ZURlY29yYXRpb24odXBkYXRlLnZpZXcsIHNlc3Npb24ucmVtYWluaW5nVGV4dClcbiAgICAgICAgICAgICAgICA6IERlY29yYXRpb24ubm9uZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHByaXZhdGUgY3JlYXRlRGVjb3JhdGlvbih2aWV3OiBFZGl0b3JWaWV3LCBzdWdnZXN0aW9uVGV4dDogc3RyaW5nKSB7XG4gICAgICAgICAgICBjb25zdCBjdXJzb3JQb3NpdGlvbiA9IHZpZXcuc3RhdGUuc2VsZWN0aW9uLm1haW4uaGVhZDtcbiAgICAgICAgICAgIHJldHVybiBEZWNvcmF0aW9uLnNldChbXG4gICAgICAgICAgICAgICAgRGVjb3JhdGlvbi53aWRnZXQoe1xuICAgICAgICAgICAgICAgICAgICB3aWRnZXQ6IG5ldyBTdWdnZXN0aW9uV2lkZ2V0KHN1Z2dlc3Rpb25UZXh0KSxcbiAgICAgICAgICAgICAgICAgICAgc2lkZTogMSxcbiAgICAgICAgICAgICAgICB9KS5yYW5nZShjdXJzb3JQb3NpdGlvbiksXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgeyBkZWNvcmF0aW9uczogKHYpID0+IHYuZGVjb3JhdGlvbnMgfVxuKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgIFN1Z2dlc3Rpb24gRmV0Y2hpbmcgKERlYm91bmNlZCBGZXRjaGVyKVxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vKipcbiAqIENyZWF0ZXMgYSBkZWJvdW5jZWQgZmV0Y2hlciBmb3Igc3VnZ2VzdGlvbnMuXG4gKlxuICogQHBhcmFtIGZldGNoIC0gVGhlIHN1Z2dlc3Rpb24gZmV0Y2ggZnVuY3Rpb24uXG4gKiBAcGFyYW0gZ2V0RGVsYXkgLSBBIGZ1bmN0aW9uIHJldHVybmluZyB0aGUgY3VycmVudCBkZWJvdW5jZSBkZWxheSBpbiBtaWxsaXNlY29uZHMuXG4gKi9cbmNvbnN0IGNyZWF0ZURlYm91bmNlZEZldGNoZXIgPSAoXG4gICAgZmV0Y2g6IChzdGF0ZTogRWRpdG9yU3RhdGUpID0+IEFzeW5jR2VuZXJhdG9yPFN1Z2dlc3Rpb24+LFxuICAgIGdldERlbGF5OiAoKSA9PiBudW1iZXJcbikgPT4ge1xuICAgIGxldCBhY3RpdmVSZXF1ZXN0ID0gdHJ1ZTtcbiAgICBsZXQgdGltZW91dElkOiBSZXR1cm5UeXBlPHR5cGVvZiBzZXRUaW1lb3V0PjtcblxuICAgIC8qKlxuICAgICAqIFRocm90dGxlZCBmZXRjaCB0aGF0IHdhaXRzIGZvciB0aGUgZGVib3VuY2UgaW50ZXJ2YWwuXG4gICAgICovXG4gICAgY29uc3QgdGhyb3R0bGVkRmV0Y2ggPSBhc3luYyBmdW5jdGlvbiogKHN0YXRlOiBFZGl0b3JTdGF0ZSkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgYWN0aXZlUmVxdWVzdCA9IHRydWU7XG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KHJlc29sdmUsIGdldERlbGF5KCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGFjdGl2ZVJlcXVlc3QpIHlpZWxkKiBmZXRjaChzdGF0ZSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBsdWdpbiB0aGF0IGluaXRpYXRlcyBzdWdnZXN0aW9uIGZldGNoaW5nIG9uIGRvY3VtZW50IGNoYW5nZXMuXG4gICAgICovXG4gICAgY29uc3QgZmV0Y2hlclBsdWdpbiA9IFZpZXdQbHVnaW4uZnJvbUNsYXNzKFxuICAgICAgICBjbGFzcyB7XG4gICAgICAgICAgICBwcml2YXRlIGN1cnJlbnRSZXF1ZXN0SWQgPSAwO1xuXG4gICAgICAgICAgICBhc3luYyB1cGRhdGUodXBkYXRlOiBWaWV3VXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSB1cGRhdGUuc3RhdGU7XG4gICAgICAgICAgICAgICAgLy8gT25seSB0cmlnZ2VyIGZldGNoIGlmIHRoZXJlIGlzIG5vIGFjdGl2ZSBzdWdnZXN0aW9uLlxuICAgICAgICAgICAgICAgIGlmICghdXBkYXRlLmRvY0NoYW5nZWQgfHwgc3RhdGUuZmllbGQoc3VnZ2VzdGlvblNlc3Npb25TdGF0ZSkucmVtYWluaW5nVGV4dClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmVxdWVzdElkID0gKyt0aGlzLmN1cnJlbnRSZXF1ZXN0SWQ7XG4gICAgICAgICAgICAgICAgZm9yIGF3YWl0IChjb25zdCBzdWdnZXN0aW9uIG9mIHRocm90dGxlZEZldGNoKHN0YXRlKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgc3RhbGUgcmVxdWVzdHMuXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0SWQgIT09IHRoaXMuY3VycmVudFJlcXVlc3RJZCkgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGUudmlldy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RzOiBTdWdnZXN0aW9uVXBkYXRlRWZmZWN0Lm9mKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBzdWdnZXN0aW9uLnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQ6IHN0YXRlLmRvYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IHN0YXRlLnNlbGVjdGlvbi5tYWluLmhlYWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGZldGNoZXJQbHVnaW4sXG4gICAgICAgIHRlcm1pbmF0ZTogKCkgPT4ge1xuICAgICAgICAgICAgYWN0aXZlUmVxdWVzdCA9IGZhbHNlO1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICAgIH0sXG4gICAgfTtcbn07XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICBVc2VyIEludGVyYWN0aW9uIChBY2NlcHRhbmNlIEhhbmRsZXIpXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8qKlxuICogUmV0dXJucyBhIGtleSBiaW5kaW5nIHRoYXQgYWNjZXB0cyB0aGUgY3VycmVudCBzdWdnZXN0aW9uLlxuICpcbiAqIEBwYXJhbSB0ZXJtaW5hdGVGZXRjaCAtIEZ1bmN0aW9uIHRvIHN0b3AgZnVydGhlciBmZXRjaGluZy5cbiAqIEBwYXJhbSBob3RrZXkgLSBUaGUga2V5IHRoYXQgdHJpZ2dlcnMgYWNjZXB0YW5jZS5cbiAqIEBwYXJhbSBnZXRPcHRpb25zIC0gRnVuY3Rpb24gcmV0dXJuaW5nIGR5bmFtaWMgb3B0aW9ucyAoaW5jbHVkaW5nIHNwbGl0U3RyYXRlZ3kpLlxuICovXG5jb25zdCBjcmVhdGVBY2NlcHRhbmNlSGFuZGxlciA9IChcbiAgICB0ZXJtaW5hdGVGZXRjaDogKCkgPT4gdm9pZCxcbiAgICBob3RrZXk6IHN0cmluZyxcbiAgICBnZXRPcHRpb25zOiAoKSA9PiB7IGRlbGF5TXM/OiBudW1iZXI7IHNwbGl0U3RyYXRlZ3k/OiBTcGxpdFN0cmF0ZWd5IH1cbikgPT5cbiAgICBQcmVjLmhpZ2hlc3QoXG4gICAgICAgIGtleW1hcC5vZihbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAga2V5OiBob3RrZXksXG4gICAgICAgICAgICAgICAgcnVuOiAodmlldzogRWRpdG9yVmlldykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZXNzaW9uID0gdmlldy5zdGF0ZS5maWVsZChzdWdnZXN0aW9uU2Vzc2lvblN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzZXNzaW9uLnJlbWFpbmluZ1RleHQpIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBBbHdheXMgb2J0YWluIHRoZSBjdXJyZW50IHNwbGl0IHN0cmF0ZWd5IGZyb20gZ2V0T3B0aW9ucy5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZHluYW1pY09wdGlvbnMgPSBnZXRPcHRpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlZ21lbnRhdGlvbktleSA9IGR5bmFtaWNPcHRpb25zLnNwbGl0U3RyYXRlZ3kgPz8gJ3dvcmQnO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGFjY2VwdGVkLCByZW1haW5pbmcgfSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBUZXh0U3BsaXRTdHJhdGVnaWVzW3NlZ21lbnRhdGlvbktleV0oc2Vzc2lvbi5yZW1haW5pbmdUZXh0KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIWFjY2VwdGVkKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSW5zZXJ0IHRoZSBhY2NlcHRlZCBzdWdnZXN0aW9uIHRleHQuXG4gICAgICAgICAgICAgICAgICAgIHZpZXcuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uaW5zZXJ0Q29tcGxldGlvbih2aWV3LnN0YXRlLCBhY2NlcHRlZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RzOiBTdWdnZXN0aW9uVXBkYXRlRWZmZWN0Lm9mKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiByZW1haW5pbmcgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudDogcmVtYWluaW5nID8gc2Vzc2lvbi5iYXNlbGluZURvY3VtZW50IDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IHJlbWFpbmluZyA/IHNlc3Npb24uYW5jaG9yUG9zaXRpb24hICsgYWNjZXB0ZWQubGVuZ3RoIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlbWFpbmluZykgdGVybWluYXRlRmV0Y2goKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0pXG4gICAgKTtcblxuLyoqXG4gKiBIZWxwZXIgdG8gY3JlYXRlIGEgdHJhbnNhY3Rpb24gdGhhdCBpbnNlcnRzIGNvbXBsZXRpb24gdGV4dC5cbiAqL1xuY29uc3QgaW5zZXJ0Q29tcGxldGlvbiA9IChzdGF0ZTogRWRpdG9yU3RhdGUsIHRleHQ6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGN1cnNvclBvcyA9IHN0YXRlLnNlbGVjdGlvbi5tYWluLmhlYWQ7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUuY2hhbmdlQnlSYW5nZSgoKSA9PiAoe1xuICAgICAgICAgICAgY2hhbmdlczogeyBmcm9tOiBjdXJzb3JQb3MsIGluc2VydDogdGV4dCB9LFxuICAgICAgICAgICAgcmFuZ2U6IEVkaXRvclNlbGVjdGlvbi5jdXJzb3IoY3Vyc29yUG9zICsgdGV4dC5sZW5ndGgpLFxuICAgICAgICB9KSksXG4gICAgICAgIHVzZXJFdmVudDogJ2NvbXBsZXRpb24uYWNjZXB0JyxcbiAgICB9O1xufTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgIFB1YmxpYyBBUElcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqXG4gKiBUaGUgbWFpbiBleHRlbnNpb24gZnVuY3Rpb24uIEl0IHdpcmVzIHVwIHNlc3Npb24gc3RhdGUgbWFuYWdlbWVudCxcbiAqIHN1Z2dlc3Rpb24gZmV0Y2hpbmcsIHJlbmRlcmluZywgYW5kIHVzZXIgaW50ZXJhY3Rpb24uXG4gKlxuICogTm90aWNlIHRoYXQgdGhlIHN1Z2dlc3Rpb24gbm93IG9ubHkgY29udGFpbnMgdGV4dC5cbiAqIFRoZSBzcGxpdCBzdHJhdGVneSBpcyBhbHdheXMgb2J0YWluZWQgZHluYW1pY2FsbHkgdmlhIGBnZXRPcHRpb25zKClgLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5saW5lU3VnZ2VzdGlvbnMoY29uZmlnOiBJbmxpbmVDb21wbGV0aW9uQ29uZmlnKSB7XG4gICAgY29uc3QgeyBmZXRjaEZ1bmMsIGdldE9wdGlvbnMgfSA9IGNvbmZpZztcbiAgICAvLyBVc2UgdGhlIGhvdGtleSBmcm9tIHRoZSBjb25maWcgaWYgcHJvdmlkZWQ7IG90aGVyd2lzZSwgZGVmYXVsdCB0byBcIlRhYlwiLlxuICAgIGNvbnN0IHN0YXRpY0hvdGtleSA9IGNvbmZpZy5hY2NlcHRhbmNlSG90a2V5IHx8ICdUYWInO1xuXG4gICAgLy8gTm9ybWFsaXplIHRoZSBmZXRjaCBmdW5jdGlvbiB0byBhbHdheXMgcmV0dXJuIGFuIGFzeW5jIGdlbmVyYXRvci5cbiAgICBjb25zdCBub3JtYWxpemVGZXRjaCA9IGFzeW5jIGZ1bmN0aW9uKiAoc3RhdGU6IEVkaXRvclN0YXRlKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZldGNoRnVuYyhzdGF0ZSk7XG4gICAgICAgIGlmIChTeW1ib2wuYXN5bmNJdGVyYXRvciBpbiByZXN1bHQpIHtcbiAgICAgICAgICAgIHlpZWxkKiByZXN1bHQgYXMgQXN5bmNHZW5lcmF0b3I8U3VnZ2VzdGlvbj47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB5aWVsZCByZXN1bHQgYXMgU3VnZ2VzdGlvbjtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBVc2UgZ2V0T3B0aW9ucygpIHRvIG9idGFpbiB0aGUgY3VycmVudCBkZWJvdW5jZSBkZWxheS5cbiAgICBjb25zdCBnZXREZWxheSA9ICgpID0+IGdldE9wdGlvbnMoKS5kZWxheU1zID8/IDMwMDtcbiAgICBjb25zdCB7IGZldGNoZXJQbHVnaW4sIHRlcm1pbmF0ZSB9ID0gY3JlYXRlRGVib3VuY2VkRmV0Y2hlcihub3JtYWxpemVGZXRjaCwgZ2V0RGVsYXkpO1xuICAgIGNvbnN0IGFjY2VwdGFuY2VIYW5kbGVyID0gY3JlYXRlQWNjZXB0YW5jZUhhbmRsZXIodGVybWluYXRlLCBzdGF0aWNIb3RrZXksIGdldE9wdGlvbnMpO1xuXG4gICAgcmV0dXJuIFtcbiAgICAgICAgc3VnZ2VzdGlvblNlc3Npb25TdGF0ZSxcbiAgICAgICAgZmV0Y2hlclBsdWdpbixcbiAgICAgICAgc3VnZ2VzdGlvblJlbmRlcmVyLFxuICAgICAgICBhY2NlcHRhbmNlSGFuZGxlcixcbiAgICBdO1xufVxuIiwgImltcG9ydCB7IFByb3ZpZGVyVHlwZSB9IGZyb20gXCJzcmMvcHJvdmlkZXJzXCI7XG5pbXBvcnQgeyBTcGxpdFN0cmF0ZWd5IH0gZnJvbSBcInNyYy9leHRlbnNpb25cIjtcbmltcG9ydCB7IE9sbGFtYVNldHRpbmdzIH0gZnJvbSBcInNyYy9wcm92aWRlcnMvb2xsYW1hXCI7XG5pbXBvcnQgeyBPcGVuQUlTZXR0aW5ncyB9IGZyb20gXCJzcmMvcHJvdmlkZXJzL29wZW5haVwiO1xuXG4vLyBDb21wbGV0aW9uIG9wdGlvbnMgZm9yIGEgcHJvZmlsZVxuZXhwb3J0IGludGVyZmFjZSBDb21wbGV0aW9uT3B0aW9ucyB7XG4gICAgbW9kZWw6IHN0cmluZyxcbiAgICB1c2VyUHJvbXB0OiBzdHJpbmcsXG4gICAgc3lzdGVtUHJvbXB0OiBzdHJpbmcsXG4gICAgdGVtcGVyYXR1cmU6IG51bWJlclxufVxuXG4vLyBQcm9maWxlIHNldHRpbmdzXG5leHBvcnQgaW50ZXJmYWNlIFByb2ZpbGUge1xuICAgIG5hbWU6IHN0cmluZyxcbiAgICBwcm92aWRlcjogUHJvdmlkZXJUeXBlLFxuICAgIGRlbGF5TXM6IG51bWJlcixcbiAgICBzcGxpdFN0cmF0ZWd5OiBTcGxpdFN0cmF0ZWd5XG4gICAgY29tcGxldGlvbk9wdGlvbnM6IENvbXBsZXRpb25PcHRpb25zLFxufVxuXG5leHBvcnQgdHlwZSBQcm9maWxlTmFtZSA9IHN0cmluZztcbmV4cG9ydCB0eXBlIFByb2ZpbGVzID0gUmVjb3JkPFByb2ZpbGVOYW1lLCBQcm9maWxlPlxuZXhwb3J0IHR5cGUgUGF0aCA9IHN0cmluZztcbmV4cG9ydCB0eXBlIFBhdGhQcm9maWxlID0geyBwcm9maWxlOiBQcm9maWxlTmFtZSwgZW5hYmxlZDogYm9vbGVhbiB9O1xuZXhwb3J0IGludGVyZmFjZSBTZXR0aW5ncyB7XG4gICAgLy8gYXZhaWxhYmxlIHByb3ZpZGVyc1xuICAgIHByb3ZpZGVyczoge1xuICAgICAgICBvbGxhbWE6IE9sbGFtYVNldHRpbmdzLFxuICAgICAgICBvcGVuYWk6IE9wZW5BSVNldHRpbmdzLFxuICAgIH0sXG4gICAgLy8gcHJvZmlsZXNcbiAgICBwcm9maWxlczogUHJvZmlsZXMsXG4gICAgLy8gcGF0aCB0byBwcm9maWxlIG1hcHBpbmdzXG4gICAgcGF0aF9jb25maWdzOiBSZWNvcmQ8UGF0aCwgUGF0aFByb2ZpbGU+LFxufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9QUk9GSUxFOiBQcm9maWxlTmFtZSA9IFwiZGVmYXVsdFwiO1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfUEFUSCA9IFwiL1wiO1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFNldHRpbmdzID0ge1xuICAgIHByb3ZpZGVyczoge1xuICAgICAgICBvcGVuYWk6IHtcbiAgICAgICAgICAgIGludGVncmF0aW9uOiBQcm92aWRlclR5cGUuT1BFTkFJLFxuICAgICAgICAgICAgbmFtZTogXCJPcGVuIEFJXCIsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2UgT3BlbkFJIEFQSXMgdG8gZ2VuZXJhdGUgdGV4dC5cIixcbiAgICAgICAgICAgIGFwaUtleTogXCJcIixcbiAgICAgICAgICAgIG1vZGVsOiBcImdwdC00b1wiLFxuICAgICAgICAgICAgbW9kZWxzOiBbXCJncHQtNFwiLCBcImdwdC0zLjUtdHVyYm9cIiwgXCJncHQtMy41XCIsIFwiZ3B0LTNcIiwgXCJncHQtMlwiLCBcImdwdC0xXCJdLFxuICAgICAgICAgICAgY29uZmlndXJlZDogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIG9sbGFtYToge1xuICAgICAgICAgICAgaW50ZWdyYXRpb246IFByb3ZpZGVyVHlwZS5PTExBTUEsXG4gICAgICAgICAgICBuYW1lOiBcIk9sbGFtYVwiLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlIHlvdXIgb3duIE9sbGFtYSBpbnN0YW5jZSB0byBnZW5lcmF0ZSB0ZXh0LlwiLFxuICAgICAgICAgICAgaG9zdDogXCJodHRwOi8vbG9jYWxob3N0OjExNDM0XCIsXG4gICAgICAgICAgICBtb2RlbHM6IFtcImxsYW1hMy4yOmxhdGVzdFwiLCBcIm1pc3RyYWwtbmVtb1wiXSxcbiAgICAgICAgICAgIGNvbmZpZ3VyZWQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICBwcm9maWxlczoge1xuICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICBuYW1lOiBcIkRlZmF1bHQgUHJvZmlsZVwiLFxuICAgICAgICAgICAgcHJvdmlkZXI6IFByb3ZpZGVyVHlwZS5PTExBTUEsXG4gICAgICAgICAgICBkZWxheU1zOiA1MDAsXG4gICAgICAgICAgICBzcGxpdFN0cmF0ZWd5OiBcIndvcmRcIixcbiAgICAgICAgICAgIGNvbXBsZXRpb25PcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgbW9kZWw6IFwibWlzdHJhbC1uZW1vXCIsXG4gICAgICAgICAgICAgICAgdXNlclByb21wdDogJ0NvbXBsZXRlIGZvbGxvd2luZyB0ZXh0OlxcbiB7e3ByZV9jdXJzb3J9fX0nLFxuICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogXCJZb3UgYXJlIGFuIGhlbHBmdWwgQUkgY29tcGxldGVyLiBGb2xsb3cgaW5zdHJ1Y3Rpb25zXCIsXG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICB9LFxuICAgIHBhdGhfY29uZmlnczoge1xuICAgICAgICBcIi9cIjoge1xuICAgICAgICAgICAgcHJvZmlsZTogREVGQVVMVF9QUk9GSUxFLFxuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICB9LFxufTtcblxuLy8gQ3JlYXRlIGEgbmV3IHByb2ZpbGUgYW5kIHJldHVybiB0aGUgaWRcbmV4cG9ydCBmdW5jdGlvbiBuZXdQcm9maWxlKHNldHRpbmdzOiBTZXR0aW5ncyk6IHN0cmluZyB7XG4gICAgY29uc3QgcHJvZmlsZXMgPSBzZXR0aW5ncy5wcm9maWxlcztcbiAgICBjb25zdCBpZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCA2KTtcblxuICAgIC8vIGdlbmVyYXRlIGEgbmV3IHByb2ZpbGUgbmFtZVxuICAgIGxldCBuYW1lID0gXCJOZXcgUHJvZmlsZVwiO1xuICAgIC8vIGxvb3AgdGhyb3VnaCB0aGUgcHJvZmlsZXMgdG8gbWFrZSBzdXJlIHRoZSBuYW1lIGlzIHVuaXF1ZVxuICAgIGxldCBpID0gMTtcbiAgICBPYmplY3QuZW50cmllcyhwcm9maWxlcykuZm9yRWFjaCgoWywgdmFsdWVdKSA9PiB7XG4gICAgICAgIGlmICh2YWx1ZS5uYW1lID09PSBuYW1lKSB7XG4gICAgICAgICAgICBuYW1lID0gYE5ldyBQcm9maWxlICR7aX1gO1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBjb3B5IHRoZSBkZWZhdWx0IHByb2ZpbGVcbiAgICBjb25zdCBkZWZhdWx0UHJvZmlsZSA9IHByb2ZpbGVzW0RFRkFVTFRfUFJPRklMRV07XG4gICAgY29uc3QgcHJvZmlsZSA9IHtcbiAgICAgICAgLi4uZGVmYXVsdFByb2ZpbGUsXG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgfTtcblxuICAgIC8vIGFkZCB0aGUgbmV3IHByb2ZpbGVcbiAgICBwcm9maWxlc1tpZF0gPSBwcm9maWxlO1xuXG4gICAgcmV0dXJuIGlkO1xufVxuXG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBCdXR0b25Db21wb25lbnQsIEV4dHJhQnV0dG9uQ29tcG9uZW50LCBEcm9wZG93bkNvbXBvbmVudCwgVGV4dENvbXBvbmVudCwgVG9nZ2xlQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBURU1QTEFURV9WQVJJQUJMRVMgfSBmcm9tIFwic3JjL3Byb21wdFwiO1xuaW1wb3J0IHsgU3BsaXRTdHJhdGVneSB9IGZyb20gXCJzcmMvZXh0ZW5zaW9uXCI7XG5pbXBvcnQgSW5zY3JpYmUgZnJvbSBcInNyYy9tYWluXCI7XG5pbXBvcnQgeyBQcm92aWRlclR5cGUgfSBmcm9tIFwic3JjL3Byb3ZpZGVyc1wiO1xuaW1wb3J0IHsgREVGQVVMVF9QUk9GSUxFLCBQcm9maWxlIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcbmltcG9ydCB7IFByb3ZpZGVyU2V0dGluZ3NNb2RhbCB9IGZyb20gJy4vcHJvdmlkZXItc2V0dGluZ3MtbW9kYWwnO1xuaW1wb3J0IHsgbmV3UHJvZmlsZSB9IGZyb20gXCIuXCI7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBNYWluIFNldHRpbmdzIFRhYlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbnNjcmliZVNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcHJpdmF0ZSBwcm92aWRlcnNTZWN0aW9uOiBQcm92aWRlcnNTZWN0aW9uO1xuICAgIHByaXZhdGUgcHJvZmlsZXNTZWN0aW9uOiBQcm9maWxlc1NlY3Rpb247XG4gICAgcHJpdmF0ZSBwYXRoQ29uZmlnc1NlY3Rpb246IFBhdGhDb25maWdzU2VjdGlvbjtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBJbnNjcmliZSkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwLCBwbHVnaW4pO1xuICAgIH1cblxuICAgIGFzeW5jIGRpc3BsYXkoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgICAgICAvLyBQcm92aWRlcnMgU2VjdGlvblxuICAgICAgICBjb25zdCBwcm92aWRlcnNDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFwcGVuZENoaWxkKHByb3ZpZGVyc0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMucHJvdmlkZXJzU2VjdGlvbiA9IG5ldyBQcm92aWRlcnNTZWN0aW9uKHByb3ZpZGVyc0NvbnRhaW5lciwgdGhpcy5hcHAsIHRoaXMucGx1Z2luKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wcm92aWRlcnNTZWN0aW9uLnJlbmRlcigpO1xuXG4gICAgICAgIC8vIFByb2ZpbGVzIFNlY3Rpb25cbiAgICAgICAgY29uc3QgcHJvZmlsZXNDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFwcGVuZENoaWxkKHByb2ZpbGVzQ29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5wcm9maWxlc1NlY3Rpb24gPSBuZXcgUHJvZmlsZXNTZWN0aW9uKHByb2ZpbGVzQ29udGFpbmVyLCB0aGlzLnBsdWdpbik7XG4gICAgICAgIGF3YWl0IHRoaXMucHJvZmlsZXNTZWN0aW9uLnJlbmRlcigpO1xuXG4gICAgICAgIC8vIFBhdGggTWFwcGluZ3MgU2VjdGlvblxuICAgICAgICBjb25zdCBwYXRoTWFwcGluZ3NDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFwcGVuZENoaWxkKHBhdGhNYXBwaW5nc0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMucGF0aENvbmZpZ3NTZWN0aW9uID0gbmV3IFBhdGhDb25maWdzU2VjdGlvbihwYXRoTWFwcGluZ3NDb250YWluZXIsIHRoaXMucGx1Z2luKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wYXRoQ29uZmlnc1NlY3Rpb24ucmVuZGVyKCk7XG4gICAgfVxufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUHJvdmlkZXJzIFNlY3Rpb25cbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY2xhc3MgUHJvdmlkZXJzU2VjdGlvbiB7XG4gICAgcHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgcGx1Z2luOiBJbnNjcmliZTtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuXG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgYXBwOiBBcHAsIHBsdWdpbjogSW5zY3JpYmUpIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmVtcHR5KCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBcIlByb3ZpZGVyc1wiIH0pO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgICAgdGV4dDogXCJDb25maWd1cmUgdGhlIEFJIHByb3ZpZGVycyB5b3Ugd2FudCB0byB1c2UgZm9yIGNvbXBsZXRpb25zXCJcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gT2xsYW1hIFByb3ZpZGVyXG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJPbGxhbWFcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiTG9jYWwgQUkgcHJvdmlkZXIgcnVubmluZyBvbiB5b3VyIG1hY2hpbmVcIilcbiAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiQ29uZmlndXJlXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQ29uZmlndXJlIE9sbGFtYVwiKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB0aGlzLm9wZW5Qcm92aWRlck1vZGFsKFByb3ZpZGVyVHlwZS5PTExBTUEpKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIE9wZW5BSSBQcm92aWRlclxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiT3BlbkFJXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIk9wZW5BSSBBUEkgcHJvdmlkZXJcIilcbiAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiQ29uZmlndXJlXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQ29uZmlndXJlIE9wZW5BSVwiKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB0aGlzLm9wZW5Qcm92aWRlck1vZGFsKFByb3ZpZGVyVHlwZS5PUEVOQUkpKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgb3BlblByb3ZpZGVyTW9kYWwodHlwZTogUHJvdmlkZXJUeXBlKTogdm9pZCB7XG4gICAgICAgIG5ldyBQcm92aWRlclNldHRpbmdzTW9kYWwodGhpcy5hcHAsIHRoaXMucGx1Z2luLCB0eXBlKS5vcGVuKCk7XG4gICAgfVxufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUHJvZmlsZXMgU2VjdGlvblxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5jbGFzcyBQcm9maWxlc1NlY3Rpb24ge1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHBsdWdpbjogSW5zY3JpYmU7XG4gICAgcHJpdmF0ZSBkaXNwbGF5ZWRQcm9maWxlSWQ6IHN0cmluZyA9IERFRkFVTFRfUFJPRklMRTtcbiAgICBwcml2YXRlIHNlbGVjdGlvbkNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBwcm9maWxlQ29udGFpbmVyOiBIVE1MRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHBsdWdpbjogSW5zY3JpYmUpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgY29udGFpbmVycyBvbmNlXG4gICAgICAgIHRoaXMuc2VsZWN0aW9uQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgdGhpcy5wcm9maWxlQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuICAgICAgICAvLyBBcHBlbmQgdGhlbSBpbml0aWFsbHlcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5zZWxlY3Rpb25Db250YWluZXIpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnByb2ZpbGVDb250YWluZXIpO1xuICAgIH1cblxuICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gQ2xlYXIgbWFpbiBjb250YWluZXIgYW5kIHJlLWFwcGVuZCBzdWItY29udGFpbmVyc1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5lbXB0eSgpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogXCJQcm9maWxlc1wiIH0pO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgICAgdGV4dDogXCJDb25maWd1cmUgdGhlIHNldHRpbmdzIGZvciBlYWNoIHByb2ZpbGUuIEEgcHJvZmlsZSBjYW4gYmUgYXNzaWduZWQgdG8gcGF0aHMuIFRoZSBkZWZhdWx0IHByb2ZpbGUgaXMgdXNlZCB3aGVuIG5vIHByb2ZpbGUgaXMgYXNzaWduZWQuXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuc2VsZWN0aW9uQ29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5wcm9maWxlQ29udGFpbmVyKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnJlbmRlclByb2ZpbGVTZWxlY3Rpb24oKTtcblxuICAgICAgICBjb25zdCBkaXNwbGF5ZWRQcm9maWxlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvZmlsZXNbdGhpcy5kaXNwbGF5ZWRQcm9maWxlSWRdO1xuICAgICAgICBhd2FpdCB0aGlzLnJlbmRlclByb2ZpbGVTZXR0aW5ncyhkaXNwbGF5ZWRQcm9maWxlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHJlbmRlclByb2ZpbGVTZWxlY3Rpb24oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uQ29udGFpbmVyLmVtcHR5KCk7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnJcIik7XG5cbiAgICAgICAgbmV3IFNldHRpbmcodGhpcy5zZWxlY3Rpb25Db250YWluZXIpXG4gICAgICAgICAgICAuc2V0SGVhZGluZygpXG4gICAgICAgICAgICAuc2V0TmFtZShcIk1hbmFnZSBwcm9maWxlXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlNlbGVjdCBhIHByb2ZpbGUgdG8gY29uZmlndXJlIGl0cyBzZXR0aW5nc1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChkcm9wZG93bjogRHJvcGRvd25Db21wb25lbnQpID0+IHRoaXMuY3JlYXRlUHJvZmlsZURyb3Bkb3duKGRyb3Bkb3duKSlcbiAgICAgICAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnV0dG9uOiBFeHRyYUJ1dHRvbkNvbXBvbmVudCkgPT4gdGhpcy5jcmVhdGVOZXdQcm9maWxlQnV0dG9uKGJ1dHRvbikpXG4gICAgICAgICAgICAuYWRkRXh0cmFCdXR0b24oKGJ1dHRvbjogRXh0cmFCdXR0b25Db21wb25lbnQpID0+IHRoaXMuY3JlYXRlRGVsZXRlUHJvZmlsZUJ1dHRvbihidXR0b24pKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVByb2ZpbGVEcm9wZG93bihkcm9wZG93bjogRHJvcGRvd25Db21wb25lbnQpOiB2b2lkIHtcbiAgICAgICAgT2JqZWN0LmVudHJpZXModGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMpLmZvckVhY2goKFtpZCwgcHJvZmlsZV0pID0+IHtcbiAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihpZCwgcHJvZmlsZS5uYW1lKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRyb3Bkb3duXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5kaXNwbGF5ZWRQcm9maWxlSWQpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5ZWRQcm9maWxlSWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlclByb2ZpbGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9maWxlc1t2YWx1ZV0pO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVOZXdQcm9maWxlQnV0dG9uKGJ1dHRvbjogRXh0cmFCdXR0b25Db21wb25lbnQpOiB2b2lkIHtcbiAgICAgICAgYnV0dG9uXG4gICAgICAgICAgICAuc2V0SWNvbihcInBsdXNcIilcbiAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQ3JlYXRlIG5ldyBwcm9maWxlXCIpXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5ZWRQcm9maWxlSWQgPSBuZXdQcm9maWxlKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVEZWxldGVQcm9maWxlQnV0dG9uKGJ1dHRvbjogRXh0cmFCdXR0b25Db21wb25lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaXNEZWZhdWx0ID0gdGhpcy5kaXNwbGF5ZWRQcm9maWxlSWQgPT09IERFRkFVTFRfUFJPRklMRTtcbiAgICAgICAgYnV0dG9uXG4gICAgICAgICAgICAuc2V0RGlzYWJsZWQoaXNEZWZhdWx0KVxuICAgICAgICAgICAgLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICAgICAgLnNldFRvb2x0aXAoaXNEZWZhdWx0ID8gXCJDYW5ub3QgZGVsZXRlIGRlZmF1bHQgcHJvZmlsZVwiIDogXCJEZWxldGUgcHJvZmlsZVwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9maWxlc1t0aGlzLmRpc3BsYXllZFByb2ZpbGVJZF07XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5ZWRQcm9maWxlSWQgPSBERUZBVUxUX1BST0ZJTEU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgcmVuZGVyUHJvZmlsZVNldHRpbmdzKHByb2ZpbGU6IFByb2ZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5wcm9maWxlQ29udGFpbmVyLmVtcHR5KCk7XG5cbiAgICAgICAgLy8gUHJvZmlsZSBOYW1lXG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMucHJvZmlsZUNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiUHJvZmlsZSBOYW1lXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIk5hbWUgb2YgdGhlIHByb2ZpbGVcIilcbiAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGV4dC5zZXRWYWx1ZShwcm9maWxlLm5hbWUpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBwcm9maWxlLm5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBQcm92aWRlciBTZWxlY3Rpb25cbiAgICAgICAgbmV3IFNldHRpbmcodGhpcy5wcm9maWxlQ29udGFpbmVyKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBSSBQcm92aWRlclwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJDaG9vc2UgeW91ciBwcmVmZXJyZWQgQUkgcHJvdmlkZXJcIilcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcbiAgICAgICAgICAgICAgICBkcm9wZG93blxuICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKFByb3ZpZGVyVHlwZS5PTExBTUEsIFwiT2xsYW1hXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oUHJvdmlkZXJUeXBlLk9QRU5BSSwgXCJPcGVuQUlcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHByb2ZpbGUucHJvdmlkZXIpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWU6IFByb3ZpZGVyVHlwZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZmlsZS5wcm92aWRlciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gTW9kZWwgU2VsZWN0aW9uXG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMucHJvZmlsZUNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTW9kZWxcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiU2VsZWN0IHRoZSBtb2RlbCB0byB1c2UgZm9yIGNvbXBsZXRpb25zXCIpXG4gICAgICAgICAgICAuYWRkRXh0cmFCdXR0b24oKGJ1dHRvbikgPT4ge1xuICAgICAgICAgICAgICAgIGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcInJlZnJlc2gtY2N3XCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiVXBkYXRlIG1vZGVsIGxpc3RcIilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4ucHJvdmlkZXJGYWN0b3J5LnVwZGF0ZU1vZGVscyhwcm9maWxlLnByb3ZpZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJQcm9maWxlU2V0dGluZ3MocHJvZmlsZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hZGREcm9wZG93bihhc3luYyAoZHJvcGRvd24pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBtb2RlbHMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlcnNbcHJvZmlsZS5wcm92aWRlcl0ubW9kZWxzO1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb25zKE9iamVjdC5mcm9tRW50cmllcyhtb2RlbHMubWFwKChtb2RlbCkgPT4gW21vZGVsLCBtb2RlbF0pKSlcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHByb2ZpbGUuY29tcGxldGlvbk9wdGlvbnMubW9kZWwpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGUuY29tcGxldGlvbk9wdGlvbnMubW9kZWwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVGVtcGVyYXR1cmUgU2V0dGluZ1xuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLnByb2ZpbGVDb250YWluZXIpXG4gICAgICAgICAgICAuc2V0TmFtZShcIlRlbXBlcmF0dXJlXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIkNvbnRyb2wgdGhlIHJhbmRvbW5lc3Mgb2YgY29tcGxldGlvbnMgKDAgPSBkZXRlcm1pbmlzdGljLCAxID0gY3JlYXRpdmUpXCIpXG4gICAgICAgICAgICAuYWRkU2xpZGVyKChzbGlkZXIpID0+IHtcbiAgICAgICAgICAgICAgICBzbGlkZXJcbiAgICAgICAgICAgICAgICAgICAgLnNldExpbWl0cygwLCAxLCAwLjEpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShwcm9maWxlLmNvbXBsZXRpb25PcHRpb25zLnRlbXBlcmF0dXJlKVxuICAgICAgICAgICAgICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9maWxlLmNvbXBsZXRpb25PcHRpb25zLnRlbXBlcmF0dXJlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBTdWdnZXN0aW9uIERlbGF5XG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMucHJvZmlsZUNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiU3VnZ2VzdGlvbiBEZWxheVwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJEZWxheSBpbiBtaWxsaXNlY29uZHMgYmVmb3JlIGZldGNoaW5nIHN1Z2dlc3Rpb25zXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4ge1xuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5zZXRBdHRyKFwidHlwZVwiLCBcIm51bWJlclwiKTtcbiAgICAgICAgICAgICAgICB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIjEwMDBcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKFN0cmluZyhwcm9maWxlLmRlbGF5TXMpKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9maWxlLmRlbGF5TXMgPSBwYXJzZUludCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBTcGxpdCBTdHJhdGVneVxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLnByb2ZpbGVDb250YWluZXIpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkNvbXBsZXRpb24gU3RyYXRlZ3lcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiQ2hvb3NlIGhvdyBjb21wbGV0aW9ucyBzaG91bGQgYmUgc3BsaXQgYW5kIGFjY2VwdGVkXCIpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XG4gICAgICAgICAgICAgICAgZHJvcGRvd25cbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbihcIndvcmRcIiwgXCJXb3JkIGJ5IFdvcmRcIilcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbihcInNlbnRlbmNlXCIsIFwiU2VudGVuY2UgYnkgU2VudGVuY2VcIilcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbihcInBhcmFncmFwaFwiLCBcIlBhcmFncmFwaCBieSBQYXJhZ3JhcGhcIilcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbihcImZ1bGxcIiwgXCJGdWxsIENvbXBsZXRpb25cIilcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHByb2ZpbGUuc3BsaXRTdHJhdGVneSlcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogU3BsaXRTdHJhdGVneSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZmlsZS5zcGxpdFN0cmF0ZWd5ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBTeXN0ZW0gUHJvbXB0XG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMucHJvZmlsZUNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiU3lzdGVtIFByb21wdFwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJTZXQgc3lzdGVtIHByb21wdFwiKVxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLnJvd3MgPSAzO1xuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5zZXRDc3NTdHlsZXMoe1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCIxMDAlXCIsXG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogXCJ2ZXJ0aWNhbFwiLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJyZWxhdGl2ZVwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGV4dC5zZXRWYWx1ZShwcm9maWxlLmNvbXBsZXRpb25PcHRpb25zLnN5c3RlbVByb21wdCkub25DaGFuZ2UoXG4gICAgICAgICAgICAgICAgICAgIGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZmlsZS5jb21wbGV0aW9uT3B0aW9ucy5zeXN0ZW1Qcm9tcHQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFVzZXIgUHJvbXB0XG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMucHJvZmlsZUNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiVXNlciBQcm9tcHRcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVXNlciBwcm9tcHQgdGVtcGxhdGVcIilcbiAgICAgICAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnV0dG9uKSA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwibGlzdFwiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkluc2VydCBtdXN0YWNoZSB0ZW1wbGF0ZSB2YXJpYWJsZXNcIilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZmlsZS5jb21wbGV0aW9uT3B0aW9ucy51c2VyUHJvbXB0ICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcblwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBURU1QTEFURV9WQVJJQUJMRVM7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9maWxlLmNvbXBsZXRpb25PcHRpb25zLnVzZXJQcm9tcHQgPSB0ZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlclByb2ZpbGVTZXR0aW5ncyhwcm9maWxlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLnJvd3MgPSAzO1xuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5zZXRDc3NTdHlsZXMoe1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCIxMDAlXCIsXG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogXCJ2ZXJ0aWNhbFwiLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJyZWxhdGl2ZVwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGV4dC5zZXRWYWx1ZShwcm9maWxlLmNvbXBsZXRpb25PcHRpb25zLnVzZXJQcm9tcHQpLm9uQ2hhbmdlKFxuICAgICAgICAgICAgICAgICAgICBhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGUuY29tcGxldGlvbk9wdGlvbnMudXNlclByb21wdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGF0aCBDb25maWdzIFNlY3Rpb25cbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY2xhc3MgUGF0aENvbmZpZ3NTZWN0aW9uIHtcbiAgICBwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBwbHVnaW46IEluc2NyaWJlO1xuICAgIHByaXZhdGUgdGFibGVDb250YWluZXI6IEhUTUxFbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcGx1Z2luOiBJbnNjcmliZSkge1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMudGFibGVDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIH1cblxuICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5jb250YWluZXIuZW1wdHkoKTtcbiAgICAgICAgdGhpcy5jb250YWluZXIuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiUGF0aCBQcm9maWxlc1wiIH0pO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgICAgdGV4dDogXCJZb3UgY2FuIGFzc2lnbiBwcm9maWxlcyB0byBwYXRocy4gUGF0aHMgYXJlIG1hdGNoZWQgYnkgcHJlZml4LCB3aXRoIGxvbmdlciBwYXRocyB0YWtpbmcgcHJlY2VkZW5jZS4gRm9yIGV4YW1wbGUsICcvRGFpbHknIHdpbGwgbWF0Y2ggYWxsIGZpbGVzIGluIHRoZSBEYWlseSBmb2xkZXIuXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmNyZWF0ZUVsKFwiYnJcIik7XG5cbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy50YWJsZUNvbnRhaW5lcik7XG4gICAgICAgIGF3YWl0IHRoaXMucmVuZGVyTWFwcGluZ3NUYWJsZSgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgcmVuZGVyTWFwcGluZ3NUYWJsZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy50YWJsZUNvbnRhaW5lci5lbXB0eSgpO1xuXG4gICAgICAgIGNvbnN0IHRhYmxlID0gdGhpcy50YWJsZUNvbnRhaW5lci5jcmVhdGVFbChcInRhYmxlXCIsIHsgY2xzOiBcIm1hcHBpbmctdGFibGVcIiB9KTtcbiAgICAgICAgY29uc3QgaGVhZGVyID0gdGFibGUuY3JlYXRlRWwoXCJ0clwiKTtcbiAgICAgICAgaGVhZGVyLmNyZWF0ZUVsKFwidGhcIiwgeyB0ZXh0OiBcIlBhdGhcIiB9KTtcbiAgICAgICAgaGVhZGVyLmNyZWF0ZUVsKFwidGhcIiwgeyB0ZXh0OiBcIlByb2ZpbGVcIiB9KTtcbiAgICAgICAgaGVhZGVyLmNyZWF0ZUVsKFwidGhcIiwgeyB0ZXh0OiBcIlwiIH0pO1xuICAgICAgICBoZWFkZXIuY3JlYXRlRWwoXCJ0aFwiLCB7IHRleHQ6IFwiXCIgfSk7XG5cbiAgICAgICAgLy8gQWRkIE5ldyBNYXBwaW5nIFJvd1xuICAgICAgICBjb25zdCBuZXdSb3cgPSB0YWJsZS5jcmVhdGVFbChcInRyXCIsIHsgY2xzOiBcIm5ldy1tYXBwaW5nLXJvd1wiIH0pO1xuICAgICAgICBsZXQgcGF0aElucHV0ID0gXCJcIjtcbiAgICAgICAgbGV0IHNlbGVjdGVkUHJvZmlsZSA9IERFRkFVTFRfUFJPRklMRTtcblxuICAgICAgICAvLyBQYXRoIGlucHV0IGNlbGxcbiAgICAgICAgY29uc3QgcGF0aENlbGwgPSBuZXdSb3cuY3JlYXRlRWwoXCJ0ZFwiKTtcblxuICAgICAgICBuZXcgVGV4dENvbXBvbmVudChwYXRoQ2VsbClcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIHBhdGggKGUuZy4sIERhaWx5L1dvcmspXCIpXG4gICAgICAgICAgICAub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgcGF0aElucHV0ID0gdmFsdWU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBQcm9maWxlIGRyb3Bkb3duIGNlbGxcbiAgICAgICAgY29uc3QgcHJvZmlsZUNlbGwgPSBuZXdSb3cuY3JlYXRlRWwoXCJ0ZFwiKTtcbiAgICAgICAgY29uc3QgcHJvZmlsZURyb3Bkb3duID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHByb2ZpbGVDZWxsKVxuICAgICAgICAgICAgLnNldFZhbHVlKHNlbGVjdGVkUHJvZmlsZSk7XG5cbiAgICAgICAgT2JqZWN0LmVudHJpZXModGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMpLmZvckVhY2goKFtpZCwgcHJvZmlsZV0pID0+IHtcbiAgICAgICAgICAgIHByb2ZpbGVEcm9wZG93bi5hZGRPcHRpb24oaWQsIHByb2ZpbGUubmFtZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHByb2ZpbGVEcm9wZG93bi5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHNlbGVjdGVkUHJvZmlsZSA9IHZhbHVlO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBZGQgYnV0dG9uIGNlbGxcbiAgICAgICAgbmV3Um93LmNyZWF0ZUVsKFwidGRcIik7XG4gICAgICAgIGNvbnN0IGFjdGlvbkNlbGwgPSBuZXdSb3cuY3JlYXRlRWwoXCJ0ZFwiKTtcbiAgICAgICAgbmV3IEV4dHJhQnV0dG9uQ29tcG9uZW50KGFjdGlvbkNlbGwpXG4gICAgICAgICAgICAuc2V0SWNvbihcInBsdXNcIilcbiAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQWRkIHByb2ZpbGUgbWFwcGluZ1wiKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnBhdGhfY29uZmlnc1twYXRoSW5wdXRdID0ge1xuICAgICAgICAgICAgICAgICAgICBwcm9maWxlOiBzZWxlY3RlZFByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRXhpc3RpbmcgTWFwcGluZ3NcbiAgICAgICAgT2JqZWN0LmVudHJpZXModGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0aF9jb25maWdzKS5mb3JFYWNoKChbcGF0aCwgbWFwcGluZ10pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IHRhYmxlLmNyZWF0ZUVsKFwidHJcIik7XG4gICAgICAgICAgICByb3cuY3JlYXRlRWwoXCJ0ZFwiLCB7IHRleHQ6IHBhdGggfHwgXCJSb290XCIgfSk7XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBwcm9maWxlIGNlbGwgd2l0aCBkcm9wZG93blxuICAgICAgICAgICAgY29uc3QgaXNEZWZhdWx0TWFwcGluZyA9IHBhdGggPT09IFwiXCI7XG4gICAgICAgICAgICBjb25zdCBwcm9maWxlQ2VsbCA9IHJvdy5jcmVhdGVFbChcInRkXCIpO1xuXG4gICAgICAgICAgICAvLyBGb3Igb3RoZXIgbWFwcGluZ3MsIHNob3cgZWRpdGFibGUgZHJvcGRvd25cbiAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVEcm9wZG93biA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChwcm9maWxlQ2VsbClcbiAgICAgICAgICAgICAgICAuc2V0RGlzYWJsZWQoaXNEZWZhdWx0TWFwcGluZyk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBwcm9maWxlIG9wdGlvbnNcbiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb2ZpbGVzKS5mb3JFYWNoKChbaWQsIHByb2ZpbGVdKSA9PiB7XG4gICAgICAgICAgICAgICAgcHJvZmlsZURyb3Bkb3duLmFkZE9wdGlvbihpZCwgcHJvZmlsZS5uYW1lKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBwcm9maWxlRHJvcGRvd24uc2V0VmFsdWUobWFwcGluZy5wcm9maWxlKTtcblxuICAgICAgICAgICAgLy8gSGFuZGxlIHByb2ZpbGUgY2hhbmdlXG4gICAgICAgICAgICBwcm9maWxlRHJvcGRvd24ub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0aF9jb25maWdzW3BhdGhdID0ge1xuICAgICAgICAgICAgICAgICAgICBwcm9maWxlOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogbWFwcGluZy5lbmFibGVkLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgZGVsZXRlQ2VsbCA9IHJvdy5jcmVhdGVFbChcInRkXCIpO1xuICAgICAgICAgICAgbmV3IEV4dHJhQnV0dG9uQ29tcG9uZW50KGRlbGV0ZUNlbGwpXG4gICAgICAgICAgICAgICAgLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICAgICAgICAgIC5zZXREaXNhYmxlZChpc0RlZmF1bHRNYXBwaW5nKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiRGVsZXRlIG1hcHBpbmdcIilcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXRoX2NvbmZpZ3NbcGF0aF07XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBBZGQgZW5hYmxlZCBjaGVja2JveCBjZWxsXG4gICAgICAgICAgICBjb25zdCBlbmFibGVkQ2VsbCA9IHJvdy5jcmVhdGVFbChcInRkXCIpO1xuICAgICAgICAgICAgbmV3IFRvZ2dsZUNvbXBvbmVudChlbmFibGVkQ2VsbClcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkVuYWJsZS9kaXNhYmxlIG1hcHBpbmdcIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUobWFwcGluZy5lbmFibGVkKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0aF9jb25maWdzW3BhdGhdLmVuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiIsICIvKiFcbiAqIG11c3RhY2hlLmpzIC0gTG9naWMtbGVzcyB7e211c3RhY2hlfX0gdGVtcGxhdGVzIHdpdGggSmF2YVNjcmlwdFxuICogaHR0cDovL2dpdGh1Yi5jb20vamFubC9tdXN0YWNoZS5qc1xuICovXG5cbnZhciBvYmplY3RUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG52YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gaXNBcnJheVBvbHlmaWxsIChvYmplY3QpIHtcbiAgcmV0dXJuIG9iamVjdFRvU3RyaW5nLmNhbGwob2JqZWN0KSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24gKG9iamVjdCkge1xuICByZXR1cm4gdHlwZW9mIG9iamVjdCA9PT0gJ2Z1bmN0aW9uJztcbn1cblxuLyoqXG4gKiBNb3JlIGNvcnJlY3QgdHlwZW9mIHN0cmluZyBoYW5kbGluZyBhcnJheVxuICogd2hpY2ggbm9ybWFsbHkgcmV0dXJucyB0eXBlb2YgJ29iamVjdCdcbiAqL1xuZnVuY3Rpb24gdHlwZVN0ciAob2JqKSB7XG4gIHJldHVybiBpc0FycmF5KG9iaikgPyAnYXJyYXknIDogdHlwZW9mIG9iajtcbn1cblxuZnVuY3Rpb24gZXNjYXBlUmVnRXhwIChzdHJpbmcpIHtcbiAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9bXFwtXFxbXFxde30oKSorPy4sXFxcXFxcXiR8I1xcc10vZywgJ1xcXFwkJicpO1xufVxuXG4vKipcbiAqIE51bGwgc2FmZSB3YXkgb2YgY2hlY2tpbmcgd2hldGhlciBvciBub3QgYW4gb2JqZWN0LFxuICogaW5jbHVkaW5nIGl0cyBwcm90b3R5cGUsIGhhcyBhIGdpdmVuIHByb3BlcnR5XG4gKi9cbmZ1bmN0aW9uIGhhc1Byb3BlcnR5IChvYmosIHByb3BOYW1lKSB7XG4gIHJldHVybiBvYmogIT0gbnVsbCAmJiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiAocHJvcE5hbWUgaW4gb2JqKTtcbn1cblxuLyoqXG4gKiBTYWZlIHdheSBvZiBkZXRlY3Rpbmcgd2hldGhlciBvciBub3QgdGhlIGdpdmVuIHRoaW5nIGlzIGEgcHJpbWl0aXZlIGFuZFxuICogd2hldGhlciBpdCBoYXMgdGhlIGdpdmVuIHByb3BlcnR5XG4gKi9cbmZ1bmN0aW9uIHByaW1pdGl2ZUhhc093blByb3BlcnR5IChwcmltaXRpdmUsIHByb3BOYW1lKSB7XG4gIHJldHVybiAoXG4gICAgcHJpbWl0aXZlICE9IG51bGxcbiAgICAmJiB0eXBlb2YgcHJpbWl0aXZlICE9PSAnb2JqZWN0J1xuICAgICYmIHByaW1pdGl2ZS5oYXNPd25Qcm9wZXJ0eVxuICAgICYmIHByaW1pdGl2ZS5oYXNPd25Qcm9wZXJ0eShwcm9wTmFtZSlcbiAgKTtcbn1cblxuLy8gV29ya2Fyb3VuZCBmb3IgaHR0cHM6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL2Jyb3dzZS9DT1VDSERCLTU3N1xuLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qYW5sL211c3RhY2hlLmpzL2lzc3Vlcy8xODlcbnZhciByZWdFeHBUZXN0ID0gUmVnRXhwLnByb3RvdHlwZS50ZXN0O1xuZnVuY3Rpb24gdGVzdFJlZ0V4cCAocmUsIHN0cmluZykge1xuICByZXR1cm4gcmVnRXhwVGVzdC5jYWxsKHJlLCBzdHJpbmcpO1xufVxuXG52YXIgbm9uU3BhY2VSZSA9IC9cXFMvO1xuZnVuY3Rpb24gaXNXaGl0ZXNwYWNlIChzdHJpbmcpIHtcbiAgcmV0dXJuICF0ZXN0UmVnRXhwKG5vblNwYWNlUmUsIHN0cmluZyk7XG59XG5cbnZhciBlbnRpdHlNYXAgPSB7XG4gICcmJzogJyZhbXA7JyxcbiAgJzwnOiAnJmx0OycsXG4gICc+JzogJyZndDsnLFxuICAnXCInOiAnJnF1b3Q7JyxcbiAgXCInXCI6ICcmIzM5OycsXG4gICcvJzogJyYjeDJGOycsXG4gICdgJzogJyYjeDYwOycsXG4gICc9JzogJyYjeDNEOydcbn07XG5cbmZ1bmN0aW9uIGVzY2FwZUh0bWwgKHN0cmluZykge1xuICByZXR1cm4gU3RyaW5nKHN0cmluZykucmVwbGFjZSgvWyY8PlwiJ2A9XFwvXS9nLCBmdW5jdGlvbiBmcm9tRW50aXR5TWFwIChzKSB7XG4gICAgcmV0dXJuIGVudGl0eU1hcFtzXTtcbiAgfSk7XG59XG5cbnZhciB3aGl0ZVJlID0gL1xccyovO1xudmFyIHNwYWNlUmUgPSAvXFxzKy87XG52YXIgZXF1YWxzUmUgPSAvXFxzKj0vO1xudmFyIGN1cmx5UmUgPSAvXFxzKlxcfS87XG52YXIgdGFnUmUgPSAvI3xcXF58XFwvfD58XFx7fCZ8PXwhLztcblxuLyoqXG4gKiBCcmVha3MgdXAgdGhlIGdpdmVuIGB0ZW1wbGF0ZWAgc3RyaW5nIGludG8gYSB0cmVlIG9mIHRva2Vucy4gSWYgdGhlIGB0YWdzYFxuICogYXJndW1lbnQgaXMgZ2l2ZW4gaGVyZSBpdCBtdXN0IGJlIGFuIGFycmF5IHdpdGggdHdvIHN0cmluZyB2YWx1ZXM6IHRoZVxuICogb3BlbmluZyBhbmQgY2xvc2luZyB0YWdzIHVzZWQgaW4gdGhlIHRlbXBsYXRlIChlLmcuIFsgXCI8JVwiLCBcIiU+XCIgXSkuIE9mXG4gKiBjb3Vyc2UsIHRoZSBkZWZhdWx0IGlzIHRvIHVzZSBtdXN0YWNoZXMgKGkuZS4gbXVzdGFjaGUudGFncykuXG4gKlxuICogQSB0b2tlbiBpcyBhbiBhcnJheSB3aXRoIGF0IGxlYXN0IDQgZWxlbWVudHMuIFRoZSBmaXJzdCBlbGVtZW50IGlzIHRoZVxuICogbXVzdGFjaGUgc3ltYm9sIHRoYXQgd2FzIHVzZWQgaW5zaWRlIHRoZSB0YWcsIGUuZy4gXCIjXCIgb3IgXCImXCIuIElmIHRoZSB0YWdcbiAqIGRpZCBub3QgY29udGFpbiBhIHN5bWJvbCAoaS5lLiB7e215VmFsdWV9fSkgdGhpcyBlbGVtZW50IGlzIFwibmFtZVwiLiBGb3JcbiAqIGFsbCB0ZXh0IHRoYXQgYXBwZWFycyBvdXRzaWRlIGEgc3ltYm9sIHRoaXMgZWxlbWVudCBpcyBcInRleHRcIi5cbiAqXG4gKiBUaGUgc2Vjb25kIGVsZW1lbnQgb2YgYSB0b2tlbiBpcyBpdHMgXCJ2YWx1ZVwiLiBGb3IgbXVzdGFjaGUgdGFncyB0aGlzIGlzXG4gKiB3aGF0ZXZlciBlbHNlIHdhcyBpbnNpZGUgdGhlIHRhZyBiZXNpZGVzIHRoZSBvcGVuaW5nIHN5bWJvbC4gRm9yIHRleHQgdG9rZW5zXG4gKiB0aGlzIGlzIHRoZSB0ZXh0IGl0c2VsZi5cbiAqXG4gKiBUaGUgdGhpcmQgYW5kIGZvdXJ0aCBlbGVtZW50cyBvZiB0aGUgdG9rZW4gYXJlIHRoZSBzdGFydCBhbmQgZW5kIGluZGljZXMsXG4gKiByZXNwZWN0aXZlbHksIG9mIHRoZSB0b2tlbiBpbiB0aGUgb3JpZ2luYWwgdGVtcGxhdGUuXG4gKlxuICogVG9rZW5zIHRoYXQgYXJlIHRoZSByb290IG5vZGUgb2YgYSBzdWJ0cmVlIGNvbnRhaW4gdHdvIG1vcmUgZWxlbWVudHM6IDEpIGFuXG4gKiBhcnJheSBvZiB0b2tlbnMgaW4gdGhlIHN1YnRyZWUgYW5kIDIpIHRoZSBpbmRleCBpbiB0aGUgb3JpZ2luYWwgdGVtcGxhdGUgYXRcbiAqIHdoaWNoIHRoZSBjbG9zaW5nIHRhZyBmb3IgdGhhdCBzZWN0aW9uIGJlZ2lucy5cbiAqXG4gKiBUb2tlbnMgZm9yIHBhcnRpYWxzIGFsc28gY29udGFpbiB0d28gbW9yZSBlbGVtZW50czogMSkgYSBzdHJpbmcgdmFsdWUgb2ZcbiAqIGluZGVuZGF0aW9uIHByaW9yIHRvIHRoYXQgdGFnIGFuZCAyKSB0aGUgaW5kZXggb2YgdGhhdCB0YWcgb24gdGhhdCBsaW5lIC1cbiAqIGVnIGEgdmFsdWUgb2YgMiBpbmRpY2F0ZXMgdGhlIHBhcnRpYWwgaXMgdGhlIHRoaXJkIHRhZyBvbiB0aGlzIGxpbmUuXG4gKi9cbmZ1bmN0aW9uIHBhcnNlVGVtcGxhdGUgKHRlbXBsYXRlLCB0YWdzKSB7XG4gIGlmICghdGVtcGxhdGUpXG4gICAgcmV0dXJuIFtdO1xuICB2YXIgbGluZUhhc05vblNwYWNlID0gZmFsc2U7XG4gIHZhciBzZWN0aW9ucyA9IFtdOyAgICAgLy8gU3RhY2sgdG8gaG9sZCBzZWN0aW9uIHRva2Vuc1xuICB2YXIgdG9rZW5zID0gW107ICAgICAgIC8vIEJ1ZmZlciB0byBob2xkIHRoZSB0b2tlbnNcbiAgdmFyIHNwYWNlcyA9IFtdOyAgICAgICAvLyBJbmRpY2VzIG9mIHdoaXRlc3BhY2UgdG9rZW5zIG9uIHRoZSBjdXJyZW50IGxpbmVcbiAgdmFyIGhhc1RhZyA9IGZhbHNlOyAgICAvLyBJcyB0aGVyZSBhIHt7dGFnfX0gb24gdGhlIGN1cnJlbnQgbGluZT9cbiAgdmFyIG5vblNwYWNlID0gZmFsc2U7ICAvLyBJcyB0aGVyZSBhIG5vbi1zcGFjZSBjaGFyIG9uIHRoZSBjdXJyZW50IGxpbmU/XG4gIHZhciBpbmRlbnRhdGlvbiA9ICcnOyAgLy8gVHJhY2tzIGluZGVudGF0aW9uIGZvciB0YWdzIHRoYXQgdXNlIGl0XG4gIHZhciB0YWdJbmRleCA9IDA7ICAgICAgLy8gU3RvcmVzIGEgY291bnQgb2YgbnVtYmVyIG9mIHRhZ3MgZW5jb3VudGVyZWQgb24gYSBsaW5lXG5cbiAgLy8gU3RyaXBzIGFsbCB3aGl0ZXNwYWNlIHRva2VucyBhcnJheSBmb3IgdGhlIGN1cnJlbnQgbGluZVxuICAvLyBpZiB0aGVyZSB3YXMgYSB7eyN0YWd9fSBvbiBpdCBhbmQgb3RoZXJ3aXNlIG9ubHkgc3BhY2UuXG4gIGZ1bmN0aW9uIHN0cmlwU3BhY2UgKCkge1xuICAgIGlmIChoYXNUYWcgJiYgIW5vblNwYWNlKSB7XG4gICAgICB3aGlsZSAoc3BhY2VzLmxlbmd0aClcbiAgICAgICAgZGVsZXRlIHRva2Vuc1tzcGFjZXMucG9wKCldO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcGFjZXMgPSBbXTtcbiAgICB9XG5cbiAgICBoYXNUYWcgPSBmYWxzZTtcbiAgICBub25TcGFjZSA9IGZhbHNlO1xuICB9XG5cbiAgdmFyIG9wZW5pbmdUYWdSZSwgY2xvc2luZ1RhZ1JlLCBjbG9zaW5nQ3VybHlSZTtcbiAgZnVuY3Rpb24gY29tcGlsZVRhZ3MgKHRhZ3NUb0NvbXBpbGUpIHtcbiAgICBpZiAodHlwZW9mIHRhZ3NUb0NvbXBpbGUgPT09ICdzdHJpbmcnKVxuICAgICAgdGFnc1RvQ29tcGlsZSA9IHRhZ3NUb0NvbXBpbGUuc3BsaXQoc3BhY2VSZSwgMik7XG5cbiAgICBpZiAoIWlzQXJyYXkodGFnc1RvQ29tcGlsZSkgfHwgdGFnc1RvQ29tcGlsZS5sZW5ndGggIT09IDIpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdGFnczogJyArIHRhZ3NUb0NvbXBpbGUpO1xuXG4gICAgb3BlbmluZ1RhZ1JlID0gbmV3IFJlZ0V4cChlc2NhcGVSZWdFeHAodGFnc1RvQ29tcGlsZVswXSkgKyAnXFxcXHMqJyk7XG4gICAgY2xvc2luZ1RhZ1JlID0gbmV3IFJlZ0V4cCgnXFxcXHMqJyArIGVzY2FwZVJlZ0V4cCh0YWdzVG9Db21waWxlWzFdKSk7XG4gICAgY2xvc2luZ0N1cmx5UmUgPSBuZXcgUmVnRXhwKCdcXFxccyonICsgZXNjYXBlUmVnRXhwKCd9JyArIHRhZ3NUb0NvbXBpbGVbMV0pKTtcbiAgfVxuXG4gIGNvbXBpbGVUYWdzKHRhZ3MgfHwgbXVzdGFjaGUudGFncyk7XG5cbiAgdmFyIHNjYW5uZXIgPSBuZXcgU2Nhbm5lcih0ZW1wbGF0ZSk7XG5cbiAgdmFyIHN0YXJ0LCB0eXBlLCB2YWx1ZSwgY2hyLCB0b2tlbiwgb3BlblNlY3Rpb247XG4gIHdoaWxlICghc2Nhbm5lci5lb3MoKSkge1xuICAgIHN0YXJ0ID0gc2Nhbm5lci5wb3M7XG5cbiAgICAvLyBNYXRjaCBhbnkgdGV4dCBiZXR3ZWVuIHRhZ3MuXG4gICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChvcGVuaW5nVGFnUmUpO1xuXG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBmb3IgKHZhciBpID0gMCwgdmFsdWVMZW5ndGggPSB2YWx1ZS5sZW5ndGg7IGkgPCB2YWx1ZUxlbmd0aDsgKytpKSB7XG4gICAgICAgIGNociA9IHZhbHVlLmNoYXJBdChpKTtcblxuICAgICAgICBpZiAoaXNXaGl0ZXNwYWNlKGNocikpIHtcbiAgICAgICAgICBzcGFjZXMucHVzaCh0b2tlbnMubGVuZ3RoKTtcbiAgICAgICAgICBpbmRlbnRhdGlvbiArPSBjaHI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm9uU3BhY2UgPSB0cnVlO1xuICAgICAgICAgIGxpbmVIYXNOb25TcGFjZSA9IHRydWU7XG4gICAgICAgICAgaW5kZW50YXRpb24gKz0gJyAnO1xuICAgICAgICB9XG5cbiAgICAgICAgdG9rZW5zLnB1c2goWyAndGV4dCcsIGNociwgc3RhcnQsIHN0YXJ0ICsgMSBdKTtcbiAgICAgICAgc3RhcnQgKz0gMTtcblxuICAgICAgICAvLyBDaGVjayBmb3Igd2hpdGVzcGFjZSBvbiB0aGUgY3VycmVudCBsaW5lLlxuICAgICAgICBpZiAoY2hyID09PSAnXFxuJykge1xuICAgICAgICAgIHN0cmlwU3BhY2UoKTtcbiAgICAgICAgICBpbmRlbnRhdGlvbiA9ICcnO1xuICAgICAgICAgIHRhZ0luZGV4ID0gMDtcbiAgICAgICAgICBsaW5lSGFzTm9uU3BhY2UgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE1hdGNoIHRoZSBvcGVuaW5nIHRhZy5cbiAgICBpZiAoIXNjYW5uZXIuc2NhbihvcGVuaW5nVGFnUmUpKVxuICAgICAgYnJlYWs7XG5cbiAgICBoYXNUYWcgPSB0cnVlO1xuXG4gICAgLy8gR2V0IHRoZSB0YWcgdHlwZS5cbiAgICB0eXBlID0gc2Nhbm5lci5zY2FuKHRhZ1JlKSB8fCAnbmFtZSc7XG4gICAgc2Nhbm5lci5zY2FuKHdoaXRlUmUpO1xuXG4gICAgLy8gR2V0IHRoZSB0YWcgdmFsdWUuXG4gICAgaWYgKHR5cGUgPT09ICc9Jykge1xuICAgICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChlcXVhbHNSZSk7XG4gICAgICBzY2FubmVyLnNjYW4oZXF1YWxzUmUpO1xuICAgICAgc2Nhbm5lci5zY2FuVW50aWwoY2xvc2luZ1RhZ1JlKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICd7Jykge1xuICAgICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChjbG9zaW5nQ3VybHlSZSk7XG4gICAgICBzY2FubmVyLnNjYW4oY3VybHlSZSk7XG4gICAgICBzY2FubmVyLnNjYW5VbnRpbChjbG9zaW5nVGFnUmUpO1xuICAgICAgdHlwZSA9ICcmJztcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChjbG9zaW5nVGFnUmUpO1xuICAgIH1cblxuICAgIC8vIE1hdGNoIHRoZSBjbG9zaW5nIHRhZy5cbiAgICBpZiAoIXNjYW5uZXIuc2NhbihjbG9zaW5nVGFnUmUpKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmNsb3NlZCB0YWcgYXQgJyArIHNjYW5uZXIucG9zKTtcblxuICAgIGlmICh0eXBlID09ICc+Jykge1xuICAgICAgdG9rZW4gPSBbIHR5cGUsIHZhbHVlLCBzdGFydCwgc2Nhbm5lci5wb3MsIGluZGVudGF0aW9uLCB0YWdJbmRleCwgbGluZUhhc05vblNwYWNlIF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRva2VuID0gWyB0eXBlLCB2YWx1ZSwgc3RhcnQsIHNjYW5uZXIucG9zIF07XG4gICAgfVxuICAgIHRhZ0luZGV4Kys7XG4gICAgdG9rZW5zLnB1c2godG9rZW4pO1xuXG4gICAgaWYgKHR5cGUgPT09ICcjJyB8fCB0eXBlID09PSAnXicpIHtcbiAgICAgIHNlY3Rpb25zLnB1c2godG9rZW4pO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJy8nKSB7XG4gICAgICAvLyBDaGVjayBzZWN0aW9uIG5lc3RpbmcuXG4gICAgICBvcGVuU2VjdGlvbiA9IHNlY3Rpb25zLnBvcCgpO1xuXG4gICAgICBpZiAoIW9wZW5TZWN0aW9uKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vub3BlbmVkIHNlY3Rpb24gXCInICsgdmFsdWUgKyAnXCIgYXQgJyArIHN0YXJ0KTtcblxuICAgICAgaWYgKG9wZW5TZWN0aW9uWzFdICE9PSB2YWx1ZSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmNsb3NlZCBzZWN0aW9uIFwiJyArIG9wZW5TZWN0aW9uWzFdICsgJ1wiIGF0ICcgKyBzdGFydCk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnbmFtZScgfHwgdHlwZSA9PT0gJ3snIHx8IHR5cGUgPT09ICcmJykge1xuICAgICAgbm9uU3BhY2UgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJz0nKSB7XG4gICAgICAvLyBTZXQgdGhlIHRhZ3MgZm9yIHRoZSBuZXh0IHRpbWUgYXJvdW5kLlxuICAgICAgY29tcGlsZVRhZ3ModmFsdWUpO1xuICAgIH1cbiAgfVxuXG4gIHN0cmlwU3BhY2UoKTtcblxuICAvLyBNYWtlIHN1cmUgdGhlcmUgYXJlIG5vIG9wZW4gc2VjdGlvbnMgd2hlbiB3ZSdyZSBkb25lLlxuICBvcGVuU2VjdGlvbiA9IHNlY3Rpb25zLnBvcCgpO1xuXG4gIGlmIChvcGVuU2VjdGlvbilcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuY2xvc2VkIHNlY3Rpb24gXCInICsgb3BlblNlY3Rpb25bMV0gKyAnXCIgYXQgJyArIHNjYW5uZXIucG9zKTtcblxuICByZXR1cm4gbmVzdFRva2VucyhzcXVhc2hUb2tlbnModG9rZW5zKSk7XG59XG5cbi8qKlxuICogQ29tYmluZXMgdGhlIHZhbHVlcyBvZiBjb25zZWN1dGl2ZSB0ZXh0IHRva2VucyBpbiB0aGUgZ2l2ZW4gYHRva2Vuc2AgYXJyYXlcbiAqIHRvIGEgc2luZ2xlIHRva2VuLlxuICovXG5mdW5jdGlvbiBzcXVhc2hUb2tlbnMgKHRva2Vucykge1xuICB2YXIgc3F1YXNoZWRUb2tlbnMgPSBbXTtcblxuICB2YXIgdG9rZW4sIGxhc3RUb2tlbjtcbiAgZm9yICh2YXIgaSA9IDAsIG51bVRva2VucyA9IHRva2Vucy5sZW5ndGg7IGkgPCBudW1Ub2tlbnM7ICsraSkge1xuICAgIHRva2VuID0gdG9rZW5zW2ldO1xuXG4gICAgaWYgKHRva2VuKSB7XG4gICAgICBpZiAodG9rZW5bMF0gPT09ICd0ZXh0JyAmJiBsYXN0VG9rZW4gJiYgbGFzdFRva2VuWzBdID09PSAndGV4dCcpIHtcbiAgICAgICAgbGFzdFRva2VuWzFdICs9IHRva2VuWzFdO1xuICAgICAgICBsYXN0VG9rZW5bM10gPSB0b2tlblszXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNxdWFzaGVkVG9rZW5zLnB1c2godG9rZW4pO1xuICAgICAgICBsYXN0VG9rZW4gPSB0b2tlbjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gc3F1YXNoZWRUb2tlbnM7XG59XG5cbi8qKlxuICogRm9ybXMgdGhlIGdpdmVuIGFycmF5IG9mIGB0b2tlbnNgIGludG8gYSBuZXN0ZWQgdHJlZSBzdHJ1Y3R1cmUgd2hlcmVcbiAqIHRva2VucyB0aGF0IHJlcHJlc2VudCBhIHNlY3Rpb24gaGF2ZSB0d28gYWRkaXRpb25hbCBpdGVtczogMSkgYW4gYXJyYXkgb2ZcbiAqIGFsbCB0b2tlbnMgdGhhdCBhcHBlYXIgaW4gdGhhdCBzZWN0aW9uIGFuZCAyKSB0aGUgaW5kZXggaW4gdGhlIG9yaWdpbmFsXG4gKiB0ZW1wbGF0ZSB0aGF0IHJlcHJlc2VudHMgdGhlIGVuZCBvZiB0aGF0IHNlY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIG5lc3RUb2tlbnMgKHRva2Vucykge1xuICB2YXIgbmVzdGVkVG9rZW5zID0gW107XG4gIHZhciBjb2xsZWN0b3IgPSBuZXN0ZWRUb2tlbnM7XG4gIHZhciBzZWN0aW9ucyA9IFtdO1xuXG4gIHZhciB0b2tlbiwgc2VjdGlvbjtcbiAgZm9yICh2YXIgaSA9IDAsIG51bVRva2VucyA9IHRva2Vucy5sZW5ndGg7IGkgPCBudW1Ub2tlbnM7ICsraSkge1xuICAgIHRva2VuID0gdG9rZW5zW2ldO1xuXG4gICAgc3dpdGNoICh0b2tlblswXSkge1xuICAgICAgY2FzZSAnIyc6XG4gICAgICBjYXNlICdeJzpcbiAgICAgICAgY29sbGVjdG9yLnB1c2godG9rZW4pO1xuICAgICAgICBzZWN0aW9ucy5wdXNoKHRva2VuKTtcbiAgICAgICAgY29sbGVjdG9yID0gdG9rZW5bNF0gPSBbXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICcvJzpcbiAgICAgICAgc2VjdGlvbiA9IHNlY3Rpb25zLnBvcCgpO1xuICAgICAgICBzZWN0aW9uWzVdID0gdG9rZW5bMl07XG4gICAgICAgIGNvbGxlY3RvciA9IHNlY3Rpb25zLmxlbmd0aCA+IDAgPyBzZWN0aW9uc1tzZWN0aW9ucy5sZW5ndGggLSAxXVs0XSA6IG5lc3RlZFRva2VucztcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjb2xsZWN0b3IucHVzaCh0b2tlbik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5lc3RlZFRva2Vucztcbn1cblxuLyoqXG4gKiBBIHNpbXBsZSBzdHJpbmcgc2Nhbm5lciB0aGF0IGlzIHVzZWQgYnkgdGhlIHRlbXBsYXRlIHBhcnNlciB0byBmaW5kXG4gKiB0b2tlbnMgaW4gdGVtcGxhdGUgc3RyaW5ncy5cbiAqL1xuZnVuY3Rpb24gU2Nhbm5lciAoc3RyaW5nKSB7XG4gIHRoaXMuc3RyaW5nID0gc3RyaW5nO1xuICB0aGlzLnRhaWwgPSBzdHJpbmc7XG4gIHRoaXMucG9zID0gMDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgdGFpbCBpcyBlbXB0eSAoZW5kIG9mIHN0cmluZykuXG4gKi9cblNjYW5uZXIucHJvdG90eXBlLmVvcyA9IGZ1bmN0aW9uIGVvcyAoKSB7XG4gIHJldHVybiB0aGlzLnRhaWwgPT09ICcnO1xufTtcblxuLyoqXG4gKiBUcmllcyB0byBtYXRjaCB0aGUgZ2l2ZW4gcmVndWxhciBleHByZXNzaW9uIGF0IHRoZSBjdXJyZW50IHBvc2l0aW9uLlxuICogUmV0dXJucyB0aGUgbWF0Y2hlZCB0ZXh0IGlmIGl0IGNhbiBtYXRjaCwgdGhlIGVtcHR5IHN0cmluZyBvdGhlcndpc2UuXG4gKi9cblNjYW5uZXIucHJvdG90eXBlLnNjYW4gPSBmdW5jdGlvbiBzY2FuIChyZSkge1xuICB2YXIgbWF0Y2ggPSB0aGlzLnRhaWwubWF0Y2gocmUpO1xuXG4gIGlmICghbWF0Y2ggfHwgbWF0Y2guaW5kZXggIT09IDApXG4gICAgcmV0dXJuICcnO1xuXG4gIHZhciBzdHJpbmcgPSBtYXRjaFswXTtcblxuICB0aGlzLnRhaWwgPSB0aGlzLnRhaWwuc3Vic3RyaW5nKHN0cmluZy5sZW5ndGgpO1xuICB0aGlzLnBvcyArPSBzdHJpbmcubGVuZ3RoO1xuXG4gIHJldHVybiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIFNraXBzIGFsbCB0ZXh0IHVudGlsIHRoZSBnaXZlbiByZWd1bGFyIGV4cHJlc3Npb24gY2FuIGJlIG1hdGNoZWQuIFJldHVybnNcbiAqIHRoZSBza2lwcGVkIHN0cmluZywgd2hpY2ggaXMgdGhlIGVudGlyZSB0YWlsIGlmIG5vIG1hdGNoIGNhbiBiZSBtYWRlLlxuICovXG5TY2FubmVyLnByb3RvdHlwZS5zY2FuVW50aWwgPSBmdW5jdGlvbiBzY2FuVW50aWwgKHJlKSB7XG4gIHZhciBpbmRleCA9IHRoaXMudGFpbC5zZWFyY2gocmUpLCBtYXRjaDtcblxuICBzd2l0Y2ggKGluZGV4KSB7XG4gICAgY2FzZSAtMTpcbiAgICAgIG1hdGNoID0gdGhpcy50YWlsO1xuICAgICAgdGhpcy50YWlsID0gJyc7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDA6XG4gICAgICBtYXRjaCA9ICcnO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIG1hdGNoID0gdGhpcy50YWlsLnN1YnN0cmluZygwLCBpbmRleCk7XG4gICAgICB0aGlzLnRhaWwgPSB0aGlzLnRhaWwuc3Vic3RyaW5nKGluZGV4KTtcbiAgfVxuXG4gIHRoaXMucG9zICs9IG1hdGNoLmxlbmd0aDtcblxuICByZXR1cm4gbWF0Y2g7XG59O1xuXG4vKipcbiAqIFJlcHJlc2VudHMgYSByZW5kZXJpbmcgY29udGV4dCBieSB3cmFwcGluZyBhIHZpZXcgb2JqZWN0IGFuZFxuICogbWFpbnRhaW5pbmcgYSByZWZlcmVuY2UgdG8gdGhlIHBhcmVudCBjb250ZXh0LlxuICovXG5mdW5jdGlvbiBDb250ZXh0ICh2aWV3LCBwYXJlbnRDb250ZXh0KSB7XG4gIHRoaXMudmlldyA9IHZpZXc7XG4gIHRoaXMuY2FjaGUgPSB7ICcuJzogdGhpcy52aWV3IH07XG4gIHRoaXMucGFyZW50ID0gcGFyZW50Q29udGV4dDtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGNvbnRleHQgdXNpbmcgdGhlIGdpdmVuIHZpZXcgd2l0aCB0aGlzIGNvbnRleHRcbiAqIGFzIHRoZSBwYXJlbnQuXG4gKi9cbkNvbnRleHQucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiBwdXNoICh2aWV3KSB7XG4gIHJldHVybiBuZXcgQ29udGV4dCh2aWV3LCB0aGlzKTtcbn07XG5cbi8qKlxuICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIG5hbWUgaW4gdGhpcyBjb250ZXh0LCB0cmF2ZXJzaW5nXG4gKiB1cCB0aGUgY29udGV4dCBoaWVyYXJjaHkgaWYgdGhlIHZhbHVlIGlzIGFic2VudCBpbiB0aGlzIGNvbnRleHQncyB2aWV3LlxuICovXG5Db250ZXh0LnByb3RvdHlwZS5sb29rdXAgPSBmdW5jdGlvbiBsb29rdXAgKG5hbWUpIHtcbiAgdmFyIGNhY2hlID0gdGhpcy5jYWNoZTtcblxuICB2YXIgdmFsdWU7XG4gIGlmIChjYWNoZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgIHZhbHVlID0gY2FjaGVbbmFtZV07XG4gIH0gZWxzZSB7XG4gICAgdmFyIGNvbnRleHQgPSB0aGlzLCBpbnRlcm1lZGlhdGVWYWx1ZSwgbmFtZXMsIGluZGV4LCBsb29rdXBIaXQgPSBmYWxzZTtcblxuICAgIHdoaWxlIChjb250ZXh0KSB7XG4gICAgICBpZiAobmFtZS5pbmRleE9mKCcuJykgPiAwKSB7XG4gICAgICAgIGludGVybWVkaWF0ZVZhbHVlID0gY29udGV4dC52aWV3O1xuICAgICAgICBuYW1lcyA9IG5hbWUuc3BsaXQoJy4nKTtcbiAgICAgICAgaW5kZXggPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVc2luZyB0aGUgZG90IG5vdGlvbiBwYXRoIGluIGBuYW1lYCwgd2UgZGVzY2VuZCB0aHJvdWdoIHRoZVxuICAgICAgICAgKiBuZXN0ZWQgb2JqZWN0cy5cbiAgICAgICAgICpcbiAgICAgICAgICogVG8gYmUgY2VydGFpbiB0aGF0IHRoZSBsb29rdXAgaGFzIGJlZW4gc3VjY2Vzc2Z1bCwgd2UgaGF2ZSB0b1xuICAgICAgICAgKiBjaGVjayBpZiB0aGUgbGFzdCBvYmplY3QgaW4gdGhlIHBhdGggYWN0dWFsbHkgaGFzIHRoZSBwcm9wZXJ0eVxuICAgICAgICAgKiB3ZSBhcmUgbG9va2luZyBmb3IuIFdlIHN0b3JlIHRoZSByZXN1bHQgaW4gYGxvb2t1cEhpdGAuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoaXMgaXMgc3BlY2lhbGx5IG5lY2Vzc2FyeSBmb3Igd2hlbiB0aGUgdmFsdWUgaGFzIGJlZW4gc2V0IHRvXG4gICAgICAgICAqIGB1bmRlZmluZWRgIGFuZCB3ZSB3YW50IHRvIGF2b2lkIGxvb2tpbmcgdXAgcGFyZW50IGNvbnRleHRzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBJbiB0aGUgY2FzZSB3aGVyZSBkb3Qgbm90YXRpb24gaXMgdXNlZCwgd2UgY29uc2lkZXIgdGhlIGxvb2t1cFxuICAgICAgICAgKiB0byBiZSBzdWNjZXNzZnVsIGV2ZW4gaWYgdGhlIGxhc3QgXCJvYmplY3RcIiBpbiB0aGUgcGF0aCBpc1xuICAgICAgICAgKiBub3QgYWN0dWFsbHkgYW4gb2JqZWN0IGJ1dCBhIHByaW1pdGl2ZSAoZS5nLiwgYSBzdHJpbmcsIG9yIGFuXG4gICAgICAgICAqIGludGVnZXIpLCBiZWNhdXNlIGl0IGlzIHNvbWV0aW1lcyB1c2VmdWwgdG8gYWNjZXNzIGEgcHJvcGVydHlcbiAgICAgICAgICogb2YgYW4gYXV0b2JveGVkIHByaW1pdGl2ZSwgc3VjaCBhcyB0aGUgbGVuZ3RoIG9mIGEgc3RyaW5nLlxuICAgICAgICAgKiovXG4gICAgICAgIHdoaWxlIChpbnRlcm1lZGlhdGVWYWx1ZSAhPSBudWxsICYmIGluZGV4IDwgbmFtZXMubGVuZ3RoKSB7XG4gICAgICAgICAgaWYgKGluZGV4ID09PSBuYW1lcy5sZW5ndGggLSAxKVxuICAgICAgICAgICAgbG9va3VwSGl0ID0gKFxuICAgICAgICAgICAgICBoYXNQcm9wZXJ0eShpbnRlcm1lZGlhdGVWYWx1ZSwgbmFtZXNbaW5kZXhdKVxuICAgICAgICAgICAgICB8fCBwcmltaXRpdmVIYXNPd25Qcm9wZXJ0eShpbnRlcm1lZGlhdGVWYWx1ZSwgbmFtZXNbaW5kZXhdKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgIGludGVybWVkaWF0ZVZhbHVlID0gaW50ZXJtZWRpYXRlVmFsdWVbbmFtZXNbaW5kZXgrK11dO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnRlcm1lZGlhdGVWYWx1ZSA9IGNvbnRleHQudmlld1tuYW1lXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogT25seSBjaGVja2luZyBhZ2FpbnN0IGBoYXNQcm9wZXJ0eWAsIHdoaWNoIGFsd2F5cyByZXR1cm5zIGBmYWxzZWAgaWZcbiAgICAgICAgICogYGNvbnRleHQudmlld2AgaXMgbm90IGFuIG9iamVjdC4gRGVsaWJlcmF0ZWx5IG9taXR0aW5nIHRoZSBjaGVja1xuICAgICAgICAgKiBhZ2FpbnN0IGBwcmltaXRpdmVIYXNPd25Qcm9wZXJ0eWAgaWYgZG90IG5vdGF0aW9uIGlzIG5vdCB1c2VkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBDb25zaWRlciB0aGlzIGV4YW1wbGU6XG4gICAgICAgICAqIGBgYFxuICAgICAgICAgKiBNdXN0YWNoZS5yZW5kZXIoXCJUaGUgbGVuZ3RoIG9mIGEgZm9vdGJhbGwgZmllbGQgaXMge3sjbGVuZ3RofX17e2xlbmd0aH19e3svbGVuZ3RofX0uXCIsIHtsZW5ndGg6IFwiMTAwIHlhcmRzXCJ9KVxuICAgICAgICAgKiBgYGBcbiAgICAgICAgICpcbiAgICAgICAgICogSWYgd2Ugd2VyZSB0byBjaGVjayBhbHNvIGFnYWluc3QgYHByaW1pdGl2ZUhhc093blByb3BlcnR5YCwgYXMgd2UgZG9cbiAgICAgICAgICogaW4gdGhlIGRvdCBub3RhdGlvbiBjYXNlLCB0aGVuIHJlbmRlciBjYWxsIHdvdWxkIHJldHVybjpcbiAgICAgICAgICpcbiAgICAgICAgICogXCJUaGUgbGVuZ3RoIG9mIGEgZm9vdGJhbGwgZmllbGQgaXMgOS5cIlxuICAgICAgICAgKlxuICAgICAgICAgKiByYXRoZXIgdGhhbiB0aGUgZXhwZWN0ZWQ6XG4gICAgICAgICAqXG4gICAgICAgICAqIFwiVGhlIGxlbmd0aCBvZiBhIGZvb3RiYWxsIGZpZWxkIGlzIDEwMCB5YXJkcy5cIlxuICAgICAgICAgKiovXG4gICAgICAgIGxvb2t1cEhpdCA9IGhhc1Byb3BlcnR5KGNvbnRleHQudmlldywgbmFtZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChsb29rdXBIaXQpIHtcbiAgICAgICAgdmFsdWUgPSBpbnRlcm1lZGlhdGVWYWx1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNvbnRleHQgPSBjb250ZXh0LnBhcmVudDtcbiAgICB9XG5cbiAgICBjYWNoZVtuYW1lXSA9IHZhbHVlO1xuICB9XG5cbiAgaWYgKGlzRnVuY3Rpb24odmFsdWUpKVxuICAgIHZhbHVlID0gdmFsdWUuY2FsbCh0aGlzLnZpZXcpO1xuXG4gIHJldHVybiB2YWx1ZTtcbn07XG5cbi8qKlxuICogQSBXcml0ZXIga25vd3MgaG93IHRvIHRha2UgYSBzdHJlYW0gb2YgdG9rZW5zIGFuZCByZW5kZXIgdGhlbSB0byBhXG4gKiBzdHJpbmcsIGdpdmVuIGEgY29udGV4dC4gSXQgYWxzbyBtYWludGFpbnMgYSBjYWNoZSBvZiB0ZW1wbGF0ZXMgdG9cbiAqIGF2b2lkIHRoZSBuZWVkIHRvIHBhcnNlIHRoZSBzYW1lIHRlbXBsYXRlIHR3aWNlLlxuICovXG5mdW5jdGlvbiBXcml0ZXIgKCkge1xuICB0aGlzLnRlbXBsYXRlQ2FjaGUgPSB7XG4gICAgX2NhY2hlOiB7fSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldCAoa2V5LCB2YWx1ZSkge1xuICAgICAgdGhpcy5fY2FjaGVba2V5XSA9IHZhbHVlO1xuICAgIH0sXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQgKGtleSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlW2tleV07XG4gICAgfSxcbiAgICBjbGVhcjogZnVuY3Rpb24gY2xlYXIgKCkge1xuICAgICAgdGhpcy5fY2FjaGUgPSB7fTtcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogQ2xlYXJzIGFsbCBjYWNoZWQgdGVtcGxhdGVzIGluIHRoaXMgd3JpdGVyLlxuICovXG5Xcml0ZXIucHJvdG90eXBlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbiBjbGVhckNhY2hlICgpIHtcbiAgaWYgKHR5cGVvZiB0aGlzLnRlbXBsYXRlQ2FjaGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgdGhpcy50ZW1wbGF0ZUNhY2hlLmNsZWFyKCk7XG4gIH1cbn07XG5cbi8qKlxuICogUGFyc2VzIGFuZCBjYWNoZXMgdGhlIGdpdmVuIGB0ZW1wbGF0ZWAgYWNjb3JkaW5nIHRvIHRoZSBnaXZlbiBgdGFnc2Agb3JcbiAqIGBtdXN0YWNoZS50YWdzYCBpZiBgdGFnc2AgaXMgb21pdHRlZCwgIGFuZCByZXR1cm5zIHRoZSBhcnJheSBvZiB0b2tlbnNcbiAqIHRoYXQgaXMgZ2VuZXJhdGVkIGZyb20gdGhlIHBhcnNlLlxuICovXG5Xcml0ZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gcGFyc2UgKHRlbXBsYXRlLCB0YWdzKSB7XG4gIHZhciBjYWNoZSA9IHRoaXMudGVtcGxhdGVDYWNoZTtcbiAgdmFyIGNhY2hlS2V5ID0gdGVtcGxhdGUgKyAnOicgKyAodGFncyB8fCBtdXN0YWNoZS50YWdzKS5qb2luKCc6Jyk7XG4gIHZhciBpc0NhY2hlRW5hYmxlZCA9IHR5cGVvZiBjYWNoZSAhPT0gJ3VuZGVmaW5lZCc7XG4gIHZhciB0b2tlbnMgPSBpc0NhY2hlRW5hYmxlZCA/IGNhY2hlLmdldChjYWNoZUtleSkgOiB1bmRlZmluZWQ7XG5cbiAgaWYgKHRva2VucyA9PSB1bmRlZmluZWQpIHtcbiAgICB0b2tlbnMgPSBwYXJzZVRlbXBsYXRlKHRlbXBsYXRlLCB0YWdzKTtcbiAgICBpc0NhY2hlRW5hYmxlZCAmJiBjYWNoZS5zZXQoY2FjaGVLZXksIHRva2Vucyk7XG4gIH1cbiAgcmV0dXJuIHRva2Vucztcbn07XG5cbi8qKlxuICogSGlnaC1sZXZlbCBtZXRob2QgdGhhdCBpcyB1c2VkIHRvIHJlbmRlciB0aGUgZ2l2ZW4gYHRlbXBsYXRlYCB3aXRoXG4gKiB0aGUgZ2l2ZW4gYHZpZXdgLlxuICpcbiAqIFRoZSBvcHRpb25hbCBgcGFydGlhbHNgIGFyZ3VtZW50IG1heSBiZSBhbiBvYmplY3QgdGhhdCBjb250YWlucyB0aGVcbiAqIG5hbWVzIGFuZCB0ZW1wbGF0ZXMgb2YgcGFydGlhbHMgdGhhdCBhcmUgdXNlZCBpbiB0aGUgdGVtcGxhdGUuIEl0IG1heVxuICogYWxzbyBiZSBhIGZ1bmN0aW9uIHRoYXQgaXMgdXNlZCB0byBsb2FkIHBhcnRpYWwgdGVtcGxhdGVzIG9uIHRoZSBmbHlcbiAqIHRoYXQgdGFrZXMgYSBzaW5nbGUgYXJndW1lbnQ6IHRoZSBuYW1lIG9mIHRoZSBwYXJ0aWFsLlxuICpcbiAqIElmIHRoZSBvcHRpb25hbCBgY29uZmlnYCBhcmd1bWVudCBpcyBnaXZlbiBoZXJlLCB0aGVuIGl0IHNob3VsZCBiZSBhblxuICogb2JqZWN0IHdpdGggYSBgdGFnc2AgYXR0cmlidXRlIG9yIGFuIGBlc2NhcGVgIGF0dHJpYnV0ZSBvciBib3RoLlxuICogSWYgYW4gYXJyYXkgaXMgcGFzc2VkLCB0aGVuIGl0IHdpbGwgYmUgaW50ZXJwcmV0ZWQgdGhlIHNhbWUgd2F5IGFzXG4gKiBhIGB0YWdzYCBhdHRyaWJ1dGUgb24gYSBgY29uZmlnYCBvYmplY3QuXG4gKlxuICogVGhlIGB0YWdzYCBhdHRyaWJ1dGUgb2YgYSBgY29uZmlnYCBvYmplY3QgbXVzdCBiZSBhbiBhcnJheSB3aXRoIHR3b1xuICogc3RyaW5nIHZhbHVlczogdGhlIG9wZW5pbmcgYW5kIGNsb3NpbmcgdGFncyB1c2VkIGluIHRoZSB0ZW1wbGF0ZSAoZS5nLlxuICogWyBcIjwlXCIsIFwiJT5cIiBdKS4gVGhlIGRlZmF1bHQgaXMgdG8gbXVzdGFjaGUudGFncy5cbiAqXG4gKiBUaGUgYGVzY2FwZWAgYXR0cmlidXRlIG9mIGEgYGNvbmZpZ2Agb2JqZWN0IG11c3QgYmUgYSBmdW5jdGlvbiB3aGljaFxuICogYWNjZXB0cyBhIHN0cmluZyBhcyBpbnB1dCBhbmQgb3V0cHV0cyBhIHNhZmVseSBlc2NhcGVkIHN0cmluZy5cbiAqIElmIGFuIGBlc2NhcGVgIGZ1bmN0aW9uIGlzIG5vdCBwcm92aWRlZCwgdGhlbiBhbiBIVE1MLXNhZmUgc3RyaW5nXG4gKiBlc2NhcGluZyBmdW5jdGlvbiBpcyB1c2VkIGFzIHRoZSBkZWZhdWx0LlxuICovXG5Xcml0ZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzLCBjb25maWcpIHtcbiAgdmFyIHRhZ3MgPSB0aGlzLmdldENvbmZpZ1RhZ3MoY29uZmlnKTtcbiAgdmFyIHRva2VucyA9IHRoaXMucGFyc2UodGVtcGxhdGUsIHRhZ3MpO1xuICB2YXIgY29udGV4dCA9ICh2aWV3IGluc3RhbmNlb2YgQ29udGV4dCkgPyB2aWV3IDogbmV3IENvbnRleHQodmlldywgdW5kZWZpbmVkKTtcbiAgcmV0dXJuIHRoaXMucmVuZGVyVG9rZW5zKHRva2VucywgY29udGV4dCwgcGFydGlhbHMsIHRlbXBsYXRlLCBjb25maWcpO1xufTtcblxuLyoqXG4gKiBMb3ctbGV2ZWwgbWV0aG9kIHRoYXQgcmVuZGVycyB0aGUgZ2l2ZW4gYXJyYXkgb2YgYHRva2Vuc2AgdXNpbmdcbiAqIHRoZSBnaXZlbiBgY29udGV4dGAgYW5kIGBwYXJ0aWFsc2AuXG4gKlxuICogTm90ZTogVGhlIGBvcmlnaW5hbFRlbXBsYXRlYCBpcyBvbmx5IGV2ZXIgdXNlZCB0byBleHRyYWN0IHRoZSBwb3J0aW9uXG4gKiBvZiB0aGUgb3JpZ2luYWwgdGVtcGxhdGUgdGhhdCB3YXMgY29udGFpbmVkIGluIGEgaGlnaGVyLW9yZGVyIHNlY3Rpb24uXG4gKiBJZiB0aGUgdGVtcGxhdGUgZG9lc24ndCB1c2UgaGlnaGVyLW9yZGVyIHNlY3Rpb25zLCB0aGlzIGFyZ3VtZW50IG1heVxuICogYmUgb21pdHRlZC5cbiAqL1xuV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJUb2tlbnMgPSBmdW5jdGlvbiByZW5kZXJUb2tlbnMgKHRva2VucywgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUsIGNvbmZpZykge1xuICB2YXIgYnVmZmVyID0gJyc7XG5cbiAgdmFyIHRva2VuLCBzeW1ib2wsIHZhbHVlO1xuICBmb3IgKHZhciBpID0gMCwgbnVtVG9rZW5zID0gdG9rZW5zLmxlbmd0aDsgaSA8IG51bVRva2VuczsgKytpKSB7XG4gICAgdmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgdG9rZW4gPSB0b2tlbnNbaV07XG4gICAgc3ltYm9sID0gdG9rZW5bMF07XG5cbiAgICBpZiAoc3ltYm9sID09PSAnIycpIHZhbHVlID0gdGhpcy5yZW5kZXJTZWN0aW9uKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSwgY29uZmlnKTtcbiAgICBlbHNlIGlmIChzeW1ib2wgPT09ICdeJykgdmFsdWUgPSB0aGlzLnJlbmRlckludmVydGVkKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSwgY29uZmlnKTtcbiAgICBlbHNlIGlmIChzeW1ib2wgPT09ICc+JykgdmFsdWUgPSB0aGlzLnJlbmRlclBhcnRpYWwodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBjb25maWcpO1xuICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJyYnKSB2YWx1ZSA9IHRoaXMudW5lc2NhcGVkVmFsdWUodG9rZW4sIGNvbnRleHQpO1xuICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJ25hbWUnKSB2YWx1ZSA9IHRoaXMuZXNjYXBlZFZhbHVlKHRva2VuLCBjb250ZXh0LCBjb25maWcpO1xuICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJ3RleHQnKSB2YWx1ZSA9IHRoaXMucmF3VmFsdWUodG9rZW4pO1xuXG4gICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpXG4gICAgICBidWZmZXIgKz0gdmFsdWU7XG4gIH1cblxuICByZXR1cm4gYnVmZmVyO1xufTtcblxuV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJTZWN0aW9uID0gZnVuY3Rpb24gcmVuZGVyU2VjdGlvbiAodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlLCBjb25maWcpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgYnVmZmVyID0gJyc7XG4gIHZhciB2YWx1ZSA9IGNvbnRleHQubG9va3VwKHRva2VuWzFdKTtcblxuICAvLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVuZGVyIGFuIGFyYml0cmFyeSB0ZW1wbGF0ZVxuICAvLyBpbiB0aGUgY3VycmVudCBjb250ZXh0IGJ5IGhpZ2hlci1vcmRlciBzZWN0aW9ucy5cbiAgZnVuY3Rpb24gc3ViUmVuZGVyICh0ZW1wbGF0ZSkge1xuICAgIHJldHVybiBzZWxmLnJlbmRlcih0ZW1wbGF0ZSwgY29udGV4dCwgcGFydGlhbHMsIGNvbmZpZyk7XG4gIH1cblxuICBpZiAoIXZhbHVlKSByZXR1cm47XG5cbiAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgZm9yICh2YXIgaiA9IDAsIHZhbHVlTGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBqIDwgdmFsdWVMZW5ndGg7ICsraikge1xuICAgICAgYnVmZmVyICs9IHRoaXMucmVuZGVyVG9rZW5zKHRva2VuWzRdLCBjb250ZXh0LnB1c2godmFsdWVbal0pLCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSwgY29uZmlnKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyB8fCB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICBidWZmZXIgKz0gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5bNF0sIGNvbnRleHQucHVzaCh2YWx1ZSksIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlLCBjb25maWcpO1xuICB9IGVsc2UgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgaWYgKHR5cGVvZiBvcmlnaW5hbFRlbXBsYXRlICE9PSAnc3RyaW5nJylcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHVzZSBoaWdoZXItb3JkZXIgc2VjdGlvbnMgd2l0aG91dCB0aGUgb3JpZ2luYWwgdGVtcGxhdGUnKTtcblxuICAgIC8vIEV4dHJhY3QgdGhlIHBvcnRpb24gb2YgdGhlIG9yaWdpbmFsIHRlbXBsYXRlIHRoYXQgdGhlIHNlY3Rpb24gY29udGFpbnMuXG4gICAgdmFsdWUgPSB2YWx1ZS5jYWxsKGNvbnRleHQudmlldywgb3JpZ2luYWxUZW1wbGF0ZS5zbGljZSh0b2tlblszXSwgdG9rZW5bNV0pLCBzdWJSZW5kZXIpO1xuXG4gICAgaWYgKHZhbHVlICE9IG51bGwpXG4gICAgICBidWZmZXIgKz0gdmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgYnVmZmVyICs9IHRoaXMucmVuZGVyVG9rZW5zKHRva2VuWzRdLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSwgY29uZmlnKTtcbiAgfVxuICByZXR1cm4gYnVmZmVyO1xufTtcblxuV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJJbnZlcnRlZCA9IGZ1bmN0aW9uIHJlbmRlckludmVydGVkICh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUsIGNvbmZpZykge1xuICB2YXIgdmFsdWUgPSBjb250ZXh0Lmxvb2t1cCh0b2tlblsxXSk7XG5cbiAgLy8gVXNlIEphdmFTY3JpcHQncyBkZWZpbml0aW9uIG9mIGZhbHN5LiBJbmNsdWRlIGVtcHR5IGFycmF5cy5cbiAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qYW5sL211c3RhY2hlLmpzL2lzc3Vlcy8xODZcbiAgaWYgKCF2YWx1ZSB8fCAoaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID09PSAwKSlcbiAgICByZXR1cm4gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5bNF0sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlLCBjb25maWcpO1xufTtcblxuV3JpdGVyLnByb3RvdHlwZS5pbmRlbnRQYXJ0aWFsID0gZnVuY3Rpb24gaW5kZW50UGFydGlhbCAocGFydGlhbCwgaW5kZW50YXRpb24sIGxpbmVIYXNOb25TcGFjZSkge1xuICB2YXIgZmlsdGVyZWRJbmRlbnRhdGlvbiA9IGluZGVudGF0aW9uLnJlcGxhY2UoL1teIFxcdF0vZywgJycpO1xuICB2YXIgcGFydGlhbEJ5TmwgPSBwYXJ0aWFsLnNwbGl0KCdcXG4nKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJ0aWFsQnlObC5sZW5ndGg7IGkrKykge1xuICAgIGlmIChwYXJ0aWFsQnlObFtpXS5sZW5ndGggJiYgKGkgPiAwIHx8ICFsaW5lSGFzTm9uU3BhY2UpKSB7XG4gICAgICBwYXJ0aWFsQnlObFtpXSA9IGZpbHRlcmVkSW5kZW50YXRpb24gKyBwYXJ0aWFsQnlObFtpXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcnRpYWxCeU5sLmpvaW4oJ1xcbicpO1xufTtcblxuV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJQYXJ0aWFsID0gZnVuY3Rpb24gcmVuZGVyUGFydGlhbCAodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBjb25maWcpIHtcbiAgaWYgKCFwYXJ0aWFscykgcmV0dXJuO1xuICB2YXIgdGFncyA9IHRoaXMuZ2V0Q29uZmlnVGFncyhjb25maWcpO1xuXG4gIHZhciB2YWx1ZSA9IGlzRnVuY3Rpb24ocGFydGlhbHMpID8gcGFydGlhbHModG9rZW5bMV0pIDogcGFydGlhbHNbdG9rZW5bMV1dO1xuICBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgIHZhciBsaW5lSGFzTm9uU3BhY2UgPSB0b2tlbls2XTtcbiAgICB2YXIgdGFnSW5kZXggPSB0b2tlbls1XTtcbiAgICB2YXIgaW5kZW50YXRpb24gPSB0b2tlbls0XTtcbiAgICB2YXIgaW5kZW50ZWRWYWx1ZSA9IHZhbHVlO1xuICAgIGlmICh0YWdJbmRleCA9PSAwICYmIGluZGVudGF0aW9uKSB7XG4gICAgICBpbmRlbnRlZFZhbHVlID0gdGhpcy5pbmRlbnRQYXJ0aWFsKHZhbHVlLCBpbmRlbnRhdGlvbiwgbGluZUhhc05vblNwYWNlKTtcbiAgICB9XG4gICAgdmFyIHRva2VucyA9IHRoaXMucGFyc2UoaW5kZW50ZWRWYWx1ZSwgdGFncyk7XG4gICAgcmV0dXJuIHRoaXMucmVuZGVyVG9rZW5zKHRva2VucywgY29udGV4dCwgcGFydGlhbHMsIGluZGVudGVkVmFsdWUsIGNvbmZpZyk7XG4gIH1cbn07XG5cbldyaXRlci5wcm90b3R5cGUudW5lc2NhcGVkVmFsdWUgPSBmdW5jdGlvbiB1bmVzY2FwZWRWYWx1ZSAodG9rZW4sIGNvbnRleHQpIHtcbiAgdmFyIHZhbHVlID0gY29udGV4dC5sb29rdXAodG9rZW5bMV0pO1xuICBpZiAodmFsdWUgIT0gbnVsbClcbiAgICByZXR1cm4gdmFsdWU7XG59O1xuXG5Xcml0ZXIucHJvdG90eXBlLmVzY2FwZWRWYWx1ZSA9IGZ1bmN0aW9uIGVzY2FwZWRWYWx1ZSAodG9rZW4sIGNvbnRleHQsIGNvbmZpZykge1xuICB2YXIgZXNjYXBlID0gdGhpcy5nZXRDb25maWdFc2NhcGUoY29uZmlnKSB8fCBtdXN0YWNoZS5lc2NhcGU7XG4gIHZhciB2YWx1ZSA9IGNvbnRleHQubG9va3VwKHRva2VuWzFdKTtcbiAgaWYgKHZhbHVlICE9IG51bGwpXG4gICAgcmV0dXJuICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIGVzY2FwZSA9PT0gbXVzdGFjaGUuZXNjYXBlKSA/IFN0cmluZyh2YWx1ZSkgOiBlc2NhcGUodmFsdWUpO1xufTtcblxuV3JpdGVyLnByb3RvdHlwZS5yYXdWYWx1ZSA9IGZ1bmN0aW9uIHJhd1ZhbHVlICh0b2tlbikge1xuICByZXR1cm4gdG9rZW5bMV07XG59O1xuXG5Xcml0ZXIucHJvdG90eXBlLmdldENvbmZpZ1RhZ3MgPSBmdW5jdGlvbiBnZXRDb25maWdUYWdzIChjb25maWcpIHtcbiAgaWYgKGlzQXJyYXkoY29uZmlnKSkge1xuICAgIHJldHVybiBjb25maWc7XG4gIH1cbiAgZWxzZSBpZiAoY29uZmlnICYmIHR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIGNvbmZpZy50YWdzO1xuICB9XG4gIGVsc2Uge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn07XG5cbldyaXRlci5wcm90b3R5cGUuZ2V0Q29uZmlnRXNjYXBlID0gZnVuY3Rpb24gZ2V0Q29uZmlnRXNjYXBlIChjb25maWcpIHtcbiAgaWYgKGNvbmZpZyAmJiB0eXBlb2YgY29uZmlnID09PSAnb2JqZWN0JyAmJiAhaXNBcnJheShjb25maWcpKSB7XG4gICAgcmV0dXJuIGNvbmZpZy5lc2NhcGU7XG4gIH1cbiAgZWxzZSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufTtcblxudmFyIG11c3RhY2hlID0ge1xuICBuYW1lOiAnbXVzdGFjaGUuanMnLFxuICB2ZXJzaW9uOiAnNC4yLjAnLFxuICB0YWdzOiBbICd7eycsICd9fScgXSxcbiAgY2xlYXJDYWNoZTogdW5kZWZpbmVkLFxuICBlc2NhcGU6IHVuZGVmaW5lZCxcbiAgcGFyc2U6IHVuZGVmaW5lZCxcbiAgcmVuZGVyOiB1bmRlZmluZWQsXG4gIFNjYW5uZXI6IHVuZGVmaW5lZCxcbiAgQ29udGV4dDogdW5kZWZpbmVkLFxuICBXcml0ZXI6IHVuZGVmaW5lZCxcbiAgLyoqXG4gICAqIEFsbG93cyBhIHVzZXIgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHQgY2FjaGluZyBzdHJhdGVneSwgYnkgcHJvdmlkaW5nIGFuXG4gICAqIG9iamVjdCB3aXRoIHNldCwgZ2V0IGFuZCBjbGVhciBtZXRob2RzLiBUaGlzIGNhbiBhbHNvIGJlIHVzZWQgdG8gZGlzYWJsZVxuICAgKiB0aGUgY2FjaGUgYnkgc2V0dGluZyBpdCB0byB0aGUgbGl0ZXJhbCBgdW5kZWZpbmVkYC5cbiAgICovXG4gIHNldCB0ZW1wbGF0ZUNhY2hlIChjYWNoZSkge1xuICAgIGRlZmF1bHRXcml0ZXIudGVtcGxhdGVDYWNoZSA9IGNhY2hlO1xuICB9LFxuICAvKipcbiAgICogR2V0cyB0aGUgZGVmYXVsdCBvciBvdmVycmlkZGVuIGNhY2hpbmcgb2JqZWN0IGZyb20gdGhlIGRlZmF1bHQgd3JpdGVyLlxuICAgKi9cbiAgZ2V0IHRlbXBsYXRlQ2FjaGUgKCkge1xuICAgIHJldHVybiBkZWZhdWx0V3JpdGVyLnRlbXBsYXRlQ2FjaGU7XG4gIH1cbn07XG5cbi8vIEFsbCBoaWdoLWxldmVsIG11c3RhY2hlLiogZnVuY3Rpb25zIHVzZSB0aGlzIHdyaXRlci5cbnZhciBkZWZhdWx0V3JpdGVyID0gbmV3IFdyaXRlcigpO1xuXG4vKipcbiAqIENsZWFycyBhbGwgY2FjaGVkIHRlbXBsYXRlcyBpbiB0aGUgZGVmYXVsdCB3cml0ZXIuXG4gKi9cbm11c3RhY2hlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbiBjbGVhckNhY2hlICgpIHtcbiAgcmV0dXJuIGRlZmF1bHRXcml0ZXIuY2xlYXJDYWNoZSgpO1xufTtcblxuLyoqXG4gKiBQYXJzZXMgYW5kIGNhY2hlcyB0aGUgZ2l2ZW4gdGVtcGxhdGUgaW4gdGhlIGRlZmF1bHQgd3JpdGVyIGFuZCByZXR1cm5zIHRoZVxuICogYXJyYXkgb2YgdG9rZW5zIGl0IGNvbnRhaW5zLiBEb2luZyB0aGlzIGFoZWFkIG9mIHRpbWUgYXZvaWRzIHRoZSBuZWVkIHRvXG4gKiBwYXJzZSB0ZW1wbGF0ZXMgb24gdGhlIGZseSBhcyB0aGV5IGFyZSByZW5kZXJlZC5cbiAqL1xubXVzdGFjaGUucGFyc2UgPSBmdW5jdGlvbiBwYXJzZSAodGVtcGxhdGUsIHRhZ3MpIHtcbiAgcmV0dXJuIGRlZmF1bHRXcml0ZXIucGFyc2UodGVtcGxhdGUsIHRhZ3MpO1xufTtcblxuLyoqXG4gKiBSZW5kZXJzIHRoZSBgdGVtcGxhdGVgIHdpdGggdGhlIGdpdmVuIGB2aWV3YCwgYHBhcnRpYWxzYCwgYW5kIGBjb25maWdgXG4gKiB1c2luZyB0aGUgZGVmYXVsdCB3cml0ZXIuXG4gKi9cbm11c3RhY2hlLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzLCBjb25maWcpIHtcbiAgaWYgKHR5cGVvZiB0ZW1wbGF0ZSAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRlbXBsYXRlISBUZW1wbGF0ZSBzaG91bGQgYmUgYSBcInN0cmluZ1wiICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2J1dCBcIicgKyB0eXBlU3RyKHRlbXBsYXRlKSArICdcIiB3YXMgZ2l2ZW4gYXMgdGhlIGZpcnN0ICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2FyZ3VtZW50IGZvciBtdXN0YWNoZSNyZW5kZXIodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKScpO1xuICB9XG5cbiAgcmV0dXJuIGRlZmF1bHRXcml0ZXIucmVuZGVyKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscywgY29uZmlnKTtcbn07XG5cbi8vIEV4cG9ydCB0aGUgZXNjYXBpbmcgZnVuY3Rpb24gc28gdGhhdCB0aGUgdXNlciBtYXkgb3ZlcnJpZGUgaXQuXG4vLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2phbmwvbXVzdGFjaGUuanMvaXNzdWVzLzI0NFxubXVzdGFjaGUuZXNjYXBlID0gZXNjYXBlSHRtbDtcblxuLy8gRXhwb3J0IHRoZXNlIG1haW5seSBmb3IgdGVzdGluZywgYnV0IGFsc28gZm9yIGFkdmFuY2VkIHVzYWdlLlxubXVzdGFjaGUuU2Nhbm5lciA9IFNjYW5uZXI7XG5tdXN0YWNoZS5Db250ZXh0ID0gQ29udGV4dDtcbm11c3RhY2hlLldyaXRlciA9IFdyaXRlcjtcblxuZXhwb3J0IGRlZmF1bHQgbXVzdGFjaGU7XG4iLCAiaW1wb3J0IE11c3RhY2hlIGZyb20gJ211c3RhY2hlJztcbmltcG9ydCB7IEVkaXRvciB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNvbnN0IFRFTVBMQVRFX1ZBUklBQkxFUyA9IGB7e3ByZV9jdXJzb3J9fVxcbnt7cG9zdF9jdXJzb3J9fSBcXG57e2FjdGl2ZV9zZW50ZW5jZX19IFxcbnt7bGFzdF9saW5lfX1gO1xuXG5pbnRlcmZhY2UgVGVtcGxhdGVBcmdzIHtcbiAgICBwcmVfY3Vyc29yOiBzdHJpbmc7XG4gICAgcG9zdF9jdXJzb3I6IHN0cmluZztcbiAgICBhY3RpdmVfc2VudGVuY2U6IHN0cmluZztcbiAgICBsYXN0X2xpbmU6IHN0cmluZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkUHJvbXB0KHRlbXBsYXRlOiBzdHJpbmcsIGFyZ3M6IFRlbXBsYXRlQXJncyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIE11c3RhY2hlLnJlbmRlcih0ZW1wbGF0ZSwgYXJncyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcmVwYXJlUHJvbXB0KGVkaXRvcjogRWRpdG9yLCB0ZW1wbGF0ZTogc3RyaW5nID0gVEVNUExBVEVfVkFSSUFCTEVTKTogc3RyaW5nIHtcbiAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgY29uc3QgcHJlQ3Vyc29yID0gZWRpdG9yLmdldFJhbmdlKHsgbGluZTogMCwgY2g6IDAgfSwgY3Vyc29yKTtcbiAgICBjb25zdCBwb3N0Q3Vyc29yID0gZWRpdG9yLmdldFJhbmdlKGN1cnNvciwgeyBsaW5lOiBlZGl0b3IubGFzdExpbmUoKSwgY2g6IGVkaXRvci5nZXRMaW5lKGVkaXRvci5sYXN0TGluZSgpKS5sZW5ndGggfSk7XG4gICAgY29uc3QgYWN0aXZlU2VudGVuY2UgPSBzZW50ZW5jZUF0Q3Vyc29yKGVkaXRvcik7XG4gICAgY29uc3QgbGFzdExpbmUgPSBlZGl0b3IuZ2V0TGluZShlZGl0b3IubGFzdExpbmUoKSk7XG5cbiAgICByZXR1cm4gYnVpbGRQcm9tcHQodGVtcGxhdGUsIHtcbiAgICAgICAgcHJlX2N1cnNvcjogcHJlQ3Vyc29yLFxuICAgICAgICBwb3N0X2N1cnNvcjogcG9zdEN1cnNvcixcbiAgICAgICAgYWN0aXZlX3NlbnRlbmNlOiBhY3RpdmVTZW50ZW5jZSxcbiAgICAgICAgbGFzdF9saW5lOiBsYXN0TGluZVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBzZW50ZW5jZUF0Q3Vyc29yKGVkaXRvcjogRWRpdG9yKTogc3RyaW5nIHtcbiAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgbGV0IGN1cnJlbnRMaW5lID0gY3Vyc29yLmxpbmU7XG4gICAgbGV0IHNlbnRlbmNlTGluZXMgPSBbZWRpdG9yLmdldExpbmUoY3VycmVudExpbmUpXTtcblxuICAgIC8vIFNlYXJjaCBiYWNrd2FyZHMgdW50aWwgc2VudGVuY2Ugc3RhcnQgZm91bmRcbiAgICB3aGlsZSAoY3VycmVudExpbmUgPiAwKSB7XG4gICAgICAgIGN1cnJlbnRMaW5lLS07XG4gICAgICAgIGNvbnN0IGxpbmUgPSBlZGl0b3IuZ2V0TGluZShjdXJyZW50TGluZSk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgcHJldmlvdXMgbGluZSBlbmRzIHdpdGggc2VudGVuY2UgZW5kaW5nXG4gICAgICAgIGlmICgvWy4hP11cXHMqJC8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBzZW50ZW5jZUxpbmVzLnVuc2hpZnQobGluZSk7XG4gICAgfVxuXG4gICAgLy8gSm9pbiBsaW5lcyBhbmQgY2xlYW4gdXAgd2hpdGVzcGFjZVxuICAgIHJldHVybiBzZW50ZW5jZUxpbmVzXG4gICAgICAgIC5qb2luKCcgJylcbiAgICAgICAgLnJlcGxhY2UoL1xccysvZywgJyAnKVxuICAgICAgICAudHJpbSgpO1xufSIsICJpbXBvcnQgeyBBcHAsIEJ1dHRvbkNvbXBvbmVudCwgTW9kYWwsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBQcm92aWRlclR5cGUgfSBmcm9tICdzcmMvcHJvdmlkZXJzJztcbmltcG9ydCBJbnNjcmliZSBmcm9tICdzcmMvbWFpbic7XG5cbmV4cG9ydCBjbGFzcyBQcm92aWRlclNldHRpbmdzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcGx1Z2luOiBJbnNjcmliZTtcbiAgICBwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEluc2NyaWJlLCBwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5wcm92aWRlclR5cGUgPSBwcm92aWRlclR5cGU7XG4gICAgICAgIHRoaXMubW9kYWxFbC5hZGRDbGFzcygnaW5zY3JpYmUtcHJvdmlkZXItc2V0dGluZ3MtbW9kYWwnKTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgICAgICBzd2l0Y2ggKHRoaXMucHJvdmlkZXJUeXBlKSB7XG4gICAgICAgICAgICBjYXNlIFByb3ZpZGVyVHlwZS5PTExBTUE6XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJPbGxhbWFTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBQcm92aWRlclR5cGUuT1BFTkFJOlxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyT3BlbkFJU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgYXN5bmMgcmVuZGVyT2xsYW1hU2V0dGluZ3MoKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICB0aGlzLnNldFRpdGxlKCdPbGxhbWEgU2V0dGluZ3MnKTtcblxuICAgICAgICBsZXQgaG9zdCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3ZpZGVycy5vbGxhbWEuaG9zdDtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIk9sbGFtYSBIb3N0XCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRoZSBob3N0IG9mIHRoZSBPbGxhbWEgQVBJXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4ge1xuICAgICAgICAgICAgICAgIHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKGhvc3QpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuc2V0VG9vbHRpcChcIlNhdmUgY2hhbmdlc1wiKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PlxuICAgICAgICAgICAgICAgIGJ0blxuICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnU2F2ZScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlcnMub2xsYW1hLmhvc3QgPSBob3N0O1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICBhc3luYyByZW5kZXJPcGVuQUlTZXR0aW5ncygpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2V0VGl0bGUoJ09wZW5BSSBTZXR0aW5ncycpO1xuXG4gICAgICAgIGxldCBhcGlLZXkgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlcnMub3BlbmFpLmFwaUtleTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIk9wZW5BSSBBUEkgS2V5XCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRoZSBBUEkga2V5IGZvciBPcGVuQUlcIilcbiAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoYXBpS2V5KVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcGlLZXkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuc2V0VG9vbHRpcChcIlNhdmUgY2hhbmdlc1wiKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PlxuICAgICAgICAgICAgICAgIGJ0blxuICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnU2F2ZScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlcnMub3BlbmFpLmFwaUtleSA9IGFwaUtleTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgIH1cbn0gIiwgImltcG9ydCBmcywgeyBwcm9taXNlcyB9IGZyb20gJ2ZzJztcbmltcG9ydCB7IHJlc29sdmUgfSBmcm9tICdwYXRoJztcbmltcG9ydCB7IE9sbGFtYSBhcyBPbGxhbWEkMSB9IGZyb20gJy4vYnJvd3Nlci5tanMnO1xuaW1wb3J0ICd3aGF0d2ctZmV0Y2gnO1xuXG5jbGFzcyBPbGxhbWEgZXh0ZW5kcyBPbGxhbWEkMSB7XG4gIGFzeW5jIGVuY29kZUltYWdlKGltYWdlKSB7XG4gICAgaWYgKHR5cGVvZiBpbWFnZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgcmV0dXJuIEJ1ZmZlci5mcm9tKGltYWdlKS50b1N0cmluZyhcImJhc2U2NFwiKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKGltYWdlKSkge1xuICAgICAgICBjb25zdCBmaWxlQnVmZmVyID0gYXdhaXQgcHJvbWlzZXMucmVhZEZpbGUocmVzb2x2ZShpbWFnZSkpO1xuICAgICAgICByZXR1cm4gQnVmZmVyLmZyb20oZmlsZUJ1ZmZlcikudG9TdHJpbmcoXCJiYXNlNjRcIik7XG4gICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgfVxuICAgIHJldHVybiBpbWFnZTtcbiAgfVxuICAvKipcbiAgICogY2hlY2tzIGlmIGEgZmlsZSBleGlzdHNcbiAgICogQHBhcmFtIHBhdGgge3N0cmluZ30gLSBUaGUgcGF0aCB0byB0aGUgZmlsZVxuICAgKiBAcHJpdmF0ZSBAaW50ZXJuYWxcbiAgICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IC0gV2hldGhlciB0aGUgZmlsZSBleGlzdHMgb3Igbm90XG4gICAqL1xuICBhc3luYyBmaWxlRXhpc3RzKHBhdGgpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgcHJvbWlzZXMuYWNjZXNzKHBhdGgpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIGFzeW5jIGNyZWF0ZShyZXF1ZXN0KSB7XG4gICAgaWYgKHJlcXVlc3QuZnJvbSAmJiBhd2FpdCB0aGlzLmZpbGVFeGlzdHMocmVzb2x2ZShyZXF1ZXN0LmZyb20pKSkge1xuICAgICAgdGhyb3cgRXJyb3IoXCJDcmVhdGluZyB3aXRoIGEgbG9jYWwgcGF0aCBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBmcm9tIG9sbGFtYS1qc1wiKTtcbiAgICB9XG4gICAgaWYgKHJlcXVlc3Quc3RyZWFtKSB7XG4gICAgICByZXR1cm4gc3VwZXIuY3JlYXRlKHJlcXVlc3QpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gc3VwZXIuY3JlYXRlKHJlcXVlc3QpO1xuICAgIH1cbiAgfVxufVxuY29uc3QgaW5kZXggPSBuZXcgT2xsYW1hKCk7XG5cbmV4cG9ydCB7IE9sbGFtYSwgaW5kZXggYXMgZGVmYXVsdCB9O1xuIiwgIi8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvdHlwZS1idWlsdGlucyAqL1xudmFyIGcgPVxuICAodHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnICYmIGdsb2JhbFRoaXMpIHx8XG4gICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgJiYgc2VsZikgfHxcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyAmJiBnbG9iYWwpIHx8XG4gIHt9XG5cbnZhciBzdXBwb3J0ID0ge1xuICBzZWFyY2hQYXJhbXM6ICdVUkxTZWFyY2hQYXJhbXMnIGluIGcsXG4gIGl0ZXJhYmxlOiAnU3ltYm9sJyBpbiBnICYmICdpdGVyYXRvcicgaW4gU3ltYm9sLFxuICBibG9iOlxuICAgICdGaWxlUmVhZGVyJyBpbiBnICYmXG4gICAgJ0Jsb2InIGluIGcgJiZcbiAgICAoZnVuY3Rpb24oKSB7XG4gICAgICB0cnkge1xuICAgICAgICBuZXcgQmxvYigpXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgIH0pKCksXG4gIGZvcm1EYXRhOiAnRm9ybURhdGEnIGluIGcsXG4gIGFycmF5QnVmZmVyOiAnQXJyYXlCdWZmZXInIGluIGdcbn1cblxuZnVuY3Rpb24gaXNEYXRhVmlldyhvYmopIHtcbiAgcmV0dXJuIG9iaiAmJiBEYXRhVmlldy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihvYmopXG59XG5cbmlmIChzdXBwb3J0LmFycmF5QnVmZmVyKSB7XG4gIHZhciB2aWV3Q2xhc3NlcyA9IFtcbiAgICAnW29iamVjdCBJbnQ4QXJyYXldJyxcbiAgICAnW29iamVjdCBVaW50OEFycmF5XScsXG4gICAgJ1tvYmplY3QgVWludDhDbGFtcGVkQXJyYXldJyxcbiAgICAnW29iamVjdCBJbnQxNkFycmF5XScsXG4gICAgJ1tvYmplY3QgVWludDE2QXJyYXldJyxcbiAgICAnW29iamVjdCBJbnQzMkFycmF5XScsXG4gICAgJ1tvYmplY3QgVWludDMyQXJyYXldJyxcbiAgICAnW29iamVjdCBGbG9hdDMyQXJyYXldJyxcbiAgICAnW29iamVjdCBGbG9hdDY0QXJyYXldJ1xuICBdXG5cbiAgdmFyIGlzQXJyYXlCdWZmZXJWaWV3ID1cbiAgICBBcnJheUJ1ZmZlci5pc1ZpZXcgfHxcbiAgICBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiBvYmogJiYgdmlld0NsYXNzZXMuaW5kZXhPZihPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSkgPiAtMVxuICAgIH1cbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplTmFtZShuYW1lKSB7XG4gIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICBuYW1lID0gU3RyaW5nKG5hbWUpXG4gIH1cbiAgaWYgKC9bXmEtejAtOVxcLSMkJSYnKisuXl9gfH4hXS9pLnRlc3QobmFtZSkgfHwgbmFtZSA9PT0gJycpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGNoYXJhY3RlciBpbiBoZWFkZXIgZmllbGQgbmFtZTogXCInICsgbmFtZSArICdcIicpXG4gIH1cbiAgcmV0dXJuIG5hbWUudG9Mb3dlckNhc2UoKVxufVxuXG5mdW5jdGlvbiBub3JtYWxpemVWYWx1ZSh2YWx1ZSkge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgIHZhbHVlID0gU3RyaW5nKHZhbHVlKVxuICB9XG4gIHJldHVybiB2YWx1ZVxufVxuXG4vLyBCdWlsZCBhIGRlc3RydWN0aXZlIGl0ZXJhdG9yIGZvciB0aGUgdmFsdWUgbGlzdFxuZnVuY3Rpb24gaXRlcmF0b3JGb3IoaXRlbXMpIHtcbiAgdmFyIGl0ZXJhdG9yID0ge1xuICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHZhbHVlID0gaXRlbXMuc2hpZnQoKVxuICAgICAgcmV0dXJuIHtkb25lOiB2YWx1ZSA9PT0gdW5kZWZpbmVkLCB2YWx1ZTogdmFsdWV9XG4gICAgfVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgICBpdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXRlcmF0b3JcbiAgICB9XG4gIH1cblxuICByZXR1cm4gaXRlcmF0b3Jcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIEhlYWRlcnMoaGVhZGVycykge1xuICB0aGlzLm1hcCA9IHt9XG5cbiAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICB0aGlzLmFwcGVuZChuYW1lLCB2YWx1ZSlcbiAgICB9LCB0aGlzKVxuICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaGVhZGVycykpIHtcbiAgICBoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24oaGVhZGVyKSB7XG4gICAgICBpZiAoaGVhZGVyLmxlbmd0aCAhPSAyKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0hlYWRlcnMgY29uc3RydWN0b3I6IGV4cGVjdGVkIG5hbWUvdmFsdWUgcGFpciB0byBiZSBsZW5ndGggMiwgZm91bmQnICsgaGVhZGVyLmxlbmd0aClcbiAgICAgIH1cbiAgICAgIHRoaXMuYXBwZW5kKGhlYWRlclswXSwgaGVhZGVyWzFdKVxuICAgIH0sIHRoaXMpXG4gIH0gZWxzZSBpZiAoaGVhZGVycykge1xuICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGhlYWRlcnMpLmZvckVhY2goZnVuY3Rpb24obmFtZSkge1xuICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSlcbiAgICB9LCB0aGlzKVxuICB9XG59XG5cbkhlYWRlcnMucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gIG5hbWUgPSBub3JtYWxpemVOYW1lKG5hbWUpXG4gIHZhbHVlID0gbm9ybWFsaXplVmFsdWUodmFsdWUpXG4gIHZhciBvbGRWYWx1ZSA9IHRoaXMubWFwW25hbWVdXG4gIHRoaXMubWFwW25hbWVdID0gb2xkVmFsdWUgPyBvbGRWYWx1ZSArICcsICcgKyB2YWx1ZSA6IHZhbHVlXG59XG5cbkhlYWRlcnMucHJvdG90eXBlWydkZWxldGUnXSA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgZGVsZXRlIHRoaXMubWFwW25vcm1hbGl6ZU5hbWUobmFtZSldXG59XG5cbkhlYWRlcnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgbmFtZSA9IG5vcm1hbGl6ZU5hbWUobmFtZSlcbiAgcmV0dXJuIHRoaXMuaGFzKG5hbWUpID8gdGhpcy5tYXBbbmFtZV0gOiBudWxsXG59XG5cbkhlYWRlcnMucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgcmV0dXJuIHRoaXMubWFwLmhhc093blByb3BlcnR5KG5vcm1hbGl6ZU5hbWUobmFtZSkpXG59XG5cbkhlYWRlcnMucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gIHRoaXMubWFwW25vcm1hbGl6ZU5hbWUobmFtZSldID0gbm9ybWFsaXplVmFsdWUodmFsdWUpXG59XG5cbkhlYWRlcnMucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbihjYWxsYmFjaywgdGhpc0FyZykge1xuICBmb3IgKHZhciBuYW1lIGluIHRoaXMubWFwKSB7XG4gICAgaWYgKHRoaXMubWFwLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIHRoaXMubWFwW25hbWVdLCBuYW1lLCB0aGlzKVxuICAgIH1cbiAgfVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5rZXlzID0gZnVuY3Rpb24oKSB7XG4gIHZhciBpdGVtcyA9IFtdXG4gIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgIGl0ZW1zLnB1c2gobmFtZSlcbiAgfSlcbiAgcmV0dXJuIGl0ZXJhdG9yRm9yKGl0ZW1zKVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS52YWx1ZXMgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGl0ZW1zID0gW11cbiAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgaXRlbXMucHVzaCh2YWx1ZSlcbiAgfSlcbiAgcmV0dXJuIGl0ZXJhdG9yRm9yKGl0ZW1zKVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5lbnRyaWVzID0gZnVuY3Rpb24oKSB7XG4gIHZhciBpdGVtcyA9IFtdXG4gIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgIGl0ZW1zLnB1c2goW25hbWUsIHZhbHVlXSlcbiAgfSlcbiAgcmV0dXJuIGl0ZXJhdG9yRm9yKGl0ZW1zKVxufVxuXG5pZiAoc3VwcG9ydC5pdGVyYWJsZSkge1xuICBIZWFkZXJzLnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdID0gSGVhZGVycy5wcm90b3R5cGUuZW50cmllc1xufVxuXG5mdW5jdGlvbiBjb25zdW1lZChib2R5KSB7XG4gIGlmIChib2R5Ll9ub0JvZHkpIHJldHVyblxuICBpZiAoYm9keS5ib2R5VXNlZCkge1xuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgVHlwZUVycm9yKCdBbHJlYWR5IHJlYWQnKSlcbiAgfVxuICBib2R5LmJvZHlVc2VkID0gdHJ1ZVxufVxuXG5mdW5jdGlvbiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXNvbHZlKHJlYWRlci5yZXN1bHQpXG4gICAgfVxuICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICByZWplY3QocmVhZGVyLmVycm9yKVxuICAgIH1cbiAgfSlcbn1cblxuZnVuY3Rpb24gcmVhZEJsb2JBc0FycmF5QnVmZmVyKGJsb2IpIHtcbiAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgdmFyIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoYmxvYilcbiAgcmV0dXJuIHByb21pc2Vcbn1cblxuZnVuY3Rpb24gcmVhZEJsb2JBc1RleHQoYmxvYikge1xuICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxuICB2YXIgcHJvbWlzZSA9IGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gIHZhciBtYXRjaCA9IC9jaGFyc2V0PShbQS1aYS16MC05Xy1dKykvLmV4ZWMoYmxvYi50eXBlKVxuICB2YXIgZW5jb2RpbmcgPSBtYXRjaCA/IG1hdGNoWzFdIDogJ3V0Zi04J1xuICByZWFkZXIucmVhZEFzVGV4dChibG9iLCBlbmNvZGluZylcbiAgcmV0dXJuIHByb21pc2Vcbn1cblxuZnVuY3Rpb24gcmVhZEFycmF5QnVmZmVyQXNUZXh0KGJ1Zikge1xuICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1ZilcbiAgdmFyIGNoYXJzID0gbmV3IEFycmF5KHZpZXcubGVuZ3RoKVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdmlldy5sZW5ndGg7IGkrKykge1xuICAgIGNoYXJzW2ldID0gU3RyaW5nLmZyb21DaGFyQ29kZSh2aWV3W2ldKVxuICB9XG4gIHJldHVybiBjaGFycy5qb2luKCcnKVxufVxuXG5mdW5jdGlvbiBidWZmZXJDbG9uZShidWYpIHtcbiAgaWYgKGJ1Zi5zbGljZSkge1xuICAgIHJldHVybiBidWYuc2xpY2UoMClcbiAgfSBlbHNlIHtcbiAgICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1Zi5ieXRlTGVuZ3RoKVxuICAgIHZpZXcuc2V0KG5ldyBVaW50OEFycmF5KGJ1ZikpXG4gICAgcmV0dXJuIHZpZXcuYnVmZmVyXG4gIH1cbn1cblxuZnVuY3Rpb24gQm9keSgpIHtcbiAgdGhpcy5ib2R5VXNlZCA9IGZhbHNlXG5cbiAgdGhpcy5faW5pdEJvZHkgPSBmdW5jdGlvbihib2R5KSB7XG4gICAgLypcbiAgICAgIGZldGNoLW1vY2sgd3JhcHMgdGhlIFJlc3BvbnNlIG9iamVjdCBpbiBhbiBFUzYgUHJveHkgdG9cbiAgICAgIHByb3ZpZGUgdXNlZnVsIHRlc3QgaGFybmVzcyBmZWF0dXJlcyBzdWNoIGFzIGZsdXNoLiBIb3dldmVyLCBvblxuICAgICAgRVM1IGJyb3dzZXJzIHdpdGhvdXQgZmV0Y2ggb3IgUHJveHkgc3VwcG9ydCBwb2xseWZpbGxzIG11c3QgYmUgdXNlZDtcbiAgICAgIHRoZSBwcm94eS1wb2xseWZpbGwgaXMgdW5hYmxlIHRvIHByb3h5IGFuIGF0dHJpYnV0ZSB1bmxlc3MgaXQgZXhpc3RzXG4gICAgICBvbiB0aGUgb2JqZWN0IGJlZm9yZSB0aGUgUHJveHkgaXMgY3JlYXRlZC4gVGhpcyBjaGFuZ2UgZW5zdXJlc1xuICAgICAgUmVzcG9uc2UuYm9keVVzZWQgZXhpc3RzIG9uIHRoZSBpbnN0YW5jZSwgd2hpbGUgbWFpbnRhaW5pbmcgdGhlXG4gICAgICBzZW1hbnRpYyBvZiBzZXR0aW5nIFJlcXVlc3QuYm9keVVzZWQgaW4gdGhlIGNvbnN0cnVjdG9yIGJlZm9yZVxuICAgICAgX2luaXRCb2R5IGlzIGNhbGxlZC5cbiAgICAqL1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zZWxmLWFzc2lnblxuICAgIHRoaXMuYm9keVVzZWQgPSB0aGlzLmJvZHlVc2VkXG4gICAgdGhpcy5fYm9keUluaXQgPSBib2R5XG4gICAgaWYgKCFib2R5KSB7XG4gICAgICB0aGlzLl9ub0JvZHkgPSB0cnVlO1xuICAgICAgdGhpcy5fYm9keVRleHQgPSAnJ1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHlcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYmxvYiAmJiBCbG9iLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICB0aGlzLl9ib2R5QmxvYiA9IGJvZHlcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuZm9ybURhdGEgJiYgRm9ybURhdGEucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkpIHtcbiAgICAgIHRoaXMuX2JvZHlGb3JtRGF0YSA9IGJvZHlcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5LnRvU3RyaW5nKClcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYXJyYXlCdWZmZXIgJiYgc3VwcG9ydC5ibG9iICYmIGlzRGF0YVZpZXcoYm9keSkpIHtcbiAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkuYnVmZmVyKVxuICAgICAgLy8gSUUgMTAtMTEgY2FuJ3QgaGFuZGxlIGEgRGF0YVZpZXcgYm9keS5cbiAgICAgIHRoaXMuX2JvZHlJbml0ID0gbmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pXG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIChBcnJheUJ1ZmZlci5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSB8fCBpc0FycmF5QnVmZmVyVmlldyhib2R5KSkpIHtcbiAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChib2R5KVxuICAgIH1cblxuICAgIGlmICghdGhpcy5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykpIHtcbiAgICAgIGlmICh0eXBlb2YgYm9keSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzLnNldCgnY29udGVudC10eXBlJywgJ3RleHQvcGxhaW47Y2hhcnNldD1VVEYtOCcpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlCbG9iICYmIHRoaXMuX2JvZHlCbG9iLnR5cGUpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzLnNldCgnY29udGVudC10eXBlJywgdGhpcy5fYm9keUJsb2IudHlwZSlcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5zZWFyY2hQYXJhbXMgJiYgVVJMU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCcpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuYmxvYikge1xuICAgIHRoaXMuYmxvYiA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUJsb2IpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKSlcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUZvcm1EYXRhKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyBibG9iJylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlUZXh0XSkpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdGhpcy5hcnJheUJ1ZmZlciA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpIHtcbiAgICAgIHZhciBpc0NvbnN1bWVkID0gY29uc3VtZWQodGhpcylcbiAgICAgIGlmIChpc0NvbnN1bWVkKSB7XG4gICAgICAgIHJldHVybiBpc0NvbnN1bWVkXG4gICAgICB9IGVsc2UgaWYgKEFycmF5QnVmZmVyLmlzVmlldyh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoXG4gICAgICAgICAgdGhpcy5fYm9keUFycmF5QnVmZmVyLmJ1ZmZlci5zbGljZShcbiAgICAgICAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlci5ieXRlT2Zmc2V0LFxuICAgICAgICAgICAgdGhpcy5fYm9keUFycmF5QnVmZmVyLmJ5dGVPZmZzZXQgKyB0aGlzLl9ib2R5QXJyYXlCdWZmZXIuYnl0ZUxlbmd0aFxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpXG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LmJsb2IpIHtcbiAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgcmVhZCBhcyBBcnJheUJ1ZmZlcicpXG4gICAgfVxuICB9XG5cbiAgdGhpcy50ZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICBpZiAocmVqZWN0ZWQpIHtcbiAgICAgIHJldHVybiByZWplY3RlZFxuICAgIH1cblxuICAgIGlmICh0aGlzLl9ib2R5QmxvYikge1xuICAgICAgcmV0dXJuIHJlYWRCbG9iQXNUZXh0KHRoaXMuX2JvZHlCbG9iKVxuICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlYWRBcnJheUJ1ZmZlckFzVGV4dCh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpKVxuICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUZvcm1EYXRhKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgdGV4dCcpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keVRleHQpXG4gICAgfVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuZm9ybURhdGEpIHtcbiAgICB0aGlzLmZvcm1EYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihkZWNvZGUpXG4gICAgfVxuICB9XG5cbiAgdGhpcy5qc29uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMudGV4dCgpLnRoZW4oSlNPTi5wYXJzZSlcbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8vIEhUVFAgbWV0aG9kcyB3aG9zZSBjYXBpdGFsaXphdGlvbiBzaG91bGQgYmUgbm9ybWFsaXplZFxudmFyIG1ldGhvZHMgPSBbJ0NPTk5FQ1QnLCAnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUEFUQ0gnLCAnUE9TVCcsICdQVVQnLCAnVFJBQ0UnXVxuXG5mdW5jdGlvbiBub3JtYWxpemVNZXRob2QobWV0aG9kKSB7XG4gIHZhciB1cGNhc2VkID0gbWV0aG9kLnRvVXBwZXJDYXNlKClcbiAgcmV0dXJuIG1ldGhvZHMuaW5kZXhPZih1cGNhc2VkKSA+IC0xID8gdXBjYXNlZCA6IG1ldGhvZFxufVxuXG5leHBvcnQgZnVuY3Rpb24gUmVxdWVzdChpbnB1dCwgb3B0aW9ucykge1xuICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUmVxdWVzdCkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdQbGVhc2UgdXNlIHRoZSBcIm5ld1wiIG9wZXJhdG9yLCB0aGlzIERPTSBvYmplY3QgY29uc3RydWN0b3IgY2Fubm90IGJlIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLicpXG4gIH1cblxuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuICB2YXIgYm9keSA9IG9wdGlvbnMuYm9keVxuXG4gIGlmIChpbnB1dCBpbnN0YW5jZW9mIFJlcXVlc3QpIHtcbiAgICBpZiAoaW5wdXQuYm9keVVzZWQpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FscmVhZHkgcmVhZCcpXG4gICAgfVxuICAgIHRoaXMudXJsID0gaW5wdXQudXJsXG4gICAgdGhpcy5jcmVkZW50aWFscyA9IGlucHV0LmNyZWRlbnRpYWxzXG4gICAgaWYgKCFvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKGlucHV0LmhlYWRlcnMpXG4gICAgfVxuICAgIHRoaXMubWV0aG9kID0gaW5wdXQubWV0aG9kXG4gICAgdGhpcy5tb2RlID0gaW5wdXQubW9kZVxuICAgIHRoaXMuc2lnbmFsID0gaW5wdXQuc2lnbmFsXG4gICAgaWYgKCFib2R5ICYmIGlucHV0Ll9ib2R5SW5pdCAhPSBudWxsKSB7XG4gICAgICBib2R5ID0gaW5wdXQuX2JvZHlJbml0XG4gICAgICBpbnB1dC5ib2R5VXNlZCA9IHRydWVcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhpcy51cmwgPSBTdHJpbmcoaW5wdXQpXG4gIH1cblxuICB0aGlzLmNyZWRlbnRpYWxzID0gb3B0aW9ucy5jcmVkZW50aWFscyB8fCB0aGlzLmNyZWRlbnRpYWxzIHx8ICdzYW1lLW9yaWdpbidcbiAgaWYgKG9wdGlvbnMuaGVhZGVycyB8fCAhdGhpcy5oZWFkZXJzKSB7XG4gICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICB9XG4gIHRoaXMubWV0aG9kID0gbm9ybWFsaXplTWV0aG9kKG9wdGlvbnMubWV0aG9kIHx8IHRoaXMubWV0aG9kIHx8ICdHRVQnKVxuICB0aGlzLm1vZGUgPSBvcHRpb25zLm1vZGUgfHwgdGhpcy5tb2RlIHx8IG51bGxcbiAgdGhpcy5zaWduYWwgPSBvcHRpb25zLnNpZ25hbCB8fCB0aGlzLnNpZ25hbCB8fCAoZnVuY3Rpb24gKCkge1xuICAgIGlmICgnQWJvcnRDb250cm9sbGVyJyBpbiBnKSB7XG4gICAgICB2YXIgY3RybCA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgIHJldHVybiBjdHJsLnNpZ25hbDtcbiAgICB9XG4gIH0oKSk7XG4gIHRoaXMucmVmZXJyZXIgPSBudWxsXG5cbiAgaWYgKCh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykgJiYgYm9keSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0JvZHkgbm90IGFsbG93ZWQgZm9yIEdFVCBvciBIRUFEIHJlcXVlc3RzJylcbiAgfVxuICB0aGlzLl9pbml0Qm9keShib2R5KVxuXG4gIGlmICh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykge1xuICAgIGlmIChvcHRpb25zLmNhY2hlID09PSAnbm8tc3RvcmUnIHx8IG9wdGlvbnMuY2FjaGUgPT09ICduby1jYWNoZScpIHtcbiAgICAgIC8vIFNlYXJjaCBmb3IgYSAnXycgcGFyYW1ldGVyIGluIHRoZSBxdWVyeSBzdHJpbmdcbiAgICAgIHZhciByZVBhcmFtU2VhcmNoID0gLyhbPyZdKV89W14mXSovXG4gICAgICBpZiAocmVQYXJhbVNlYXJjaC50ZXN0KHRoaXMudXJsKSkge1xuICAgICAgICAvLyBJZiBpdCBhbHJlYWR5IGV4aXN0cyB0aGVuIHNldCB0aGUgdmFsdWUgd2l0aCB0aGUgY3VycmVudCB0aW1lXG4gICAgICAgIHRoaXMudXJsID0gdGhpcy51cmwucmVwbGFjZShyZVBhcmFtU2VhcmNoLCAnJDFfPScgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE90aGVyd2lzZSBhZGQgYSBuZXcgJ18nIHBhcmFtZXRlciB0byB0aGUgZW5kIHdpdGggdGhlIGN1cnJlbnQgdGltZVxuICAgICAgICB2YXIgcmVRdWVyeVN0cmluZyA9IC9cXD8vXG4gICAgICAgIHRoaXMudXJsICs9IChyZVF1ZXJ5U3RyaW5nLnRlc3QodGhpcy51cmwpID8gJyYnIDogJz8nKSArICdfPScgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5SZXF1ZXN0LnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFJlcXVlc3QodGhpcywge2JvZHk6IHRoaXMuX2JvZHlJbml0fSlcbn1cblxuZnVuY3Rpb24gZGVjb2RlKGJvZHkpIHtcbiAgdmFyIGZvcm0gPSBuZXcgRm9ybURhdGEoKVxuICBib2R5XG4gICAgLnRyaW0oKVxuICAgIC5zcGxpdCgnJicpXG4gICAgLmZvckVhY2goZnVuY3Rpb24oYnl0ZXMpIHtcbiAgICAgIGlmIChieXRlcykge1xuICAgICAgICB2YXIgc3BsaXQgPSBieXRlcy5zcGxpdCgnPScpXG4gICAgICAgIHZhciBuYW1lID0gc3BsaXQuc2hpZnQoKS5yZXBsYWNlKC9cXCsvZywgJyAnKVxuICAgICAgICB2YXIgdmFsdWUgPSBzcGxpdC5qb2luKCc9JykucmVwbGFjZSgvXFwrL2csICcgJylcbiAgICAgICAgZm9ybS5hcHBlbmQoZGVjb2RlVVJJQ29tcG9uZW50KG5hbWUpLCBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpKVxuICAgICAgfVxuICAgIH0pXG4gIHJldHVybiBmb3JtXG59XG5cbmZ1bmN0aW9uIHBhcnNlSGVhZGVycyhyYXdIZWFkZXJzKSB7XG4gIHZhciBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKVxuICAvLyBSZXBsYWNlIGluc3RhbmNlcyBvZiBcXHJcXG4gYW5kIFxcbiBmb2xsb3dlZCBieSBhdCBsZWFzdCBvbmUgc3BhY2Ugb3IgaG9yaXpvbnRhbCB0YWIgd2l0aCBhIHNwYWNlXG4gIC8vIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM3MjMwI3NlY3Rpb24tMy4yXG4gIHZhciBwcmVQcm9jZXNzZWRIZWFkZXJzID0gcmF3SGVhZGVycy5yZXBsYWNlKC9cXHI/XFxuW1xcdCBdKy9nLCAnICcpXG4gIC8vIEF2b2lkaW5nIHNwbGl0IHZpYSByZWdleCB0byB3b3JrIGFyb3VuZCBhIGNvbW1vbiBJRTExIGJ1ZyB3aXRoIHRoZSBjb3JlLWpzIDMuNi4wIHJlZ2V4IHBvbHlmaWxsXG4gIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9naXRodWIvZmV0Y2gvaXNzdWVzLzc0OFxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvNzUxXG4gIHByZVByb2Nlc3NlZEhlYWRlcnNcbiAgICAuc3BsaXQoJ1xccicpXG4gICAgLm1hcChmdW5jdGlvbihoZWFkZXIpIHtcbiAgICAgIHJldHVybiBoZWFkZXIuaW5kZXhPZignXFxuJykgPT09IDAgPyBoZWFkZXIuc3Vic3RyKDEsIGhlYWRlci5sZW5ndGgpIDogaGVhZGVyXG4gICAgfSlcbiAgICAuZm9yRWFjaChmdW5jdGlvbihsaW5lKSB7XG4gICAgICB2YXIgcGFydHMgPSBsaW5lLnNwbGl0KCc6JylcbiAgICAgIHZhciBrZXkgPSBwYXJ0cy5zaGlmdCgpLnRyaW0oKVxuICAgICAgaWYgKGtleSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBwYXJ0cy5qb2luKCc6JykudHJpbSgpXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaGVhZGVycy5hcHBlbmQoa2V5LCB2YWx1ZSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ1Jlc3BvbnNlICcgKyBlcnJvci5tZXNzYWdlKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgcmV0dXJuIGhlYWRlcnNcbn1cblxuQm9keS5jYWxsKFJlcXVlc3QucHJvdG90eXBlKVxuXG5leHBvcnQgZnVuY3Rpb24gUmVzcG9uc2UoYm9keUluaXQsIG9wdGlvbnMpIHtcbiAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFJlc3BvbnNlKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1BsZWFzZSB1c2UgdGhlIFwibmV3XCIgb3BlcmF0b3IsIHRoaXMgRE9NIG9iamVjdCBjb25zdHJ1Y3RvciBjYW5ub3QgYmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24uJylcbiAgfVxuICBpZiAoIW9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0ge31cbiAgfVxuXG4gIHRoaXMudHlwZSA9ICdkZWZhdWx0J1xuICB0aGlzLnN0YXR1cyA9IG9wdGlvbnMuc3RhdHVzID09PSB1bmRlZmluZWQgPyAyMDAgOiBvcHRpb25zLnN0YXR1c1xuICBpZiAodGhpcy5zdGF0dXMgPCAyMDAgfHwgdGhpcy5zdGF0dXMgPiA1OTkpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkZhaWxlZCB0byBjb25zdHJ1Y3QgJ1Jlc3BvbnNlJzogVGhlIHN0YXR1cyBwcm92aWRlZCAoMCkgaXMgb3V0c2lkZSB0aGUgcmFuZ2UgWzIwMCwgNTk5XS5cIilcbiAgfVxuICB0aGlzLm9rID0gdGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwXG4gIHRoaXMuc3RhdHVzVGV4dCA9IG9wdGlvbnMuc3RhdHVzVGV4dCA9PT0gdW5kZWZpbmVkID8gJycgOiAnJyArIG9wdGlvbnMuc3RhdHVzVGV4dFxuICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpXG4gIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJydcbiAgdGhpcy5faW5pdEJvZHkoYm9keUluaXQpXG59XG5cbkJvZHkuY2FsbChSZXNwb25zZS5wcm90b3R5cGUpXG5cblJlc3BvbnNlLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFJlc3BvbnNlKHRoaXMuX2JvZHlJbml0LCB7XG4gICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcbiAgICBzdGF0dXNUZXh0OiB0aGlzLnN0YXR1c1RleHQsXG4gICAgaGVhZGVyczogbmV3IEhlYWRlcnModGhpcy5oZWFkZXJzKSxcbiAgICB1cmw6IHRoaXMudXJsXG4gIH0pXG59XG5cblJlc3BvbnNlLmVycm9yID0gZnVuY3Rpb24oKSB7XG4gIHZhciByZXNwb25zZSA9IG5ldyBSZXNwb25zZShudWxsLCB7c3RhdHVzOiAyMDAsIHN0YXR1c1RleHQ6ICcnfSlcbiAgcmVzcG9uc2Uub2sgPSBmYWxzZVxuICByZXNwb25zZS5zdGF0dXMgPSAwXG4gIHJlc3BvbnNlLnR5cGUgPSAnZXJyb3InXG4gIHJldHVybiByZXNwb25zZVxufVxuXG52YXIgcmVkaXJlY3RTdGF0dXNlcyA9IFszMDEsIDMwMiwgMzAzLCAzMDcsIDMwOF1cblxuUmVzcG9uc2UucmVkaXJlY3QgPSBmdW5jdGlvbih1cmwsIHN0YXR1cykge1xuICBpZiAocmVkaXJlY3RTdGF0dXNlcy5pbmRleE9mKHN0YXR1cykgPT09IC0xKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgc3RhdHVzIGNvZGUnKVxuICB9XG5cbiAgcmV0dXJuIG5ldyBSZXNwb25zZShudWxsLCB7c3RhdHVzOiBzdGF0dXMsIGhlYWRlcnM6IHtsb2NhdGlvbjogdXJsfX0pXG59XG5cbmV4cG9ydCB2YXIgRE9NRXhjZXB0aW9uID0gZy5ET01FeGNlcHRpb25cbnRyeSB7XG4gIG5ldyBET01FeGNlcHRpb24oKVxufSBjYXRjaCAoZXJyKSB7XG4gIERPTUV4Y2VwdGlvbiA9IGZ1bmN0aW9uKG1lc3NhZ2UsIG5hbWUpIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlXG4gICAgdGhpcy5uYW1lID0gbmFtZVxuICAgIHZhciBlcnJvciA9IEVycm9yKG1lc3NhZ2UpXG4gICAgdGhpcy5zdGFjayA9IGVycm9yLnN0YWNrXG4gIH1cbiAgRE9NRXhjZXB0aW9uLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKVxuICBET01FeGNlcHRpb24ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRE9NRXhjZXB0aW9uXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmZXRjaChpbnB1dCwgaW5pdCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIHJlcXVlc3QgPSBuZXcgUmVxdWVzdChpbnB1dCwgaW5pdClcblxuICAgIGlmIChyZXF1ZXN0LnNpZ25hbCAmJiByZXF1ZXN0LnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICByZXR1cm4gcmVqZWN0KG5ldyBET01FeGNlcHRpb24oJ0Fib3J0ZWQnLCAnQWJvcnRFcnJvcicpKVxuICAgIH1cblxuICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKVxuXG4gICAgZnVuY3Rpb24gYWJvcnRYaHIoKSB7XG4gICAgICB4aHIuYWJvcnQoKVxuICAgIH1cblxuICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICBzdGF0dXNUZXh0OiB4aHIuc3RhdHVzVGV4dCxcbiAgICAgICAgaGVhZGVyczogcGFyc2VIZWFkZXJzKHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSB8fCAnJylcbiAgICAgIH1cbiAgICAgIC8vIFRoaXMgY2hlY2sgaWYgc3BlY2lmaWNhbGx5IGZvciB3aGVuIGEgdXNlciBmZXRjaGVzIGEgZmlsZSBsb2NhbGx5IGZyb20gdGhlIGZpbGUgc3lzdGVtXG4gICAgICAvLyBPbmx5IGlmIHRoZSBzdGF0dXMgaXMgb3V0IG9mIGEgbm9ybWFsIHJhbmdlXG4gICAgICBpZiAocmVxdWVzdC51cmwuaW5kZXhPZignZmlsZTovLycpID09PSAwICYmICh4aHIuc3RhdHVzIDwgMjAwIHx8IHhoci5zdGF0dXMgPiA1OTkpKSB7XG4gICAgICAgIG9wdGlvbnMuc3RhdHVzID0gMjAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3B0aW9ucy5zdGF0dXMgPSB4aHIuc3RhdHVzO1xuICAgICAgfVxuICAgICAgb3B0aW9ucy51cmwgPSAncmVzcG9uc2VVUkwnIGluIHhociA/IHhoci5yZXNwb25zZVVSTCA6IG9wdGlvbnMuaGVhZGVycy5nZXQoJ1gtUmVxdWVzdC1VUkwnKVxuICAgICAgdmFyIGJvZHkgPSAncmVzcG9uc2UnIGluIHhociA/IHhoci5yZXNwb25zZSA6IHhoci5yZXNwb25zZVRleHRcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc29sdmUobmV3IFJlc3BvbnNlKGJvZHksIG9wdGlvbnMpKVxuICAgICAgfSwgMClcbiAgICB9XG5cbiAgICB4aHIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSlcbiAgICAgIH0sIDApXG4gICAgfVxuXG4gICAgeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCB0aW1lZCBvdXQnKSlcbiAgICAgIH0sIDApXG4gICAgfVxuXG4gICAgeGhyLm9uYWJvcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChuZXcgRE9NRXhjZXB0aW9uKCdBYm9ydGVkJywgJ0Fib3J0RXJyb3InKSlcbiAgICAgIH0sIDApXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZml4VXJsKHVybCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHVybCA9PT0gJycgJiYgZy5sb2NhdGlvbi5ocmVmID8gZy5sb2NhdGlvbi5ocmVmIDogdXJsXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiB1cmxcbiAgICAgIH1cbiAgICB9XG5cbiAgICB4aHIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgZml4VXJsKHJlcXVlc3QudXJsKSwgdHJ1ZSlcblxuICAgIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnaW5jbHVkZScpIHtcbiAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlXG4gICAgfSBlbHNlIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnb21pdCcpIHtcbiAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSBmYWxzZVxuICAgIH1cblxuICAgIGlmICgncmVzcG9uc2VUeXBlJyBpbiB4aHIpIHtcbiAgICAgIGlmIChzdXBwb3J0LmJsb2IpIHtcbiAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdibG9iJ1xuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgc3VwcG9ydC5hcnJheUJ1ZmZlclxuICAgICAgKSB7XG4gICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGluaXQgJiYgdHlwZW9mIGluaXQuaGVhZGVycyA9PT0gJ29iamVjdCcgJiYgIShpbml0LmhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzIHx8IChnLkhlYWRlcnMgJiYgaW5pdC5oZWFkZXJzIGluc3RhbmNlb2YgZy5IZWFkZXJzKSkpIHtcbiAgICAgIHZhciBuYW1lcyA9IFtdO1xuICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoaW5pdC5oZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgbmFtZXMucHVzaChub3JtYWxpemVOYW1lKG5hbWUpKVxuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihuYW1lLCBub3JtYWxpemVWYWx1ZShpbml0LmhlYWRlcnNbbmFtZV0pKVxuICAgICAgfSlcbiAgICAgIHJlcXVlc3QuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICAgIGlmIChuYW1lcy5pbmRleE9mKG5hbWUpID09PSAtMSkge1xuICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICByZXF1ZXN0LmhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihuYW1lLCB2YWx1ZSlcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3Quc2lnbmFsKSB7XG4gICAgICByZXF1ZXN0LnNpZ25hbC5hZGRFdmVudExpc3RlbmVyKCdhYm9ydCcsIGFib3J0WGhyKVxuXG4gICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIERPTkUgKHN1Y2Nlc3Mgb3IgZmFpbHVyZSlcbiAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgICAgcmVxdWVzdC5zaWduYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBhYm9ydFhocilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHhoci5zZW5kKHR5cGVvZiByZXF1ZXN0Ll9ib2R5SW5pdCA9PT0gJ3VuZGVmaW5lZCcgPyBudWxsIDogcmVxdWVzdC5fYm9keUluaXQpXG4gIH0pXG59XG5cbmZldGNoLnBvbHlmaWxsID0gdHJ1ZVxuXG5pZiAoIWcuZmV0Y2gpIHtcbiAgZy5mZXRjaCA9IGZldGNoXG4gIGcuSGVhZGVycyA9IEhlYWRlcnNcbiAgZy5SZXF1ZXN0ID0gUmVxdWVzdFxuICBnLlJlc3BvbnNlID0gUmVzcG9uc2Vcbn1cbiIsICJpbXBvcnQgJ3doYXR3Zy1mZXRjaCc7XG5cbmNvbnN0IHZlcnNpb24gPSBcIjAuNS4xMlwiO1xuXG52YXIgX19kZWZQcm9wJDEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX19kZWZOb3JtYWxQcm9wJDEgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wJDEob2JqLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSwgdmFsdWUgfSkgOiBvYmpba2V5XSA9IHZhbHVlO1xudmFyIF9fcHVibGljRmllbGQkMSA9IChvYmosIGtleSwgdmFsdWUpID0+IHtcbiAgX19kZWZOb3JtYWxQcm9wJDEob2JqLCB0eXBlb2Yga2V5ICE9PSBcInN5bWJvbFwiID8ga2V5ICsgXCJcIiA6IGtleSwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59O1xuY2xhc3MgUmVzcG9uc2VFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IoZXJyb3IsIHN0YXR1c19jb2RlKSB7XG4gICAgc3VwZXIoZXJyb3IpO1xuICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICB0aGlzLnN0YXR1c19jb2RlID0gc3RhdHVzX2NvZGU7XG4gICAgdGhpcy5uYW1lID0gXCJSZXNwb25zZUVycm9yXCI7XG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBSZXNwb25zZUVycm9yKTtcbiAgICB9XG4gIH1cbn1cbmNsYXNzIEFib3J0YWJsZUFzeW5jSXRlcmF0b3Ige1xuICBjb25zdHJ1Y3RvcihhYm9ydENvbnRyb2xsZXIsIGl0ciwgZG9uZUNhbGxiYWNrKSB7XG4gICAgX19wdWJsaWNGaWVsZCQxKHRoaXMsIFwiYWJvcnRDb250cm9sbGVyXCIpO1xuICAgIF9fcHVibGljRmllbGQkMSh0aGlzLCBcIml0clwiKTtcbiAgICBfX3B1YmxpY0ZpZWxkJDEodGhpcywgXCJkb25lQ2FsbGJhY2tcIik7XG4gICAgdGhpcy5hYm9ydENvbnRyb2xsZXIgPSBhYm9ydENvbnRyb2xsZXI7XG4gICAgdGhpcy5pdHIgPSBpdHI7XG4gICAgdGhpcy5kb25lQ2FsbGJhY2sgPSBkb25lQ2FsbGJhY2s7XG4gIH1cbiAgYWJvcnQoKSB7XG4gICAgdGhpcy5hYm9ydENvbnRyb2xsZXIuYWJvcnQoKTtcbiAgfVxuICBhc3luYyAqW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpIHtcbiAgICBmb3IgYXdhaXQgKGNvbnN0IG1lc3NhZ2Ugb2YgdGhpcy5pdHIpIHtcbiAgICAgIGlmIChcImVycm9yXCIgaW4gbWVzc2FnZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZS5lcnJvcik7XG4gICAgICB9XG4gICAgICB5aWVsZCBtZXNzYWdlO1xuICAgICAgaWYgKG1lc3NhZ2UuZG9uZSB8fCBtZXNzYWdlLnN0YXR1cyA9PT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgdGhpcy5kb25lQ2FsbGJhY2soKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJEaWQgbm90IHJlY2VpdmUgZG9uZSBvciBzdWNjZXNzIHJlc3BvbnNlIGluIHN0cmVhbS5cIik7XG4gIH1cbn1cbmNvbnN0IGNoZWNrT2sgPSBhc3luYyAocmVzcG9uc2UpID0+IHtcbiAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGxldCBtZXNzYWdlID0gYEVycm9yICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWA7XG4gIGxldCBlcnJvckRhdGEgPSBudWxsO1xuICBpZiAocmVzcG9uc2UuaGVhZGVycy5nZXQoXCJjb250ZW50LXR5cGVcIik/LmluY2x1ZGVzKFwiYXBwbGljYXRpb24vanNvblwiKSkge1xuICAgIHRyeSB7XG4gICAgICBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBtZXNzYWdlID0gZXJyb3JEYXRhLmVycm9yIHx8IG1lc3NhZ2U7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIHBhcnNlIGVycm9yIHJlc3BvbnNlIGFzIEpTT05cIik7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkdldHRpbmcgdGV4dCBmcm9tIHJlc3BvbnNlXCIpO1xuICAgICAgY29uc3QgdGV4dFJlc3BvbnNlID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgbWVzc2FnZSA9IHRleHRSZXNwb25zZSB8fCBtZXNzYWdlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBnZXQgdGV4dCBmcm9tIGVycm9yIHJlc3BvbnNlXCIpO1xuICAgIH1cbiAgfVxuICB0aHJvdyBuZXcgUmVzcG9uc2VFcnJvcihtZXNzYWdlLCByZXNwb25zZS5zdGF0dXMpO1xufTtcbmZ1bmN0aW9uIGdldFBsYXRmb3JtKCkge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3cubmF2aWdhdG9yKSB7XG4gICAgcmV0dXJuIGAke3dpbmRvdy5uYXZpZ2F0b3IucGxhdGZvcm0udG9Mb3dlckNhc2UoKX0gQnJvd3Nlci8ke25hdmlnYXRvci51c2VyQWdlbnR9O2A7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gYCR7cHJvY2Vzcy5hcmNofSAke3Byb2Nlc3MucGxhdGZvcm19IE5vZGUuanMvJHtwcm9jZXNzLnZlcnNpb259YDtcbiAgfVxuICByZXR1cm4gXCJcIjtcbn1cbmNvbnN0IGZldGNoV2l0aEhlYWRlcnMgPSBhc3luYyAoZmV0Y2gsIHVybCwgb3B0aW9ucyA9IHt9KSA9PiB7XG4gIGNvbnN0IGRlZmF1bHRIZWFkZXJzID0ge1xuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgIEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgXCJVc2VyLUFnZW50XCI6IGBvbGxhbWEtanMvJHt2ZXJzaW9ufSAoJHtnZXRQbGF0Zm9ybSgpfSlgXG4gIH07XG4gIGlmICghb3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgb3B0aW9ucy5oZWFkZXJzID0ge307XG4gIH1cbiAgY29uc3QgY3VzdG9tSGVhZGVycyA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICBPYmplY3QuZW50cmllcyhvcHRpb25zLmhlYWRlcnMpLmZpbHRlcigoW2tleV0pID0+ICFPYmplY3Qua2V5cyhkZWZhdWx0SGVhZGVycykuc29tZSgoZGVmYXVsdEtleSkgPT4gZGVmYXVsdEtleS50b0xvd2VyQ2FzZSgpID09PSBrZXkudG9Mb3dlckNhc2UoKSkpXG4gICk7XG4gIG9wdGlvbnMuaGVhZGVycyA9IHtcbiAgICAuLi5kZWZhdWx0SGVhZGVycyxcbiAgICAuLi5jdXN0b21IZWFkZXJzXG4gIH07XG4gIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpO1xufTtcbmNvbnN0IGdldCA9IGFzeW5jIChmZXRjaCwgaG9zdCwgb3B0aW9ucykgPT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoV2l0aEhlYWRlcnMoZmV0Y2gsIGhvc3QsIHtcbiAgICBoZWFkZXJzOiBvcHRpb25zPy5oZWFkZXJzXG4gIH0pO1xuICBhd2FpdCBjaGVja09rKHJlc3BvbnNlKTtcbiAgcmV0dXJuIHJlc3BvbnNlO1xufTtcbmNvbnN0IHBvc3QgPSBhc3luYyAoZmV0Y2gsIGhvc3QsIGRhdGEsIG9wdGlvbnMpID0+IHtcbiAgY29uc3QgaXNSZWNvcmQgPSAoaW5wdXQpID0+IHtcbiAgICByZXR1cm4gaW5wdXQgIT09IG51bGwgJiYgdHlwZW9mIGlucHV0ID09PSBcIm9iamVjdFwiICYmICFBcnJheS5pc0FycmF5KGlucHV0KTtcbiAgfTtcbiAgY29uc3QgZm9ybWF0dGVkRGF0YSA9IGlzUmVjb3JkKGRhdGEpID8gSlNPTi5zdHJpbmdpZnkoZGF0YSkgOiBkYXRhO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoV2l0aEhlYWRlcnMoZmV0Y2gsIGhvc3QsIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IGZvcm1hdHRlZERhdGEsXG4gICAgc2lnbmFsOiBvcHRpb25zPy5zaWduYWwsXG4gICAgaGVhZGVyczogb3B0aW9ucz8uaGVhZGVyc1xuICB9KTtcbiAgYXdhaXQgY2hlY2tPayhyZXNwb25zZSk7XG4gIHJldHVybiByZXNwb25zZTtcbn07XG5jb25zdCBkZWwgPSBhc3luYyAoZmV0Y2gsIGhvc3QsIGRhdGEsIG9wdGlvbnMpID0+IHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaFdpdGhIZWFkZXJzKGZldGNoLCBob3N0LCB7XG4gICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgIGhlYWRlcnM6IG9wdGlvbnM/LmhlYWRlcnNcbiAgfSk7XG4gIGF3YWl0IGNoZWNrT2socmVzcG9uc2UpO1xuICByZXR1cm4gcmVzcG9uc2U7XG59O1xuY29uc3QgcGFyc2VKU09OID0gYXN5bmMgZnVuY3Rpb24qIChpdHIpIHtcbiAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcihcInV0Zi04XCIpO1xuICBsZXQgYnVmZmVyID0gXCJcIjtcbiAgY29uc3QgcmVhZGVyID0gaXRyLmdldFJlYWRlcigpO1xuICB3aGlsZSAodHJ1ZSkge1xuICAgIGNvbnN0IHsgZG9uZSwgdmFsdWU6IGNodW5rIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuICAgIGlmIChkb25lKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgYnVmZmVyICs9IGRlY29kZXIuZGVjb2RlKGNodW5rKTtcbiAgICBjb25zdCBwYXJ0cyA9IGJ1ZmZlci5zcGxpdChcIlxcblwiKTtcbiAgICBidWZmZXIgPSBwYXJ0cy5wb3AoKSA/PyBcIlwiO1xuICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0cykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgeWllbGQgSlNPTi5wYXJzZShwYXJ0KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcImludmFsaWQganNvbjogXCIsIHBhcnQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBmb3IgKGNvbnN0IHBhcnQgb2YgYnVmZmVyLnNwbGl0KFwiXFxuXCIpLmZpbHRlcigocCkgPT4gcCAhPT0gXCJcIikpIHtcbiAgICB0cnkge1xuICAgICAgeWllbGQgSlNPTi5wYXJzZShwYXJ0KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKFwiaW52YWxpZCBqc29uOiBcIiwgcGFydCk7XG4gICAgfVxuICB9XG59O1xuY29uc3QgZm9ybWF0SG9zdCA9IChob3N0KSA9PiB7XG4gIGlmICghaG9zdCkge1xuICAgIHJldHVybiBcImh0dHA6Ly8xMjcuMC4wLjE6MTE0MzRcIjtcbiAgfVxuICBsZXQgaXNFeHBsaWNpdFByb3RvY29sID0gaG9zdC5pbmNsdWRlcyhcIjovL1wiKTtcbiAgaWYgKGhvc3Quc3RhcnRzV2l0aChcIjpcIikpIHtcbiAgICBob3N0ID0gYGh0dHA6Ly8xMjcuMC4wLjEke2hvc3R9YDtcbiAgICBpc0V4cGxpY2l0UHJvdG9jb2wgPSB0cnVlO1xuICB9XG4gIGlmICghaXNFeHBsaWNpdFByb3RvY29sKSB7XG4gICAgaG9zdCA9IGBodHRwOi8vJHtob3N0fWA7XG4gIH1cbiAgY29uc3QgdXJsID0gbmV3IFVSTChob3N0KTtcbiAgbGV0IHBvcnQgPSB1cmwucG9ydDtcbiAgaWYgKCFwb3J0KSB7XG4gICAgaWYgKCFpc0V4cGxpY2l0UHJvdG9jb2wpIHtcbiAgICAgIHBvcnQgPSBcIjExNDM0XCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvcnQgPSB1cmwucHJvdG9jb2wgPT09IFwiaHR0cHM6XCIgPyBcIjQ0M1wiIDogXCI4MFwiO1xuICAgIH1cbiAgfVxuICBsZXQgZm9ybWF0dGVkSG9zdCA9IGAke3VybC5wcm90b2NvbH0vLyR7dXJsLmhvc3RuYW1lfToke3BvcnR9JHt1cmwucGF0aG5hbWV9YDtcbiAgaWYgKGZvcm1hdHRlZEhvc3QuZW5kc1dpdGgoXCIvXCIpKSB7XG4gICAgZm9ybWF0dGVkSG9zdCA9IGZvcm1hdHRlZEhvc3Quc2xpY2UoMCwgLTEpO1xuICB9XG4gIHJldHVybiBmb3JtYXR0ZWRIb3N0O1xufTtcblxudmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBfX2RlZk5vcm1hbFByb3AgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wKG9iaiwga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlIH0pIDogb2JqW2tleV0gPSB2YWx1ZTtcbnZhciBfX3B1YmxpY0ZpZWxkID0gKG9iaiwga2V5LCB2YWx1ZSkgPT4ge1xuICBfX2RlZk5vcm1hbFByb3Aob2JqLCB0eXBlb2Yga2V5ICE9PSBcInN5bWJvbFwiID8ga2V5ICsgXCJcIiA6IGtleSwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59O1xubGV0IE9sbGFtYSQxID0gY2xhc3MgT2xsYW1hIHtcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImNvbmZpZ1wiKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZmV0Y2hcIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIm9uZ29pbmdTdHJlYW1lZFJlcXVlc3RzXCIsIFtdKTtcbiAgICB0aGlzLmNvbmZpZyA9IHtcbiAgICAgIGhvc3Q6IFwiXCIsXG4gICAgICBoZWFkZXJzOiBjb25maWc/LmhlYWRlcnNcbiAgICB9O1xuICAgIGlmICghY29uZmlnPy5wcm94eSkge1xuICAgICAgdGhpcy5jb25maWcuaG9zdCA9IGZvcm1hdEhvc3QoY29uZmlnPy5ob3N0ID8/IFwiaHR0cDovLzEyNy4wLjAuMToxMTQzNFwiKTtcbiAgICB9XG4gICAgdGhpcy5mZXRjaCA9IGNvbmZpZz8uZmV0Y2ggPz8gZmV0Y2g7XG4gIH1cbiAgLy8gQWJvcnQgYW55IG9uZ29pbmcgc3RyZWFtZWQgcmVxdWVzdHMgdG8gT2xsYW1hXG4gIGFib3J0KCkge1xuICAgIGZvciAoY29uc3QgcmVxdWVzdCBvZiB0aGlzLm9uZ29pbmdTdHJlYW1lZFJlcXVlc3RzKSB7XG4gICAgICByZXF1ZXN0LmFib3J0KCk7XG4gICAgfVxuICAgIHRoaXMub25nb2luZ1N0cmVhbWVkUmVxdWVzdHMubGVuZ3RoID0gMDtcbiAgfVxuICAvKipcbiAgICogUHJvY2Vzc2VzIGEgcmVxdWVzdCB0byB0aGUgT2xsYW1hIHNlcnZlci4gSWYgdGhlIHJlcXVlc3QgaXMgc3RyZWFtYWJsZSwgaXQgd2lsbCByZXR1cm4gYVxuICAgKiBBYm9ydGFibGVBc3luY0l0ZXJhdG9yIHRoYXQgeWllbGRzIHRoZSByZXNwb25zZSBtZXNzYWdlcy4gT3RoZXJ3aXNlLCBpdCB3aWxsIHJldHVybiB0aGUgcmVzcG9uc2VcbiAgICogb2JqZWN0LlxuICAgKiBAcGFyYW0gZW5kcG9pbnQge3N0cmluZ30gLSBUaGUgZW5kcG9pbnQgdG8gc2VuZCB0aGUgcmVxdWVzdCB0by5cbiAgICogQHBhcmFtIHJlcXVlc3Qge29iamVjdH0gLSBUaGUgcmVxdWVzdCBvYmplY3QgdG8gc2VuZCB0byB0aGUgZW5kcG9pbnQuXG4gICAqIEBwcm90ZWN0ZWQge1QgfCBBYm9ydGFibGVBc3luY0l0ZXJhdG9yPFQ+fSAtIFRoZSByZXNwb25zZSBvYmplY3Qgb3IgYSBBYm9ydGFibGVBc3luY0l0ZXJhdG9yIHRoYXQgeWllbGRzXG4gICAqIHJlc3BvbnNlIG1lc3NhZ2VzLlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gLSBJZiB0aGUgcmVzcG9uc2UgYm9keSBpcyBtaXNzaW5nIG9yIGlmIHRoZSByZXNwb25zZSBpcyBhbiBlcnJvci5cbiAgICogQHJldHVybnMge1Byb21pc2U8VCB8IEFib3J0YWJsZUFzeW5jSXRlcmF0b3I8VD4+fSAtIFRoZSByZXNwb25zZSBvYmplY3Qgb3IgYSBBYm9ydGFibGVBc3luY0l0ZXJhdG9yIHRoYXQgeWllbGRzIHRoZSBzdHJlYW1lZCByZXNwb25zZS5cbiAgICovXG4gIGFzeW5jIHByb2Nlc3NTdHJlYW1hYmxlUmVxdWVzdChlbmRwb2ludCwgcmVxdWVzdCkge1xuICAgIHJlcXVlc3Quc3RyZWFtID0gcmVxdWVzdC5zdHJlYW0gPz8gZmFsc2U7XG4gICAgY29uc3QgaG9zdCA9IGAke3RoaXMuY29uZmlnLmhvc3R9L2FwaS8ke2VuZHBvaW50fWA7XG4gICAgaWYgKHJlcXVlc3Quc3RyZWFtKSB7XG4gICAgICBjb25zdCBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgICBjb25zdCByZXNwb25zZTIgPSBhd2FpdCBwb3N0KHRoaXMuZmV0Y2gsIGhvc3QsIHJlcXVlc3QsIHtcbiAgICAgICAgc2lnbmFsOiBhYm9ydENvbnRyb2xsZXIuc2lnbmFsLFxuICAgICAgICBoZWFkZXJzOiB0aGlzLmNvbmZpZy5oZWFkZXJzXG4gICAgICB9KTtcbiAgICAgIGlmICghcmVzcG9uc2UyLmJvZHkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBib2R5XCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgaXRyID0gcGFyc2VKU09OKHJlc3BvbnNlMi5ib2R5KTtcbiAgICAgIGNvbnN0IGFib3J0YWJsZUFzeW5jSXRlcmF0b3IgPSBuZXcgQWJvcnRhYmxlQXN5bmNJdGVyYXRvcihcbiAgICAgICAgYWJvcnRDb250cm9sbGVyLFxuICAgICAgICBpdHIsXG4gICAgICAgICgpID0+IHtcbiAgICAgICAgICBjb25zdCBpID0gdGhpcy5vbmdvaW5nU3RyZWFtZWRSZXF1ZXN0cy5pbmRleE9mKGFib3J0YWJsZUFzeW5jSXRlcmF0b3IpO1xuICAgICAgICAgIGlmIChpID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMub25nb2luZ1N0cmVhbWVkUmVxdWVzdHMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHRoaXMub25nb2luZ1N0cmVhbWVkUmVxdWVzdHMucHVzaChhYm9ydGFibGVBc3luY0l0ZXJhdG9yKTtcbiAgICAgIHJldHVybiBhYm9ydGFibGVBc3luY0l0ZXJhdG9yO1xuICAgIH1cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHBvc3QodGhpcy5mZXRjaCwgaG9zdCwgcmVxdWVzdCwge1xuICAgICAgaGVhZGVyczogdGhpcy5jb25maWcuaGVhZGVyc1xuICAgIH0pO1xuICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gIH1cbiAgLyoqXG4gICAqIEVuY29kZXMgYW4gaW1hZ2UgdG8gYmFzZTY0IGlmIGl0IGlzIGEgVWludDhBcnJheS5cbiAgICogQHBhcmFtIGltYWdlIHtVaW50OEFycmF5IHwgc3RyaW5nfSAtIFRoZSBpbWFnZSB0byBlbmNvZGUuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPHN0cmluZz59IC0gVGhlIGJhc2U2NCBlbmNvZGVkIGltYWdlLlxuICAgKi9cbiAgYXN5bmMgZW5jb2RlSW1hZ2UoaW1hZ2UpIHtcbiAgICBpZiAodHlwZW9mIGltYWdlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICBjb25zdCB1aW50OEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoaW1hZ2UpO1xuICAgICAgbGV0IGJ5dGVTdHJpbmcgPSBcIlwiO1xuICAgICAgY29uc3QgbGVuID0gdWludDhBcnJheS5ieXRlTGVuZ3RoO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBieXRlU3RyaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUodWludDhBcnJheVtpXSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYnRvYShieXRlU3RyaW5nKTtcbiAgICB9XG4gICAgcmV0dXJuIGltYWdlO1xuICB9XG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgYSByZXNwb25zZSBmcm9tIGEgdGV4dCBwcm9tcHQuXG4gICAqIEBwYXJhbSByZXF1ZXN0IHtHZW5lcmF0ZVJlcXVlc3R9IC0gVGhlIHJlcXVlc3Qgb2JqZWN0LlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxHZW5lcmF0ZVJlc3BvbnNlIHwgQWJvcnRhYmxlQXN5bmNJdGVyYXRvcjxHZW5lcmF0ZVJlc3BvbnNlPj59IC0gVGhlIHJlc3BvbnNlIG9iamVjdCBvclxuICAgKiBhbiBBYm9ydGFibGVBc3luY0l0ZXJhdG9yIHRoYXQgeWllbGRzIHJlc3BvbnNlIG1lc3NhZ2VzLlxuICAgKi9cbiAgYXN5bmMgZ2VuZXJhdGUocmVxdWVzdCkge1xuICAgIGlmIChyZXF1ZXN0LmltYWdlcykge1xuICAgICAgcmVxdWVzdC5pbWFnZXMgPSBhd2FpdCBQcm9taXNlLmFsbChyZXF1ZXN0LmltYWdlcy5tYXAodGhpcy5lbmNvZGVJbWFnZS5iaW5kKHRoaXMpKSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnByb2Nlc3NTdHJlYW1hYmxlUmVxdWVzdChcImdlbmVyYXRlXCIsIHJlcXVlc3QpO1xuICB9XG4gIC8qKlxuICAgKiBDaGF0cyB3aXRoIHRoZSBtb2RlbC4gVGhlIHJlcXVlc3Qgb2JqZWN0IGNhbiBjb250YWluIG1lc3NhZ2VzIHdpdGggaW1hZ2VzIHRoYXQgYXJlIGVpdGhlclxuICAgKiBVaW50OEFycmF5cyBvciBiYXNlNjQgZW5jb2RlZCBzdHJpbmdzLiBUaGUgaW1hZ2VzIHdpbGwgYmUgYmFzZTY0IGVuY29kZWQgYmVmb3JlIHNlbmRpbmcgdGhlXG4gICAqIHJlcXVlc3QuXG4gICAqIEBwYXJhbSByZXF1ZXN0IHtDaGF0UmVxdWVzdH0gLSBUaGUgcmVxdWVzdCBvYmplY3QuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPENoYXRSZXNwb25zZSB8IEFib3J0YWJsZUFzeW5jSXRlcmF0b3I8Q2hhdFJlc3BvbnNlPj59IC0gVGhlIHJlc3BvbnNlIG9iamVjdCBvciBhblxuICAgKiBBYm9ydGFibGVBc3luY0l0ZXJhdG9yIHRoYXQgeWllbGRzIHJlc3BvbnNlIG1lc3NhZ2VzLlxuICAgKi9cbiAgYXN5bmMgY2hhdChyZXF1ZXN0KSB7XG4gICAgaWYgKHJlcXVlc3QubWVzc2FnZXMpIHtcbiAgICAgIGZvciAoY29uc3QgbWVzc2FnZSBvZiByZXF1ZXN0Lm1lc3NhZ2VzKSB7XG4gICAgICAgIGlmIChtZXNzYWdlLmltYWdlcykge1xuICAgICAgICAgIG1lc3NhZ2UuaW1hZ2VzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICBtZXNzYWdlLmltYWdlcy5tYXAodGhpcy5lbmNvZGVJbWFnZS5iaW5kKHRoaXMpKVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucHJvY2Vzc1N0cmVhbWFibGVSZXF1ZXN0KFwiY2hhdFwiLCByZXF1ZXN0KTtcbiAgfVxuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBtb2RlbCBmcm9tIGEgc3RyZWFtIG9mIGRhdGEuXG4gICAqIEBwYXJhbSByZXF1ZXN0IHtDcmVhdGVSZXF1ZXN0fSAtIFRoZSByZXF1ZXN0IG9iamVjdC5cbiAgICogQHJldHVybnMge1Byb21pc2U8UHJvZ3Jlc3NSZXNwb25zZSB8IEFib3J0YWJsZUFzeW5jSXRlcmF0b3I8UHJvZ3Jlc3NSZXNwb25zZT4+fSAtIFRoZSByZXNwb25zZSBvYmplY3Qgb3IgYSBzdHJlYW0gb2YgcHJvZ3Jlc3MgcmVzcG9uc2VzLlxuICAgKi9cbiAgYXN5bmMgY3JlYXRlKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9jZXNzU3RyZWFtYWJsZVJlcXVlc3QoXCJjcmVhdGVcIiwge1xuICAgICAgLi4ucmVxdWVzdFxuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBQdWxscyBhIG1vZGVsIGZyb20gdGhlIE9sbGFtYSByZWdpc3RyeS4gVGhlIHJlcXVlc3Qgb2JqZWN0IGNhbiBjb250YWluIGEgc3RyZWFtIGZsYWcgdG8gaW5kaWNhdGUgaWYgdGhlXG4gICAqIHJlc3BvbnNlIHNob3VsZCBiZSBzdHJlYW1lZC5cbiAgICogQHBhcmFtIHJlcXVlc3Qge1B1bGxSZXF1ZXN0fSAtIFRoZSByZXF1ZXN0IG9iamVjdC5cbiAgICogQHJldHVybnMge1Byb21pc2U8UHJvZ3Jlc3NSZXNwb25zZSB8IEFib3J0YWJsZUFzeW5jSXRlcmF0b3I8UHJvZ3Jlc3NSZXNwb25zZT4+fSAtIFRoZSByZXNwb25zZSBvYmplY3Qgb3JcbiAgICogYW4gQWJvcnRhYmxlQXN5bmNJdGVyYXRvciB0aGF0IHlpZWxkcyByZXNwb25zZSBtZXNzYWdlcy5cbiAgICovXG4gIGFzeW5jIHB1bGwocmVxdWVzdCkge1xuICAgIHJldHVybiB0aGlzLnByb2Nlc3NTdHJlYW1hYmxlUmVxdWVzdChcInB1bGxcIiwge1xuICAgICAgbmFtZTogcmVxdWVzdC5tb2RlbCxcbiAgICAgIHN0cmVhbTogcmVxdWVzdC5zdHJlYW0sXG4gICAgICBpbnNlY3VyZTogcmVxdWVzdC5pbnNlY3VyZVxuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBQdXNoZXMgYSBtb2RlbCB0byB0aGUgT2xsYW1hIHJlZ2lzdHJ5LiBUaGUgcmVxdWVzdCBvYmplY3QgY2FuIGNvbnRhaW4gYSBzdHJlYW0gZmxhZyB0byBpbmRpY2F0ZSBpZiB0aGVcbiAgICogcmVzcG9uc2Ugc2hvdWxkIGJlIHN0cmVhbWVkLlxuICAgKiBAcGFyYW0gcmVxdWVzdCB7UHVzaFJlcXVlc3R9IC0gVGhlIHJlcXVlc3Qgb2JqZWN0LlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxQcm9ncmVzc1Jlc3BvbnNlIHwgQWJvcnRhYmxlQXN5bmNJdGVyYXRvcjxQcm9ncmVzc1Jlc3BvbnNlPj59IC0gVGhlIHJlc3BvbnNlIG9iamVjdCBvclxuICAgKiBhbiBBYm9ydGFibGVBc3luY0l0ZXJhdG9yIHRoYXQgeWllbGRzIHJlc3BvbnNlIG1lc3NhZ2VzLlxuICAgKi9cbiAgYXN5bmMgcHVzaChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHRoaXMucHJvY2Vzc1N0cmVhbWFibGVSZXF1ZXN0KFwicHVzaFwiLCB7XG4gICAgICBuYW1lOiByZXF1ZXN0Lm1vZGVsLFxuICAgICAgc3RyZWFtOiByZXF1ZXN0LnN0cmVhbSxcbiAgICAgIGluc2VjdXJlOiByZXF1ZXN0Lmluc2VjdXJlXG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIERlbGV0ZXMgYSBtb2RlbCBmcm9tIHRoZSBzZXJ2ZXIuIFRoZSByZXF1ZXN0IG9iamVjdCBzaG91bGQgY29udGFpbiB0aGUgbmFtZSBvZiB0aGUgbW9kZWwgdG9cbiAgICogZGVsZXRlLlxuICAgKiBAcGFyYW0gcmVxdWVzdCB7RGVsZXRlUmVxdWVzdH0gLSBUaGUgcmVxdWVzdCBvYmplY3QuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPFN0YXR1c1Jlc3BvbnNlPn0gLSBUaGUgcmVzcG9uc2Ugb2JqZWN0LlxuICAgKi9cbiAgYXN5bmMgZGVsZXRlKHJlcXVlc3QpIHtcbiAgICBhd2FpdCBkZWwoXG4gICAgICB0aGlzLmZldGNoLFxuICAgICAgYCR7dGhpcy5jb25maWcuaG9zdH0vYXBpL2RlbGV0ZWAsXG4gICAgICB7IG5hbWU6IHJlcXVlc3QubW9kZWwgfSxcbiAgICAgIHsgaGVhZGVyczogdGhpcy5jb25maWcuaGVhZGVycyB9XG4gICAgKTtcbiAgICByZXR1cm4geyBzdGF0dXM6IFwic3VjY2Vzc1wiIH07XG4gIH1cbiAgLyoqXG4gICAqIENvcGllcyBhIG1vZGVsIGZyb20gb25lIG5hbWUgdG8gYW5vdGhlci4gVGhlIHJlcXVlc3Qgb2JqZWN0IHNob3VsZCBjb250YWluIHRoZSBuYW1lIG9mIHRoZVxuICAgKiBtb2RlbCB0byBjb3B5IGFuZCB0aGUgbmV3IG5hbWUuXG4gICAqIEBwYXJhbSByZXF1ZXN0IHtDb3B5UmVxdWVzdH0gLSBUaGUgcmVxdWVzdCBvYmplY3QuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPFN0YXR1c1Jlc3BvbnNlPn0gLSBUaGUgcmVzcG9uc2Ugb2JqZWN0LlxuICAgKi9cbiAgYXN5bmMgY29weShyZXF1ZXN0KSB7XG4gICAgYXdhaXQgcG9zdCh0aGlzLmZldGNoLCBgJHt0aGlzLmNvbmZpZy5ob3N0fS9hcGkvY29weWAsIHsgLi4ucmVxdWVzdCB9LCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmNvbmZpZy5oZWFkZXJzXG4gICAgfSk7XG4gICAgcmV0dXJuIHsgc3RhdHVzOiBcInN1Y2Nlc3NcIiB9O1xuICB9XG4gIC8qKlxuICAgKiBMaXN0cyB0aGUgbW9kZWxzIG9uIHRoZSBzZXJ2ZXIuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPExpc3RSZXNwb25zZT59IC0gVGhlIHJlc3BvbnNlIG9iamVjdC5cbiAgICogQHRocm93cyB7RXJyb3J9IC0gSWYgdGhlIHJlc3BvbnNlIGJvZHkgaXMgbWlzc2luZy5cbiAgICovXG4gIGFzeW5jIGxpc3QoKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXQodGhpcy5mZXRjaCwgYCR7dGhpcy5jb25maWcuaG9zdH0vYXBpL3RhZ3NgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmNvbmZpZy5oZWFkZXJzXG4gICAgfSk7XG4gICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgfVxuICAvKipcbiAgICogU2hvd3MgdGhlIG1ldGFkYXRhIG9mIGEgbW9kZWwuIFRoZSByZXF1ZXN0IG9iamVjdCBzaG91bGQgY29udGFpbiB0aGUgbmFtZSBvZiB0aGUgbW9kZWwuXG4gICAqIEBwYXJhbSByZXF1ZXN0IHtTaG93UmVxdWVzdH0gLSBUaGUgcmVxdWVzdCBvYmplY3QuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPFNob3dSZXNwb25zZT59IC0gVGhlIHJlc3BvbnNlIG9iamVjdC5cbiAgICovXG4gIGFzeW5jIHNob3cocmVxdWVzdCkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcG9zdCh0aGlzLmZldGNoLCBgJHt0aGlzLmNvbmZpZy5ob3N0fS9hcGkvc2hvd2AsIHtcbiAgICAgIC4uLnJlcXVlc3RcbiAgICB9LCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmNvbmZpZy5oZWFkZXJzXG4gICAgfSk7XG4gICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgfVxuICAvKipcbiAgICogRW1iZWRzIHRleHQgaW5wdXQgaW50byB2ZWN0b3JzLlxuICAgKiBAcGFyYW0gcmVxdWVzdCB7RW1iZWRSZXF1ZXN0fSAtIFRoZSByZXF1ZXN0IG9iamVjdC5cbiAgICogQHJldHVybnMge1Byb21pc2U8RW1iZWRSZXNwb25zZT59IC0gVGhlIHJlc3BvbnNlIG9iamVjdC5cbiAgICovXG4gIGFzeW5jIGVtYmVkKHJlcXVlc3QpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHBvc3QodGhpcy5mZXRjaCwgYCR7dGhpcy5jb25maWcuaG9zdH0vYXBpL2VtYmVkYCwge1xuICAgICAgLi4ucmVxdWVzdFxuICAgIH0sIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuY29uZmlnLmhlYWRlcnNcbiAgICB9KTtcbiAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICB9XG4gIC8qKlxuICAgKiBFbWJlZHMgYSB0ZXh0IHByb21wdCBpbnRvIGEgdmVjdG9yLlxuICAgKiBAcGFyYW0gcmVxdWVzdCB7RW1iZWRkaW5nc1JlcXVlc3R9IC0gVGhlIHJlcXVlc3Qgb2JqZWN0LlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxFbWJlZGRpbmdzUmVzcG9uc2U+fSAtIFRoZSByZXNwb25zZSBvYmplY3QuXG4gICAqL1xuICBhc3luYyBlbWJlZGRpbmdzKHJlcXVlc3QpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHBvc3QodGhpcy5mZXRjaCwgYCR7dGhpcy5jb25maWcuaG9zdH0vYXBpL2VtYmVkZGluZ3NgLCB7XG4gICAgICAuLi5yZXF1ZXN0XG4gICAgfSwge1xuICAgICAgaGVhZGVyczogdGhpcy5jb25maWcuaGVhZGVyc1xuICAgIH0pO1xuICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gIH1cbiAgLyoqXG4gICAqIExpc3RzIHRoZSBydW5uaW5nIG1vZGVscyBvbiB0aGUgc2VydmVyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPExpc3RSZXNwb25zZT59IC0gVGhlIHJlc3BvbnNlIG9iamVjdC5cbiAgICogQHRocm93cyB7RXJyb3J9IC0gSWYgdGhlIHJlc3BvbnNlIGJvZHkgaXMgbWlzc2luZy5cbiAgICovXG4gIGFzeW5jIHBzKCkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0KHRoaXMuZmV0Y2gsIGAke3RoaXMuY29uZmlnLmhvc3R9L2FwaS9wc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuY29uZmlnLmhlYWRlcnNcbiAgICB9KTtcbiAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICB9XG59O1xuY29uc3QgYnJvd3NlciA9IG5ldyBPbGxhbWEkMSgpO1xuXG5leHBvcnQgeyBPbGxhbWEkMSBhcyBPbGxhbWEsIGJyb3dzZXIgYXMgZGVmYXVsdCB9O1xuIiwgImltcG9ydCB7IE1vZGVsUmVzcG9uc2UsIE9sbGFtYSB9IGZyb20gXCJvbGxhbWFcIjtcbmltcG9ydCB7IE9sbGFtYVNldHRpbmdzIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSBcIi4uXCI7XG5pbXBvcnQgeyBFZGl0b3IgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IHByZXBhcmVQcm9tcHQgfSBmcm9tIFwic3JjL3Byb21wdFwiO1xuaW1wb3J0IHsgQ29tcGxldGlvbk9wdGlvbnMgfSBmcm9tIFwic3JjL3NldHRpbmdzL3NldHRpbmdzXCI7XG5cbmV4cG9ydCBjbGFzcyBPbGxhbWFQcm92aWRlciBpbXBsZW1lbnRzIFByb3ZpZGVyIHtcbiAgICBjbGllbnQ6IE9sbGFtYVxuICAgIHNldHRpbmdzOiBPbGxhbWFTZXR0aW5ncztcbiAgICBhYm9ydGVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5zOiBPbGxhbWFTZXR0aW5ncykge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gc2V0dGlucztcbiAgICAgICAgdGhpcy5jbGllbnQgPSBuZXcgT2xsYW1hKHsgaG9zdDogdGhpcy5zZXR0aW5ncy5ob3N0IH0pO1xuICAgIH1cblxuICAgIGFzeW5jICpnZW5lcmF0ZShlZGl0b3I6IEVkaXRvciwgb3B0aW9uczogQ29tcGxldGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxzdHJpbmc+IHtcbiAgICAgICAgdGhpcy5hYm9ydGVkID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IHByZXBhcmVQcm9tcHQoZWRpdG9yLCBvcHRpb25zLnVzZXJQcm9tcHQpO1xuXG4gICAgICAgIGNvbnN0IGNvbXBsZXRpb25JdGVyYXRvciA9IGF3YWl0IHRoaXMuY2xpZW50LmdlbmVyYXRlKHtcbiAgICAgICAgICAgIG1vZGVsOiBvcHRpb25zLm1vZGVsLFxuICAgICAgICAgICAgcHJvbXB0OiBwcm9tcHQsXG4gICAgICAgICAgICBzeXN0ZW06IG9wdGlvbnMuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgc3RyZWFtOiB0cnVlLFxuICAgICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBvcHRpb25zLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBpbml0aWFsUG9zaXRpb24gPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgIGxldCBjb21wbGV0aW9uID0gXCJcIjtcbiAgICAgICAgZm9yIGF3YWl0IChsZXQgcmVzcG9uc2Ugb2YgY29tcGxldGlvbkl0ZXJhdG9yKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hYm9ydGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY3VycmVudFBvc2l0aW9uID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRQb3NpdGlvbi5saW5lICE9PSBpbml0aWFsUG9zaXRpb24ubGluZSB8fCBjdXJyZW50UG9zaXRpb24uY2ggIT09IGluaXRpYWxQb3NpdGlvbi5jaCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3Vyc29yIG1vdmVkLCBhYm9ydGluZyBjb21wbGV0aW9uXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb21wbGV0aW9uICs9IHJlc3BvbnNlLnJlc3BvbnNlO1xuICAgICAgICAgICAgeWllbGQgY29tcGxldGlvbjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGFib3J0KCkge1xuICAgICAgICBpZiAodGhpcy5hYm9ydGVkKSByZXR1cm47XG4gICAgICAgIHRoaXMuY2xpZW50LmFib3J0KCk7XG4gICAgICAgIHRoaXMuYWJvcnRlZCA9IHRydWU7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiYWJvcnRlZCBjb21wbGV0aW9uXCIpO1xuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZU1vZGVscygpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jbGllbnQubGlzdCgpO1xuICAgICAgICB0aGlzLnNldHRpbmdzLm1vZGVscyA9IHJlc3BvbnNlLm1vZGVscy5tYXAoKG1vZGVsOiBNb2RlbFJlc3BvbnNlKSA9PiBtb2RlbC5uYW1lKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5tb2RlbHM7XG4gICAgfVxufVxuXG5cbiIsICJpbXBvcnQgeyBQcm92aWRlciB9IGZyb20gXCIuLlwiO1xuaW1wb3J0IHsgRWRpdG9yIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBPcGVuQUlTZXR0aW5ncyB9IGZyb20gXCIuXCI7XG5cbmV4cG9ydCBjbGFzcyBPcGVuQUlQcm92aWRlciBpbXBsZW1lbnRzIFByb3ZpZGVyIHtcbiAgICBzZXR0aW5nczogT3BlbkFJU2V0dGluZ3NcbiAgICBtb2RlbHM6IHN0cmluZ1tdO1xuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzOiBPcGVuQUlTZXR0aW5ncykge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgfVxuICAgIGdlbmVyYXRlOiAoZWRpdG9yOiBFZGl0b3IpID0+IEFzeW5jR2VuZXJhdG9yPHN0cmluZz47XG4gICAgYWJvcnQ6ICgpID0+IFByb21pc2U8dm9pZD47XG4gICAgdXBkYXRlTW9kZWxzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIFtcImdwdC00XCIsIFwiZGF2aW5jaVwiXTtcbiAgICB9XG59IiwgImltcG9ydCBJbnNjcmliZSBmcm9tIFwic3JjL21haW5cIjtcbmltcG9ydCB7IFByb3ZpZGVyLCBQcm92aWRlcnMsIFByb3ZpZGVyVHlwZSB9IGZyb20gXCJzcmMvcHJvdmlkZXJzXCI7XG5pbXBvcnQgeyBTZXR0aW5ncyB9IGZyb20gXCJzcmMvc2V0dGluZ3Mvc2V0dGluZ3NcIjtcbmltcG9ydCB7IE9sbGFtYVByb3ZpZGVyIH0gZnJvbSBcIi4vb2xsYW1hXCI7XG5pbXBvcnQgeyBPcGVuQUlQcm92aWRlciB9IGZyb20gXCIuL29wZW5haVwiO1xuXG5leHBvcnQgY2xhc3MgUHJvdmlkZXJGYWN0b3J5IHtcbiAgICBwcml2YXRlIHNldHRpbmdzOiBTZXR0aW5ncztcbiAgICBwcml2YXRlIHByb3ZpZGVyczogUHJvdmlkZXJzO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IEluc2NyaWJlKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcbiAgICAgICAgdGhpcy5wcm92aWRlcnMgPSBidWlsZFByb3ZpZGVycyh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICByZWJ1aWxkUHJvdmlkZXJzKCkge1xuICAgICAgICB0aGlzLnByb3ZpZGVycyA9IGJ1aWxkUHJvdmlkZXJzKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIGdldFByb3ZpZGVyKHByb3ZpZGVyOiBQcm92aWRlclR5cGUpOiBQcm92aWRlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3ZpZGVyc1twcm92aWRlcl07XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlTW9kZWxzKHByb3ZpZGVyOiBQcm92aWRlclR5cGUpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3ZpZGVyc1twcm92aWRlcl0udXBkYXRlTW9kZWxzKCk7XG4gICAgfVxufVxuXG5jb25zdCBidWlsZFByb3ZpZGVycyA9IChzZXR0aW5nczogU2V0dGluZ3MpOiBQcm92aWRlcnMgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAgIFtQcm92aWRlclR5cGUuT0xMQU1BXTogbmV3IE9sbGFtYVByb3ZpZGVyKHNldHRpbmdzLnByb3ZpZGVycy5vbGxhbWEpLFxuICAgICAgICBbUHJvdmlkZXJUeXBlLk9QRU5BSV06IG5ldyBPcGVuQUlQcm92aWRlcihzZXR0aW5ncy5wcm92aWRlcnMub3BlbmFpKSxcbiAgICB9XG59IiwgImltcG9ydCB7IEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgSW5saW5lQ29tcGxldGlvbk9wdGlvbnMgfSBmcm9tIFwic3JjL2V4dGVuc2lvblwiO1xuaW1wb3J0IEluc2NyaWJlIGZyb20gXCJzcmMvbWFpblwiO1xuaW1wb3J0IHsgREVGQVVMVF9QQVRILCBERUZBVUxUX1BST0ZJTEUsIFByb2ZpbGUsIFNldHRpbmdzIH0gZnJvbSBcInNyYy9zZXR0aW5ncy9zZXR0aW5nc1wiO1xuXG4vLyBQcm9maWxlU2VydmljZSBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgdHJhY2tpbmcgdGhlIGFjdGl2ZSBwcm9maWxlIGJhc2VkIG9uIHRoZSBjdXJyZW50IGZpbGUgcGF0aC5cbmV4cG9ydCBjbGFzcyBQcm9maWxlU2VydmljZSB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IEluc2NyaWJlO1xuICAgIHByaXZhdGUgYWN0aXZlUHJvZmlsZTogUHJvZmlsZTtcbiAgICBwcml2YXRlIGFjdGl2ZVBhdGhNYXBwaW5nOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBhcHA6IEFwcDtcbiAgICBwcml2YXRlIHNldHRpbmdzOiBTZXR0aW5ncztcbiAgICBwcml2YXRlIGlubGluZVN1Z2dlc3Rpb25PcHRpb25zOiBJbmxpbmVDb21wbGV0aW9uT3B0aW9ucyA9IHsgZGVsYXlNczogMzAwLCBzcGxpdFN0cmF0ZWd5OiBcInNlbnRlbmNlXCIgfTtcbiAgICBwcml2YXRlIHByb2ZpbGVDaGFuZ2VDYWxsYmFja3M6ICgocHJvZmlsZTogUHJvZmlsZSkgPT4gdm9pZClbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBJbnNjcmliZSkge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5hcHAgPSB0aGlzLnBsdWdpbi5hcHA7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcbiAgICAgICAgdGhpcy51cGRhdGUodGhpcy5nZXRBY3RpdmVGaWxlUGF0aCgpKTtcblxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtb3BlbicsIChmaWxlKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWZpbGUpIHJldHVybjtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKGZpbGUucGF0aCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldEFjdGl2ZVByb2ZpbGVNYXBwaW5nKCk6IFtzdHJpbmcsIFByb2ZpbGVdIHtcbiAgICAgICAgcmV0dXJuIFt0aGlzLmFjdGl2ZVBhdGhNYXBwaW5nLCB0aGlzLmFjdGl2ZVByb2ZpbGVdO1xuICAgIH1cblxuICAgIGdldEFjdGl2ZVByb2ZpbGUoKTogUHJvZmlsZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGl2ZVByb2ZpbGU7XG4gICAgfVxuXG4gICAgZ2V0T3B0aW9ucygpOiBJbmxpbmVDb21wbGV0aW9uT3B0aW9ucyB7XG4gICAgICAgIHJldHVybiB0aGlzLmlubGluZVN1Z2dlc3Rpb25PcHRpb25zO1xuICAgIH1cblxuICAgIG9uUHJvZmlsZUNoYW5nZShjYWxsYmFjazogKHByb2ZpbGU6IFByb2ZpbGUpID0+IHZvaWQpIHtcbiAgICAgICAgdGhpcy5wcm9maWxlQ2hhbmdlQ2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlKGZpbGVQYXRoOiBzdHJpbmcpIHtcbiAgICAgICAgW3RoaXMuYWN0aXZlUGF0aE1hcHBpbmcsIHRoaXMuYWN0aXZlUHJvZmlsZV0gPSB0aGlzLnJlc29sdmVQcm9maWxlRnJvbVBhdGgoZmlsZVBhdGgpO1xuXG4gICAgICAgIHRoaXMuaW5saW5lU3VnZ2VzdGlvbk9wdGlvbnMgPSB7IGRlbGF5TXM6IHRoaXMuYWN0aXZlUHJvZmlsZS5kZWxheU1zLCBzcGxpdFN0cmF0ZWd5OiB0aGlzLmFjdGl2ZVByb2ZpbGUuc3BsaXRTdHJhdGVneSB9O1xuICAgICAgICB0aGlzLnByb2ZpbGVDaGFuZ2VDYWxsYmFja3MuZm9yRWFjaChjYiA9PiBjYih0aGlzLmFjdGl2ZVByb2ZpbGUpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldEFjdGl2ZUZpbGVQYXRoKCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZUVkaXRvciA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVFZGl0b3I7XG4gICAgICAgIGlmICghYWN0aXZlRWRpdG9yKSByZXR1cm4gXCJcIjtcbiAgICAgICAgaWYgKCFhY3RpdmVFZGl0b3IuZmlsZSkgcmV0dXJuIFwiXCI7XG4gICAgICAgIHJldHVybiBhY3RpdmVFZGl0b3IuZmlsZS5wYXRoO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVzb2x2ZVByb2ZpbGVGcm9tUGF0aChmaWxlUGF0aDogc3RyaW5nKTogW3N0cmluZywgUHJvZmlsZV0ge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MucGF0aF9jb25maWdzIHx8IE9iamVjdC5rZXlzKHRoaXMuc2V0dGluZ3MucGF0aF9jb25maWdzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBbREVGQVVMVF9QQVRILCB0aGlzLnNldHRpbmdzLnByb2ZpbGVzW0RFRkFVTFRfUFJPRklMRV1dO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZFBhdGggPSBmaWxlUGF0aC5yZXBsYWNlKC9eXFwvK3xcXC8rJC9nLCAnJyk7XG4gICAgICAgIGxldCBsb25nZXN0TWF0Y2ggPSAnJztcbiAgICAgICAgbGV0IG1hdGNoZWRQcm9maWxlID0gREVGQVVMVF9QUk9GSUxFO1xuICAgICAgICBsZXQgcGF0aE1hcHBpbmcgPSAnLyc7XG5cbiAgICAgICAgT2JqZWN0LmVudHJpZXModGhpcy5zZXR0aW5ncy5wYXRoX2NvbmZpZ3MpLmZvckVhY2goKFtwYXRoLCBtYXBwaW5nXSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZE1hcHBpbmdQYXRoID0gcGF0aC5yZXBsYWNlKC9eXFwvK3xcXC8rJC9nLCAnJyk7XG4gICAgICAgICAgICBpZiAobm9ybWFsaXplZFBhdGguc3RhcnRzV2l0aChub3JtYWxpemVkTWFwcGluZ1BhdGgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vcm1hbGl6ZWRNYXBwaW5nUGF0aC5sZW5ndGggPiBsb25nZXN0TWF0Y2gubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvbmdlc3RNYXRjaCA9IG5vcm1hbGl6ZWRNYXBwaW5nUGF0aDtcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZFByb2ZpbGUgPSBtYXBwaW5nLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYXBwaW5nID0gcGF0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBbcGF0aE1hcHBpbmcsIHRoaXMuc2V0dGluZ3MucHJvZmlsZXNbbWF0Y2hlZFByb2ZpbGVdXTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9mZignZmlsZS1vcGVuJywgdGhpcy51cGRhdGUpO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBFZGl0b3IgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFByb2ZpbGVTZXJ2aWNlIH0gZnJvbSBcInNyYy9wcm9maWxlL3NlcnZpY2VcIjtcbmltcG9ydCB7IFByb3ZpZGVyRmFjdG9yeSB9IGZyb20gXCJzcmMvcHJvdmlkZXJzL2ZhY3RvcnlcIjtcbmltcG9ydCB7IFN1Z2dlc3Rpb24gfSBmcm9tIFwic3JjL2V4dGVuc2lvblwiO1xuaW1wb3J0IHsgQ29tcGxldGlvbk9wdGlvbnMgfSBmcm9tIFwic3JjL3NldHRpbmdzL3NldHRpbmdzXCI7XG5pbXBvcnQgeyBQcm92aWRlciB9IGZyb20gXCJzcmMvcHJvdmlkZXJzL3Byb3ZpZGVyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbXBsZXRpb25TZXJ2aWNlIHtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgcHJvZmlsZVRyYWNrZXI6IFByb2ZpbGVTZXJ2aWNlO1xuICAgIHByaXZhdGUgcHJvdmlkZXJGYWN0b3J5OiBQcm92aWRlckZhY3Rvcnk7XG4gICAgcHJpdmF0ZSBjb21wbGV0aW9uU3RhdHVzTGlzdGVuZXJzOiAoKGlzR2VuZXJhdGluZzogYm9vbGVhbikgPT4gdm9pZClbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGFwcDogQXBwLFxuICAgICAgICBwcm9maWxlVHJhY2tlcjogUHJvZmlsZVNlcnZpY2UsXG4gICAgICAgIHByb3ZpZGVyRmFjdG9yeTogUHJvdmlkZXJGYWN0b3J5LFxuICAgICkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5wcm9maWxlVHJhY2tlciA9IHByb2ZpbGVUcmFja2VyO1xuICAgICAgICB0aGlzLnByb3ZpZGVyRmFjdG9yeSA9IHByb3ZpZGVyRmFjdG9yeTtcbiAgICB9XG5cbiAgICBhc3luYyAqZmV0Y2hDb21wbGV0aW9uKCk6IEFzeW5jR2VuZXJhdG9yPFN1Z2dlc3Rpb24+IHtcbiAgICAgICAgY29uc3QgYWN0aXZlRWRpdG9yID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUVkaXRvcjtcbiAgICAgICAgaWYgKCFhY3RpdmVFZGl0b3IpIHJldHVybjtcbiAgICAgICAgaWYgKCFhY3RpdmVFZGl0b3IuZWRpdG9yKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgWywgcHJvZmlsZV0gPSB0aGlzLnByb2ZpbGVUcmFja2VyLmdldEFjdGl2ZVByb2ZpbGVNYXBwaW5nKCk7XG5cbiAgICAgICAgY29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVyRmFjdG9yeS5nZXRQcm92aWRlcihwcm9maWxlLnByb3ZpZGVyKTtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHByb2ZpbGUuY29tcGxldGlvbk9wdGlvbnM7XG5cbiAgICAgICAgdGhpcy5ub3RpZnlDb21wbGV0aW9uU3RhdHVzKHRydWUpO1xuICAgICAgICB5aWVsZCogdGhpcy5jb21wbGV0ZShhY3RpdmVFZGl0b3IuZWRpdG9yLCBwcm92aWRlciwgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMubm90aWZ5Q29tcGxldGlvblN0YXR1cyhmYWxzZSk7XG4gICAgfVxuXG4gICAgb25Db21wbGV0aW9uU3RhdHVzQ2hhbmdlKGxpc3RlbmVyOiAoaXNHZW5lcmF0aW5nOiBib29sZWFuKSA9PiB2b2lkKSB7XG4gICAgICAgIHRoaXMuY29tcGxldGlvblN0YXR1c0xpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG5vdGlmeUNvbXBsZXRpb25TdGF0dXMoaXNHZW5lcmF0aW5nOiBib29sZWFuKSB7XG4gICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgdGhpcy5jb21wbGV0aW9uU3RhdHVzTGlzdGVuZXJzKSB7XG4gICAgICAgICAgICBsaXN0ZW5lcihpc0dlbmVyYXRpbmcpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyAqY29tcGxldGUoZWRpdG9yOiBFZGl0b3IsIHByb3ZpZGVyOiBQcm92aWRlciwgb3B0aW9uczogQ29tcGxldGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxTdWdnZXN0aW9uPiB7XG4gICAgICAgIGF3YWl0IHByb3ZpZGVyLmFib3J0KCk7XG5cbiAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcblxuICAgICAgICBpZiAoIWN1cnJlbnRMaW5lLmxlbmd0aCkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGxhc3RDaGFyID0gY3VycmVudExpbmVbY3Vyc29yLmNoIC0gMV07XG4gICAgICAgIGlmIChsYXN0Q2hhciAhPT0gXCIgXCIpIHJldHVybjtcblxuICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IHRleHQgb2YgcHJvdmlkZXIuZ2VuZXJhdGUoZWRpdG9yLCBvcHRpb25zKSkge1xuICAgICAgICAgICAgeWllbGQgeyB0ZXh0IH07XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgTWVudSwgc2V0SWNvbiwgc2V0VG9vbHRpcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBJbnNjcmliZSBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IFByb2ZpbGVTZXJ2aWNlIH0gZnJvbSAnc3JjL3Byb2ZpbGUvc2VydmljZSc7XG5pbXBvcnQgQ29tcGxldGlvblNlcnZpY2UgZnJvbSAnc3JjL2NvbXBsZXRpb24vc2VydmljZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFN0YXR1c0Jhckl0ZW0ge1xuICAgIHByaXZhdGUgcGx1Z2luOiBJbnNjcmliZTtcbiAgICBwcml2YXRlIHN0YXR1c0Jhckl0ZW06IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgcHJvZmlsZVNlcnZpY2U6IFByb2ZpbGVTZXJ2aWNlO1xuICAgIHByaXZhdGUgY29tcGxldGlvbkVuZ2luZTogQ29tcGxldGlvblNlcnZpY2U7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IEluc2NyaWJlLCBwcm9maWxlVHJhY2tlcjogUHJvZmlsZVNlcnZpY2UsIGNvbXBsZXRpb25FbmdpbmU6IENvbXBsZXRpb25TZXJ2aWNlKSB7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnByb2ZpbGVTZXJ2aWNlID0gcHJvZmlsZVRyYWNrZXI7XG4gICAgICAgIHRoaXMuY29tcGxldGlvbkVuZ2luZSA9IGNvbXBsZXRpb25FbmdpbmU7XG5cbiAgICAgICAgdGhpcy5wcm9maWxlU2VydmljZS5vblByb2ZpbGVDaGFuZ2UodGhpcy5oYW5kbGVQcm9maWxlQ2hhbmdlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmNvbXBsZXRpb25FbmdpbmUub25Db21wbGV0aW9uU3RhdHVzQ2hhbmdlKHRoaXMuaGFuZGxlQ29tcGxldGlvblN0YXR1c0NoYW5nZS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLnN0YXR1c0Jhckl0ZW0gPSB0aGlzLmNyZWF0ZVN0YXR1c0Jhckl0ZW0oKTtcbiAgICAgICAgdGhpcy51cGRhdGVDb21wbGV0aW9uRW5hYmxlZFN0YXRlKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVTdGF0dXNCYXJJdGVtKCk6IEhUTUxFbGVtZW50IHtcbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMucGx1Z2luLmFkZFN0YXR1c0Jhckl0ZW0oKTtcbiAgICAgICAgc2V0SWNvbihpdGVtLCAnZmVhdGhlcicpO1xuICAgICAgICBpdGVtLmFkZENsYXNzZXMoWydzdGF0dXMtYmFyLWl0ZW0taWNvbicsIGBtb2QtY2xpY2thYmxlYF0pO1xuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5zaG93Q29udGV4dE1lbnUuYmluZCh0aGlzKSk7XG4gICAgICAgIHJldHVybiBpdGVtO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2hvd0NvbnRleHRNZW51KGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1lbnUgPSBuZXcgTWVudSgpO1xuICAgICAgICBjb25zdCBjb21wbGV0aW9uRW5hYmxlZCA9IHRydWU7XG5cbiAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICBpdGVtLnNldFRpdGxlKGAke2NvbXBsZXRpb25FbmFibGVkID8gJ0Rpc2FibGUnIDogJ0VuYWJsZSd9IGNvbXBsZXRpb24gZ2xvYmFsbHlgKTtcbiAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb21wbGV0aW9uRW5hYmxlZFN0YXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgW3BhdGgsXSA9IHRoaXMucHJvZmlsZVNlcnZpY2UuZ2V0QWN0aXZlUHJvZmlsZU1hcHBpbmcoKTtcbiAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYERpc2FibGUgZm9yIGN1cnJlbnQgcGF0aDogJHtwYXRofWApO1xuICAgICAgICAgICAgaXRlbS5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXBwaW5nID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0aF9jb25maWdzW3BhdGhdO1xuICAgICAgICAgICAgICAgIG1hcHBpbmcuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1lbnUuYWRkU2VwYXJhdG9yKCk7XG4gICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShcIk9wZW4gc2V0dGluZ3NcIik7XG4gICAgICAgICAgICBpdGVtLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNldHRpbmcgPSAodGhpcy5wbHVnaW4uYXBwIGFzIGFueSkuc2V0dGluZztcbiAgICAgICAgICAgICAgICBzZXR0aW5nLm9wZW4oKTtcbiAgICAgICAgICAgICAgICBzZXR0aW5nLm9wZW5UYWJCeUlkKHRoaXMucGx1Z2luLm1hbmlmZXN0LmlkKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1lbnUuc2hvd0F0TW91c2VFdmVudChldmVudCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVDb21wbGV0aW9uRW5hYmxlZFN0YXRlKCk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5kb21CeXRlcyA9IG5ldyBVaW50OEFycmF5KDEpO1xuICAgICAgICB3aW5kb3cuY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhyYW5kb21CeXRlcyk7XG4gICAgICAgIGlmIChyYW5kb21CeXRlc1swXSA8IDEyOCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLnJlbW92ZUNsYXNzKCdjb21wbGV0aW9uLWRpc2FibGVkJyk7XG4gICAgICAgICAgICBzZXRUb29sdGlwKHRoaXMuc3RhdHVzQmFySXRlbSwgYFByb2ZpbGU6ICR7dGhpcy5wcm9maWxlU2VydmljZS5nZXRBY3RpdmVQcm9maWxlKCkubmFtZX1gLCB7IHBsYWNlbWVudDogJ3RvcCcgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c0Jhckl0ZW0uYWRkQ2xhc3MoJ2NvbXBsZXRpb24tZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIHNldFRvb2x0aXAodGhpcy5zdGF0dXNCYXJJdGVtLCBgQ29tcGxldGlvbiBkaXNhYmxlZGAsIHsgcGxhY2VtZW50OiAndG9wJyB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlQ29tcGxldGlvblN0YXR1c0NoYW5nZShpc0dlbmVyYXRpbmc6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgaWYgKGlzR2VuZXJhdGluZykge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIHNldFRvb2x0aXAodGhpcy5zdGF0dXNCYXJJdGVtLCAnR2VuZXJhdGluZy4uLicsIHsgcGxhY2VtZW50OiAndG9wJyB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzQmFySXRlbS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByb2ZpbGUodGhpcy5wcm9maWxlU2VydmljZS5nZXRBY3RpdmVQcm9maWxlKCkubmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGhhbmRsZVByb2ZpbGVDaGFuZ2UocHJvZmlsZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMudXBkYXRlUHJvZmlsZShwcm9maWxlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZVByb2ZpbGUocHJvZmlsZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGlmICh0cnVlKSB7XG4gICAgICAgICAgICBzZXRUb29sdGlwKHRoaXMuc3RhdHVzQmFySXRlbSwgYFByb2ZpbGU6ICR7cHJvZmlsZX1gLCB7IHBsYWNlbWVudDogJ3RvcCcgfSk7XG4gICAgICAgIH1cbiAgICB9XG59ICJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQXVCOzs7QUNVdkIsa0JBT087QUFDUCxtQkFRTztBQXFEUCxJQUFNLHNCQUFzQjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLeEIsTUFBTSxDQUFDLFNBQWlCO0FBQ3BCLFVBQU0sWUFBWSxLQUFLLFFBQVEsR0FBRztBQUNsQyxXQUFPLGNBQWMsS0FDZixFQUFFLFVBQVUsTUFBTSxXQUFXLEdBQUcsSUFDaEM7QUFBQSxNQUNFLFVBQVUsS0FBSyxNQUFNLEdBQUcsWUFBWSxDQUFDO0FBQUEsTUFDckMsV0FBVyxLQUFLLE1BQU0sWUFBWSxDQUFDO0FBQUEsSUFDdkM7QUFBQSxFQUNSO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxVQUFVLENBQUMsU0FBaUI7QUFDeEIsVUFBTSxRQUFRLEtBQUssTUFBTSxVQUFVO0FBQ25DLFFBQUksU0FBUyxNQUFNLFVBQVUsUUFBVztBQUNwQyxhQUFPO0FBQUEsUUFDSCxVQUFVLEtBQUssTUFBTSxHQUFHLE1BQU0sUUFBUSxDQUFDO0FBQUEsUUFDdkMsV0FBVyxLQUFLLE1BQU0sTUFBTSxRQUFRLENBQUM7QUFBQSxNQUN6QztBQUFBLElBQ0o7QUFDQSxXQUFPLEVBQUUsVUFBVSxNQUFNLFdBQVcsR0FBRztBQUFBLEVBQzNDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxXQUFXLENBQUMsU0FBaUI7QUFDekIsVUFBTSxlQUFlLEtBQUssUUFBUSxNQUFNO0FBQ3hDLFdBQU8saUJBQWlCLEtBQ2xCLEVBQUUsVUFBVSxNQUFNLFdBQVcsR0FBRyxJQUNoQztBQUFBLE1BQ0UsVUFBVSxLQUFLLE1BQU0sR0FBRyxlQUFlLENBQUM7QUFBQSxNQUN4QyxXQUFXLEtBQUssTUFBTSxlQUFl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Z0IsS0FBSyxlQUFlO0FBQ2pHLFNBQUssZ0JBQWdCLElBQUksY0FBYyxNQUFNLEtBQUssZ0JBQWdCLEtBQUssZ0JBQWdCO0FBRXZGLFNBQUssY0FBYyxJQUFJLG9CQUFvQixJQUFJLENBQUM7QUFDaEQsVUFBTSxLQUFLLGVBQWU7QUFBQSxFQUMzQjtBQUFBLEVBRUEsTUFBTSxXQUFXO0FBQ2hCLFNBQUssZUFBZSxTQUFTO0FBQUEsRUFDOUI7QUFBQSxFQUVBLE1BQU0saUJBQWlCO0FBQ3RCLFVBQU0sWUFBWSxrQkFBa0I7QUFBQSxNQUNuQyxXQUFXLE1BQU0sS0FBSyxpQkFBaUIsZ0JBQWdCO0FBQUEsTUFDdkQsWUFBWSxNQUFNLEtBQUssZUFBZSxXQUFXO0FBQUEsSUFDbEQsQ0FBQztBQUNELFNBQUssd0JBQXdCLFNBQVM7QUFBQSxFQUN2QztBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ3BCLFNBQUssV0FBVyxPQUFPO0FBQUEsTUFDdEIsQ0FBQztBQUFBLE1BQ0Q7QUFBQSxNQUNBLE1BQU0sS0FBSyxTQUFTO0FBQUEsSUFDckI7QUFBQSxFQUNEO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDcEIsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBQ2pDLFNBQUssZ0JBQWdCLGlCQUFpQjtBQUFBLEVBQ3ZDO0FBQ0Q7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJmZXRjaCIsICJyZXNvbHZlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbmRleCIsICJnZXQiLCAic2VsZiIsICJjbGVhckNhY2hlIiwgInBhcnNlIiwgInJlbmRlciIsICJwcm9maWxlQ2VsbCIsICJwcm9maWxlRHJvcGRvd24iLCAicmVzb2x2ZSIsICJmZXRjaCIsICJmZXRjaCIsICJfX2RlZlByb3AiLCAiT2xsYW1hIiwgImZzIiwgIk9sbGFtYSIsICJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==
